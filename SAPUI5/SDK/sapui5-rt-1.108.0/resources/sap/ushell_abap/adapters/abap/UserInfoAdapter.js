// Copyright (c) 2009-2022 SAP SE, All Rights Reserved
sap.ui.define(["sap/ushell_abap/pbServices/ui2/ODataWrapper","sap/ui/thirdparty/datajs","sap/ui/thirdparty/jquery","sap/base/Log","sap/ushell/resources"],function(e,r,jQuery,t,a){"use strict";var s;var n="default";return function(){this._updateODataObjectBasedOnDatatype=function(e,r){if(jQuery.type(e)==="string"){r.value=e.toString();r.dataType="Edm.String"}if(jQuery.type(e)==="boolean"){r.value=e.toString();r.dataType="Edm.Boolean"}return r};this.getThemeList=function(){var e=new jQuery.Deferred,a="/sap/opu/odata/UI2/INTEROP/Themes";r.read({requestUri:a},function(r,t){var a,s=[];for(a=0;a<r.results.length;a=a+1){s.push(r.results[a])}e.resolve({options:s})},function(r){t.error(r.message,null,"sap.ushell_abap.adapters.abap.UserInfoAdapter");e.reject(r.message)});return e.promise()};this.getLanguageList=function(){var e=new jQuery.Deferred,s=encodeURI("/sap/opu/odata/UI2/INTEROP/UserProfilePropertyValues?$filter=id eq 'PREFERRED_LOGON_LANGUAGE'");r.read({requestUri:s},function(r){var t=[{text:a.i18n.getText("userSettings.browserLanguage"),key:n}];var s=r.results.map(function(e){return{text:e.description,key:e.value}}).sort(function(e,r){return e.text.localeCompare(r.text)});t=t.concat(s);e.resolve(t)},function(r){t.error(r.message,null,"sap.ushell_abap.adapters.abap.UserInfoAdapter");e.reject(r.message)});return e.promise()};this.getUserProfilePropertyValueLists=function(){var e=new jQuery.Deferred;var r;var a={};var s=["NUMBER_FORMAT","TIME_ZONE","TIME_FORMAT","DATE_FORMAT"];var n=this._createWrapper("/sap/opu/odata/UI2/INTEROP/");n.openBatchQueue();var u;for(var i=0;i<s.length;i++){u=s[i];r=encodeURI("UserProfilePropertyValues?$filter=id eq '"+u+"'&$select=description,value");n.read(r,function(e){a[this]=e.results}.bind(u),function(e){t.error(e.message,null,"sap.ushell_abap.adapters.abap.UserInfoAdapter")})}n.submitBatchQueue(function(){e.resolve(a)},function(r){t.error(r.message,null,"sap.ushell_abap.adapters.abap.UserInfoAdapter");e.reject(r.message)});return e.promise()};this._createWrapper=function(r){return e.createODataWrapper(r,false,function(e){})};this.updateUserPreferences=function(e){var r=this,t,a,u,i,o,p=function(){i-=1;if(i===0){t.resolve()}},l=function(e,r){t.reject(e,r)};s=this._createWrapper("/sap/opu/odata/UI2/INTEROP/");t=new jQuery.Deferred;s.openBatchQueue();u=e.getChangedProperties()||[];i=u.length;u.forEach(function(e){var t=e.name,u=e.newValue;if(t.toUpperCase()==="LANGUAGE"){t="PREFERRED_LOGON_LANGUAGE";u=u===n?undefined:u}a="UserProfileProperties("+["id='"+t+"'","shellType='FLP')"].join(",");o={id:t,shellType:"FLP",value:u};r._updateODataObjectBasedOnDatatype(u,o);s.put(a,o,p,l)});s.submitBatchQueue(function(){if(i===0){t.resolve()}},l);return t.promise()}}},true);
//# sourceMappingURL=UserInfoAdapter.js.map