/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(["sap/ui/core/service/Service","sap/ui/core/service/ServiceFactory"],function(e,t){"use strict";function n(e,t){return a(e)||o(e,t)||i(e,t)||r()}function r(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function i(e,t){if(!e)return;if(typeof e==="string")return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor)n=e.constructor.name;if(n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,t)}function s(e,t){if(t==null||t>e.length)t=e.length;for(var n=0,r=new Array(t);n<t;n++){r[n]=e[n]}return r}function o(e,t){var n=e==null?null:typeof Symbol!=="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(n==null)return;var r=[];var i=true;var s=false;var o,a;try{for(n=n.call(e);!(i=(o=n.next()).done);i=true){r.push(o.value);if(t&&r.length===t)break}}catch(e){s=true;a=e}finally{try{if(!i&&n["return"]!=null)n["return"]()}finally{if(s)throw a}}return r}function a(e){if(Array.isArray(e))return e}function c(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;u(e,t)}function u(e,t){u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,n){t.__proto__=n;return t};return u(e,t)}var l=function(e){c(t,e);function t(){return e.apply(this,arguments)||this}var n=t.prototype;n.init=function e(){this.initPromise=Promise.resolve(this);this.instanceType="mock"};n.getLinks=function e(){return Promise.resolve([])};n.getLinksWithCache=function e(){return Promise.resolve([])};n.toExternal=function e(){};n.getStartupAppState=function e(){return Promise.resolve(null)};n.backToPreviousApp=function e(){};n.hrefForExternal=function e(){return""};n.hrefForExternalAsync=function e(){return Promise.resolve({})};n.getAppState=function e(){return Promise.resolve({})};n.createEmptyAppState=function e(){return Promise.resolve({})};n.createEmptyAppStateAsync=function e(){return Promise.resolve({})};n.isNavigationSupported=function e(){return Promise.resolve({})};n.isInitialNavigation=function e(){return false};n.isInitialNavigationAsync=function e(){return Promise.resolve({})};n.expandCompactHash=function e(){return Promise.resolve({})};n.parseShellHash=function e(){return{}};n.splitHash=function e(){return Promise.resolve({})};n.constructShellHash=function e(){return""};n.setDirtyFlag=function e(){};n.registerDirtyStateProvider=function e(){};n.deregisterDirtyStateProvider=function e(){};n.createRenderer=function e(){return{}};n.getUser=function e(){return{}};n.hasUShell=function e(){return false};n.registerNavigationFilter=function e(){};n.unregisterNavigationFilter=function e(){};n.setBackNavigation=function e(){};n.setHierarchy=function e(){};n.setTitle=function e(){};n.getContentDensity=function e(){if(document.body.classList.contains("sapUiSizeCozy")){return"cozy"}else if(document.body.classList.contains("sapUiSizeCompact")){return"compact"}else{return""}};n.getPrimaryIntent=function e(){return Promise.resolve()};return t}(e);function h(e){return new Promise(function(t,n){e.done(t).fail(n)})}var f=function(e){c(t,e);function t(){return e.apply(this,arguments)||this}var r=t.prototype;r.init=function e(){var t=this;var r=this.getContext();var i=r.scopeObject;this.oShellContainer=r.settings.shellContainer;this.instanceType="real";this.linksCache={};this.fnFindSemanticObjectsInCache=function(e){var t=e;var n=[];var r=[];for(var i=0;i<t.length;i++){if(!!t[i][0]&&!!t[i][0].semanticObject){if(this.linksCache[t[i][0].semanticObject]){n.push(this.linksCache[t[i][0].semanticObject].links);Object.defineProperty(e[i][0],"links",{value:this.linksCache[t[i][0].semanticObject].links})}else{r.push(t[i])}}}return{oldArgs:e,newArgs:r,cachedLinks:n}};this.initPromise=new Promise(function(e,n){t.resolveFn=e;t.rejectFn=n});var s=this.oShellContainer.getServiceAsync("CrossApplicationNavigation");var o=this.oShellContainer.getServiceAsync("URLParsing");var a=this.oShellContainer.getServiceAsync("ShellNavigation");var c=i.getService("ShellUIService");Promise.all([s,o,a,c]).then(function(e){var r=n(e,4),i=r[0],s=r[1],o=r[2],a=r[3];t.crossAppNavService=i;t.urlParsingService=s;t.shellNavigation=o;t.shellUIService=a;t.resolveFn()}).catch(this.rejectFn)};r.getLinks=function e(t){var n=this;return new Promise(function(e,r){n.crossAppNavService.getLinks(t).fail(function(e){r(new Error("".concat(e," sap.fe.core.services.NavigationServiceFactory.getLinks")))}).then(e)})};r.getLinksWithCache=function e(t){var n=this;return new Promise(function(e,r){if(t.length===0){e([])}else{var i=n.fnFindSemanticObjectsInCache(t);if(i.newArgs.length===0){e(i.cachedLinks)}else{n.crossAppNavService.getLinks(i.newArgs).fail(function(e){r(new Error("".concat(e," sap.fe.core.services.NavigationServiceFactory.getLinksWithCache")))}).then(function(t){if(t.length!==0){var r={};for(var s=0;s<t.length;s++){if(t[s].length>0&&i.newArgs[s][0].links===undefined){r[i.newArgs[s][0].semanticObject]={links:t[s]};n.linksCache=Object.assign(n.linksCache,r)}}}if(i.cachedLinks.length===0){e(t)}else{var o=[];var a=0;for(var c=0;c<i.oldArgs.length;c++){if(a<t.length){if(t[a].length>0&&i.oldArgs[c][0].semanticObject===i.newArgs[a][0].semanticObject){o.push(t[a]);a++}else{o.push(i.oldArgs[c][0].links)}}else{o.push(i.oldArgs[c][0].links)}}e(o)}})}}})};r.getShellContainer=function e(){return this.oShellContainer};r.toExternal=function e(t,n){this.crossAppNavService.toExternal(t,n)};r.getStartupAppState=function e(t){var n=this;return new Promise(function(e,r){n.crossAppNavService.getStartupAppState(t).fail(function(e){r(new Error("".concat(e," sap.fe.core.services.NavigationServiceFactory.getStartupAppState")))}).then(e)})};r.backToPreviousApp=function e(){return this.crossAppNavService.backToPreviousApp()};r.hrefForExternal=function e(t,n,r){return this.crossAppNavService.hrefForExternal(t,n,!!r)};r.hrefForExternalAsync=function e(t,n){return this.crossAppNavService.hrefForExternalAsync(t,n)};r.getAppState=function e(t,n){return h(this.crossAppNavService.getAppState(t,n))};r.createEmptyAppState=function e(t){return this.crossAppNavService.createEmptyAppState(t)};r.createEmptyAppStateAsync=function e(t){return this.crossAppNavService.createEmptyAppStateAsync(t)};r.isNavigationSupported=function e(t,n){return h(this.crossAppNavService.isNavigationSupported(t,n))};r.isInitialNavigation=function e(){return this.crossAppNavService.isInitialNavigation()};r.isInitialNavigationAsync=function e(){return this.crossAppNavService.isInitialNavigationAsync()};r.expandCompactHash=function e(t){return this.crossAppNavService.expandCompactHash(t)};r.parseShellHash=function e(t){return this.urlParsingService.parseShellHash(t)};r.splitHash=function e(t){return this.urlParsingService.splitHash(t)};r.constructShellHash=function e(t){return this.urlParsingService.constructShellHash(t)};r.setDirtyFlag=function e(t){this.oShellContainer.setDirtyFlag(t)};r.registerDirtyStateProvider=function e(t){this.oShellContainer.registerDirtyStateProvider(t)};r.deregisterDirtyStateProvider=function e(t){this.oShellContainer.deregisterDirtyStateProvider(t)};r.createRenderer=function e(){return this.oShellContainer.createRenderer()};r.getUser=function e(){return this.oShellContainer.getUser()};r.hasUShell=function e(){return true};r.registerNavigationFilter=function e(t){this.shellNavigation.registerNavigationFilter(t)};r.unregisterNavigationFilter=function e(t){this.shellNavigation.unregisterNavigationFilter(t)};r.setBackNavigation=function e(t){this.shellUIService.setBackNavigation(t)};r.setHierarchy=function e(t){this.shellUIService.setHierarchy(t)};r.setTitle=function e(t){this.shellUIService.setTitle(t)};r.getContentDensity=function e(){return this.oShellContainer.getUser().getContentDensity()};r.getPrimaryIntent=function e(t,n){var r=this;return new Promise(function(e,i){r.crossAppNavService.getPrimaryIntent(t,n).fail(function(e){i(new Error("".concat(e," sap.fe.core.services.NavigationServiceFactory.getPrimaryIntent")))}).then(e)})};return t}(e);var v=function(e){c(t,e);function t(){return e.apply(this,arguments)||this}var n=t.prototype;n.createInstance=function e(t){t.settings.shellContainer=sap.ushell&&sap.ushell.Container;var n=t.settings.shellContainer?new f(t):new l(t);return n.initPromise.then(function(){t.scopeObject.getShellServices=function(){return n};return n})};return t}(t);return v},false);
//# sourceMappingURL=ShellServicesFactory.js.map