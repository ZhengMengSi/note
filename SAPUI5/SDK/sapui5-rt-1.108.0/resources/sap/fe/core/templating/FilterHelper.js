/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/ui/mdc/condition/Condition","sap/ui/mdc/enum/ConditionValidated"],function(e,t,n){"use strict";var a={};function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach(function(t){o(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function o(e,t,n){if(t in e){Object.defineProperty(e,t,{value:n,enumerable:true,configurable:true,writable:true})}else{e[t]=n}return e}var d=["Edm.Boolean","Edm.Byte","Edm.Date","Edm.DateTime","Edm.DateTimeOffset","Edm.Decimal","Edm.Double","Edm.Float","Edm.Guid","Edm.Int16","Edm.Int32","Edm.Int64","Edm.SByte","Edm.Single","Edm.String","Edm.Time","Edm.TimeOfDay"];var l={Contains:"NotContains",StartsWith:"NotStartsWith",EndsWith:"NotEndsWith",Empty:"NotEmpty",NotEmpty:"Empty",LE:"NOTLE",GE:"NOTGE",LT:"NOTLT",GT:"NOTGT",BT:"NOTBT",NE:"EQ",EQ:"NE"};function c(e){var t;if(e.match(/^(\d{4})-(\d{1,2})-(\d{1,2})T(\d{1,2}):(\d{1,2}):(\d{1,2})\+(\d{1,4})/)){t=e.match(/^(\d{4})-(\d{1,2})-(\d{1,2})T(\d{1,2}):(\d{1,2}):(\d{1,2})\+(\d{1,4})/)[0]}else if(e.match(/^(\d{4})-(\d{1,2})-(\d{1,2})T(\d{1,2}):(\d{1,2}):(\d{1,2})/)){t="".concat(e.match(/^(\d{4})-(\d{1,2})-(\d{1,2})T(\d{1,2}):(\d{1,2}):(\d{1,2})/)[0],"+0000")}else if(e.match(/^(\d{4})-(\d{1,2})-(\d{1,2})/)){t="".concat(e.match(/^(\d{4})-(\d{1,2})-(\d{1,2})/)[0],"T00:00:00+0000")}else if(e.indexOf("Z")===e.length-1){t="".concat(e.split("Z")[0],"+0100")}else{t=undefined}return t}a._getDateTimeOffsetCompliantValue=c;function u(e){return e.match(/^(\d{4})-(\d{1,2})-(\d{1,2})/)?e.match(/^(\d{4})-(\d{1,2})-(\d{1,2})/)[0]:e.match(/^(\d{8})/)&&e.match(/^(\d{8})/)[0]}a._getDateCompliantValue=u;function s(e,t){var n;if(d.indexOf(t)===-1){return undefined}n=e;switch(t){case"Edm.Boolean":n=e==="true"||(e==="false"?false:undefined);break;case"Edm.Double":case"Edm.Single":n=isNaN(e)?undefined:parseFloat(e);break;case"Edm.Byte":case"Edm.Int16":case"Edm.Int32":case"Edm.SByte":n=isNaN(e)?undefined:parseInt(e,10);break;case"Edm.Date":n=u(e);break;case"Edm.DateTimeOffset":n=c(e);break;case"Edm.TimeOfDay":n=e.match(/(\d{1,2}):(\d{1,2}):(\d{1,2})/)?e.match(/(\d{1,2}):(\d{1,2}):(\d{1,2})/)[0]:undefined;break;default:}return n===null?undefined:n}a.getTypeCompliantValue=s;function f(t,n,a,r){var i=n,o,d;var c={};c.values=[];c.isEmpty=null;if(n===undefined||n===null){return}switch(t){case"CP":d="Contains";if(i){var u=i.indexOf("*");var s=i.lastIndexOf("*");if(u>-1){if(u===0&&s!==i.length-1){d="EndsWith";i=i.substring(1,i.length)}else if(u!==0&&s===i.length-1){d="StartsWith";i=i.substring(0,i.length-1)}else{i=i.substring(1,i.length-1)}}else{e.warning("Contains Option cannot be used without '*'.");return}}break;case"EQ":d=n===""?"Empty":t;break;case"NE":d=n===""?"NotEmpty":t;break;case"BT":if(a===undefined||a===null){return}o=a;d=t;break;case"LE":case"GE":case"GT":case"LT":d=t;break;default:e.warning("Selection Option is not supported : '".concat(t,"'"));return}if(r==="E"){d=l[d]}c.operator=d;if(d!=="Empty"){c.values.push(i);if(o){c.values.push(o)}}return c}a.resolveConditionValues=f;function v(e){return e.indexOf("/")>0?e.split("/")[1]:e}a.getRangeProperty=v;function m(e,t,n,a){var r=[];e===null||e===void 0?void 0:e.forEach(function(e){var i=a?a(e,t,n):h(e,t);if(i){r.push(i)}});return r}function p(e,t,n){var a=e.lastIndexOf("/");var r=a>-1?e.substring(0,e.lastIndexOf("/")+1):"";var i=t.getObject("".concat(n,"/").concat(r));return i===null||i===void 0?void 0:i[e.replace(r,"")]}function E(e,t,n,a){var r=e.PropertyName,i={},o=r.value||r.$PropertyPath,d=e.Ranges;var l=p(o,t,n);if(l){var c=m(d,l,o,a);if(c.length){i[o]=(i[o]||[]).concat(c)}}return i}function g(e,t,a,r){var o={};if(!a){return o}var d=a.SelectOptions,l=a.Parameters;d===null||d===void 0?void 0:d.forEach(function(n){var a=n.PropertyName,d=a.value||a.$PropertyPath;if(Object.keys(o).includes(d)){o[d]=o[d].concat(E(n,t,e,r)[d])}else{o=i(i({},o),E(n,t,e,r))}});l===null||l===void 0?void 0:l.forEach(function(e){var t=e.PropertyName.value||e.PropertyName.$PropertyPath;var a=r?{operator:"EQ",value1:e.PropertyValue,value2:null,path:t,isParameter:true}:{operator:"EQ",values:[e.PropertyValue],isEmpty:null,validated:n.Validated,isParameter:true};o[t]=[a]});return o}a.getFiltersConditionsFromSelectionVariant=g;function h(e,a){var r;var i=e.Sign?v(e.Sign):undefined;var o=e.Option?v(e.Option):undefined;var d=s(e.Low,a.$Type||a.type);var l=e.High?s(e.High,a.$Type||a.type):undefined;var c=f(o,d,l,i);if(c){r=t.createCondition(c.operator,c.values,null,null,n.Validated)}return r}a.getConditions=h;var O=function(e,a){var r={};var i=e.getInterface(1).getPath(),o=e.getInterface(1).getModel();if(a){for(var d in a){var l=o.getObject("".concat(i,"/").concat(d,"@com.sap.vocabularies.Common.v1.FilterDefaultValue"));if(l!==undefined){var c=d;r[c]=[t.createCondition("EQ",[l],null,null,n.Validated)]}}}return r};var b=function(e,n,a){var r={};var i=e.getInterface(1);var o=i.getModel();var d=i.getPath();for(var l in a){if(a[l][0]){var c=l.split("::");var u="";var s=c.length;var f=c.slice(0,c.length-1).join("/");var v=c[s-1];if(f){var m=o.getObject(d+"/"+f);if(m.$kind==="NavigationProperty"&&m.$isCollection){u+="".concat(f,"*/")}else if(m.$kind==="NavigationProperty"){u+="".concat(f,"/")}}u+=v;var p="values"in a[l][0]?a[l][0].values:[];r[u]=[t.createCondition(a[l][0].operator,p,null,null,null)]}}return r};function y(){var e={};e["$editState"]=[t.createCondition("DRAFT_EDIT_STATE",["ALL"],null,null,n.Validated)];return e}function T(e,t){var n,a;var r;var o=e.getInterface(1).getPath(),d=e.getInterface(1).getModel(),l=d.getObject("".concat(o,"@")),c=d.getObject("".concat(o,"/"));if(l["@com.sap.vocabularies.Common.v1.DraftRoot"]||l["@com.sap.vocabularies.Common.v1.DraftNode"]){r=y()}var u=(n=t)===null||n===void 0?void 0:n.selectionVariant;var s=((a=t)===null||a===void 0?void 0:a.defaultSemanticDates)||{};var f=O(e,c);var v=b(e,c,s);if(u){t=g(o,d,u)}else if(f){t=f}if(v){t=i(i({},t),v)}if(r){t=i(i({},t),r)}return Object.keys(t).length>0?JSON.stringify(t).replace(/([\{\}])/g,"\\$1"):undefined}a.getFilterConditions=T;T.requiresIContext=true;return a},false);
//# sourceMappingURL=FilterHelper.js.map