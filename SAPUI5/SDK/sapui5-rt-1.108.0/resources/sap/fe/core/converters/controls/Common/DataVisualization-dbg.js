/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/core/converters/helpers/IssueManager", "sap/fe/macros/CommonHelper", "../../ManifestSettings", "./Chart", "./Table"], function (IssueManager, CommonHelper, ManifestSettings, Chart, Table) {
  "use strict";

  var _exports = {};
  var createChartVisualization = Chart.createChartVisualization;
  var TemplateType = ManifestSettings.TemplateType;
  var IssueType = IssueManager.IssueType;
  var IssueSeverity = IssueManager.IssueSeverity;
  var IssueCategory = IssueManager.IssueCategory;

  var getVisualizationsFromPresentationVariant = function (presentationVariantAnnotation, visualizationPath, converterContext) {
    var visualizationAnnotations = [];
    var bIsALP = converterContext.getManifestWrapper().hasMultipleVisualizations() || converterContext.getTemplateType() === TemplateType.AnalyticalListPage;

    if (!isPresentationCompliant(presentationVariantAnnotation, bIsALP)) {
      var entityType = converterContext.getEntityType();
      var defaultLineItemAnnotation = getDefaultLineItem(entityType);

      if (defaultLineItemAnnotation) {
        visualizationAnnotations.push({
          visualization: defaultLineItemAnnotation,
          annotationPath: converterContext.getRelativeAnnotationPath(defaultLineItemAnnotation.fullyQualifiedName, entityType),
          converterContext: converterContext
        });
      }
    } else {
      var baseVisualizationPath = visualizationPath.split("@")[0];
      var visualizations = presentationVariantAnnotation.Visualizations;

      var pushFirstVizOfType = function (allowedTerms) {
        var firstViz = visualizations.find(function (viz) {
          return allowedTerms.indexOf(viz.$target.term) >= 0;
        });

        if (firstViz) {
          visualizationAnnotations.push({
            visualization: firstViz.$target,
            annotationPath: "".concat(baseVisualizationPath).concat(firstViz.value),
            converterContext: converterContext
          });
        }
      };

      if (bIsALP) {
        // In case of ALP, we use the first LineItem and the first Chart
        pushFirstVizOfType(["com.sap.vocabularies.UI.v1.LineItem"]);
        pushFirstVizOfType(["com.sap.vocabularies.UI.v1.Chart"]);
      } else {
        // Otherwise, we use the first viz only (Chart or LineItem)
        pushFirstVizOfType(["com.sap.vocabularies.UI.v1.LineItem", "com.sap.vocabularies.UI.v1.Chart"]);
      }
    }

    return visualizationAnnotations;
  };

  _exports.getVisualizationsFromPresentationVariant = getVisualizationsFromPresentationVariant;

  function getSelectionPresentationVariant(entityType, annotationPath, converterContext) {
    if (annotationPath) {
      var resolvedTarget = converterContext.getEntityTypeAnnotation(annotationPath);
      var selectionPresentationVariant = resolvedTarget.annotation;

      if (selectionPresentationVariant) {
        if (selectionPresentationVariant.term === "com.sap.vocabularies.UI.v1.SelectionPresentationVariant") {
          return selectionPresentationVariant;
        }
      } else {
        throw new Error("Annotation Path for the SPV mentioned in the manifest is not found, Please add the SPV in the annotation");
      }
    } else {
      var _entityType$annotatio, _entityType$annotatio2;

      return (_entityType$annotatio = entityType.annotations) === null || _entityType$annotatio === void 0 ? void 0 : (_entityType$annotatio2 = _entityType$annotatio.UI) === null || _entityType$annotatio2 === void 0 ? void 0 : _entityType$annotatio2.SelectionPresentationVariant;
    }
  }

  _exports.getSelectionPresentationVariant = getSelectionPresentationVariant;

  function isSelectionPresentationCompliant(SelectionPresentationVariant, bIsALP) {
    var presentationVariant = SelectionPresentationVariant && SelectionPresentationVariant.PresentationVariant;

    if (presentationVariant) {
      return isPresentationCompliant(presentationVariant, bIsALP);
    } else {
      throw new Error("Presentation Variant is not present in the SPV annotation");
    }
  }

  _exports.isSelectionPresentationCompliant = isSelectionPresentationCompliant;

  function isPresentationCompliant(presentationVariant) {
    var bIsALP = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;
    var bHasTable = false,
        bHasChart = false;

    if (bIsALP) {
      if (presentationVariant !== null && presentationVariant !== void 0 && presentationVariant.Visualizations) {
        var aVisualizations = presentationVariant.Visualizations;
        aVisualizations.forEach(function (oVisualization) {
          if (oVisualization.$target.term === "com.sap.vocabularies.UI.v1.LineItem") {
            bHasTable = true;
          }

          if (oVisualization.$target.term === "com.sap.vocabularies.UI.v1.Chart") {
            bHasChart = true;
          }
        });
      }

      return bHasChart && bHasTable;
    } else {
      return (presentationVariant === null || presentationVariant === void 0 ? void 0 : presentationVariant.Visualizations) && !!presentationVariant.Visualizations.find(function (visualization) {
        return visualization.$target.term === "com.sap.vocabularies.UI.v1.LineItem" || visualization.$target.term === "com.sap.vocabularies.UI.v1.Chart";
      });
    }
  }

  _exports.isPresentationCompliant = isPresentationCompliant;

  function getDefaultLineItem(entityType) {
    var _entityType$annotatio3;

    return (_entityType$annotatio3 = entityType.annotations.UI) === null || _entityType$annotatio3 === void 0 ? void 0 : _entityType$annotatio3.LineItem;
  }

  _exports.getDefaultLineItem = getDefaultLineItem;

  function getDefaultChart(entityType) {
    var _entityType$annotatio4;

    return (_entityType$annotatio4 = entityType.annotations.UI) === null || _entityType$annotatio4 === void 0 ? void 0 : _entityType$annotatio4.Chart;
  }

  _exports.getDefaultChart = getDefaultChart;

  function getDefaultPresentationVariant(entityType) {
    var _entityType$annotatio5, _entityType$annotatio6;

    return (_entityType$annotatio5 = entityType.annotations) === null || _entityType$annotatio5 === void 0 ? void 0 : (_entityType$annotatio6 = _entityType$annotatio5.UI) === null || _entityType$annotatio6 === void 0 ? void 0 : _entityType$annotatio6.PresentationVariant;
  }

  _exports.getDefaultPresentationVariant = getDefaultPresentationVariant;

  function getDefaultSelectionVariant(entityType) {
    var _entityType$annotatio7, _entityType$annotatio8;

    return (_entityType$annotatio7 = entityType.annotations) === null || _entityType$annotatio7 === void 0 ? void 0 : (_entityType$annotatio8 = _entityType$annotatio7.UI) === null || _entityType$annotatio8 === void 0 ? void 0 : _entityType$annotatio8.SelectionVariant;
  }

  _exports.getDefaultSelectionVariant = getDefaultSelectionVariant;

  function getSelectionVariant(entityType, converterContext) {
    var annotationPath = converterContext.getManifestWrapper().getDefaultTemplateAnnotationPath();
    var selectionPresentationVariant = getSelectionPresentationVariant(entityType, annotationPath, converterContext);
    var selectionVariant;

    if (selectionPresentationVariant) {
      selectionVariant = selectionPresentationVariant.SelectionVariant;

      if (selectionVariant) {
        return selectionVariant;
      }
    } else {
      selectionVariant = getDefaultSelectionVariant(entityType);
      return selectionVariant;
    }
  }

  _exports.getSelectionVariant = getSelectionVariant;

  function getDataVisualizationConfiguration(visualizationPath, isCondensedTableLayoutCompliant, inConverterContext, viewConfiguration, doNotCheckApplySupported, associatedPresentationVariantPath) {
    var resolvedTarget = visualizationPath !== "" ? inConverterContext.getEntityTypeAnnotation(visualizationPath) : {
      annotation: undefined,
      converterContext: inConverterContext
    };
    var resolvedAssociatedPresentationVariant = associatedPresentationVariantPath ? inConverterContext.getEntityTypeAnnotation(associatedPresentationVariantPath) : null;
    var resolvedVisualization = resolvedTarget.annotation;
    inConverterContext = resolvedTarget.converterContext;
    var visualizationAnnotations = [];
    var presentationVariantAnnotation;
    var presentationPath = "";
    var chartVisualization, tableVisualization;
    var sTerm = resolvedVisualization === null || resolvedVisualization === void 0 ? void 0 : resolvedVisualization.term;

    if (sTerm) {
      switch (sTerm) {
        case "com.sap.vocabularies.UI.v1.LineItem":
        case "com.sap.vocabularies.UI.v1.Chart":
          presentationVariantAnnotation = resolvedAssociatedPresentationVariant === null || resolvedAssociatedPresentationVariant === void 0 ? void 0 : resolvedAssociatedPresentationVariant.annotation;
          visualizationAnnotations.push({
            visualization: resolvedVisualization,
            annotationPath: visualizationPath,
            converterContext: inConverterContext
          });
          break;

        case "com.sap.vocabularies.UI.v1.PresentationVariant":
          presentationVariantAnnotation = resolvedVisualization;
          visualizationAnnotations = visualizationAnnotations.concat(getVisualizationsFromPresentationVariant(resolvedVisualization, visualizationPath, inConverterContext));
          break;

        case "com.sap.vocabularies.UI.v1.SelectionPresentationVariant":
          presentationVariantAnnotation = resolvedVisualization.PresentationVariant; // Presentation can be inline or outside the SelectionPresentationVariant

          presentationPath = presentationVariantAnnotation.fullyQualifiedName;
          visualizationAnnotations = visualizationAnnotations.concat(getVisualizationsFromPresentationVariant(presentationVariantAnnotation, visualizationPath, inConverterContext));
          break;

        default:
          break;
      }

      visualizationAnnotations.forEach(function (visualizationAnnotation) {
        var visualization = visualizationAnnotation.visualization,
            annotationPath = visualizationAnnotation.annotationPath,
            converterContext = visualizationAnnotation.converterContext;

        switch (visualization.term) {
          case "com.sap.vocabularies.UI.v1.Chart":
            chartVisualization = createChartVisualization(visualization, annotationPath, converterContext, doNotCheckApplySupported);
            break;

          case "com.sap.vocabularies.UI.v1.LineItem":
          default:
            tableVisualization = Table.createTableVisualization(visualization, annotationPath, converterContext, presentationVariantAnnotation, isCondensedTableLayoutCompliant, viewConfiguration);
            break;
        }
      });
    } else {
      tableVisualization = Table.createDefaultTableVisualization(inConverterContext);
      inConverterContext.getDiagnostics().addIssue(IssueCategory.Annotation, IssueSeverity.Medium, IssueType.MISSING_LINEITEM);
    }

    var aVisualizations = [];
    var sPath = sTerm === "com.sap.vocabularies.UI.v1.SelectionPresentationVariant" ? presentationPath : resolvedVisualization && resolvedVisualization.fullyQualifiedName;

    if (sPath === undefined) {
      sPath = "/";
    }

    if (chartVisualization) {
      aVisualizations.push(chartVisualization);
    }

    if (tableVisualization) {
      aVisualizations.push(tableVisualization);
    }

    return {
      visualizations: aVisualizations,
      annotationPath: inConverterContext.getEntitySetBasedAnnotationPath(sPath)
    };
  }
  /**
   * Return UI Control (LineItem/Chart) Context.
   *
   * @function
   * @name getUiControl
   * @param oPresentationContext Presentation context object (Presentation variant or UI.LineItem/Chart)
   * @param sControlPath Control path
   * @returns The Control (LineItem/Chart) context
   */


  _exports.getDataVisualizationConfiguration = getDataVisualizationConfiguration;

  function getUiControl(oPresentationContext, sControlPath) {
    var oPresentation = oPresentationContext.getObject(oPresentationContext.getPath()),
        oPresentationVariantPath = CommonHelper.createPresentationPathContext(oPresentationContext),
        oModel = oPresentationContext.getModel();

    if (CommonHelper._isPresentationVariantAnnotation(oPresentationVariantPath.getPath())) {
      // Uncomplete PresentationVariant can be passed to macro via SelectionPresentationVariant
      var aVisualizations = oPresentation.Visualizations;

      if (Array.isArray(aVisualizations)) {
        for (var i = 0; i < aVisualizations.length; i++) {
          if (aVisualizations[i].$AnnotationPath.indexOf(sControlPath) !== -1) {
            sControlPath = aVisualizations[i].$AnnotationPath;
            break;
          }
        }
      }

      return oModel.getMetaContext(oPresentationContext.getPath().split("@")[0] + sControlPath);
    }

    return oPresentationContext;
  }

  _exports.getUiControl = getUiControl;
  return _exports;
}, false);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJnZXRWaXN1YWxpemF0aW9uc0Zyb21QcmVzZW50YXRpb25WYXJpYW50IiwicHJlc2VudGF0aW9uVmFyaWFudEFubm90YXRpb24iLCJ2aXN1YWxpemF0aW9uUGF0aCIsImNvbnZlcnRlckNvbnRleHQiLCJ2aXN1YWxpemF0aW9uQW5ub3RhdGlvbnMiLCJiSXNBTFAiLCJnZXRNYW5pZmVzdFdyYXBwZXIiLCJoYXNNdWx0aXBsZVZpc3VhbGl6YXRpb25zIiwiZ2V0VGVtcGxhdGVUeXBlIiwiVGVtcGxhdGVUeXBlIiwiQW5hbHl0aWNhbExpc3RQYWdlIiwiaXNQcmVzZW50YXRpb25Db21wbGlhbnQiLCJlbnRpdHlUeXBlIiwiZ2V0RW50aXR5VHlwZSIsImRlZmF1bHRMaW5lSXRlbUFubm90YXRpb24iLCJnZXREZWZhdWx0TGluZUl0ZW0iLCJwdXNoIiwidmlzdWFsaXphdGlvbiIsImFubm90YXRpb25QYXRoIiwiZ2V0UmVsYXRpdmVBbm5vdGF0aW9uUGF0aCIsImZ1bGx5UXVhbGlmaWVkTmFtZSIsImJhc2VWaXN1YWxpemF0aW9uUGF0aCIsInNwbGl0IiwidmlzdWFsaXphdGlvbnMiLCJWaXN1YWxpemF0aW9ucyIsInB1c2hGaXJzdFZpek9mVHlwZSIsImFsbG93ZWRUZXJtcyIsImZpcnN0Vml6IiwiZmluZCIsInZpeiIsImluZGV4T2YiLCIkdGFyZ2V0IiwidGVybSIsInZhbHVlIiwiZ2V0U2VsZWN0aW9uUHJlc2VudGF0aW9uVmFyaWFudCIsInJlc29sdmVkVGFyZ2V0IiwiZ2V0RW50aXR5VHlwZUFubm90YXRpb24iLCJzZWxlY3Rpb25QcmVzZW50YXRpb25WYXJpYW50IiwiYW5ub3RhdGlvbiIsIkVycm9yIiwiYW5ub3RhdGlvbnMiLCJVSSIsIlNlbGVjdGlvblByZXNlbnRhdGlvblZhcmlhbnQiLCJpc1NlbGVjdGlvblByZXNlbnRhdGlvbkNvbXBsaWFudCIsInByZXNlbnRhdGlvblZhcmlhbnQiLCJQcmVzZW50YXRpb25WYXJpYW50IiwiYkhhc1RhYmxlIiwiYkhhc0NoYXJ0IiwiYVZpc3VhbGl6YXRpb25zIiwiZm9yRWFjaCIsIm9WaXN1YWxpemF0aW9uIiwiTGluZUl0ZW0iLCJnZXREZWZhdWx0Q2hhcnQiLCJDaGFydCIsImdldERlZmF1bHRQcmVzZW50YXRpb25WYXJpYW50IiwiZ2V0RGVmYXVsdFNlbGVjdGlvblZhcmlhbnQiLCJTZWxlY3Rpb25WYXJpYW50IiwiZ2V0U2VsZWN0aW9uVmFyaWFudCIsImdldERlZmF1bHRUZW1wbGF0ZUFubm90YXRpb25QYXRoIiwic2VsZWN0aW9uVmFyaWFudCIsImdldERhdGFWaXN1YWxpemF0aW9uQ29uZmlndXJhdGlvbiIsImlzQ29uZGVuc2VkVGFibGVMYXlvdXRDb21wbGlhbnQiLCJpbkNvbnZlcnRlckNvbnRleHQiLCJ2aWV3Q29uZmlndXJhdGlvbiIsImRvTm90Q2hlY2tBcHBseVN1cHBvcnRlZCIsImFzc29jaWF0ZWRQcmVzZW50YXRpb25WYXJpYW50UGF0aCIsInVuZGVmaW5lZCIsInJlc29sdmVkQXNzb2NpYXRlZFByZXNlbnRhdGlvblZhcmlhbnQiLCJyZXNvbHZlZFZpc3VhbGl6YXRpb24iLCJwcmVzZW50YXRpb25QYXRoIiwiY2hhcnRWaXN1YWxpemF0aW9uIiwidGFibGVWaXN1YWxpemF0aW9uIiwic1Rlcm0iLCJjb25jYXQiLCJ2aXN1YWxpemF0aW9uQW5ub3RhdGlvbiIsImNyZWF0ZUNoYXJ0VmlzdWFsaXphdGlvbiIsIlRhYmxlIiwiY3JlYXRlVGFibGVWaXN1YWxpemF0aW9uIiwiY3JlYXRlRGVmYXVsdFRhYmxlVmlzdWFsaXphdGlvbiIsImdldERpYWdub3N0aWNzIiwiYWRkSXNzdWUiLCJJc3N1ZUNhdGVnb3J5IiwiQW5ub3RhdGlvbiIsIklzc3VlU2V2ZXJpdHkiLCJNZWRpdW0iLCJJc3N1ZVR5cGUiLCJNSVNTSU5HX0xJTkVJVEVNIiwic1BhdGgiLCJnZXRFbnRpdHlTZXRCYXNlZEFubm90YXRpb25QYXRoIiwiZ2V0VWlDb250cm9sIiwib1ByZXNlbnRhdGlvbkNvbnRleHQiLCJzQ29udHJvbFBhdGgiLCJvUHJlc2VudGF0aW9uIiwiZ2V0T2JqZWN0IiwiZ2V0UGF0aCIsIm9QcmVzZW50YXRpb25WYXJpYW50UGF0aCIsIkNvbW1vbkhlbHBlciIsImNyZWF0ZVByZXNlbnRhdGlvblBhdGhDb250ZXh0Iiwib01vZGVsIiwiZ2V0TW9kZWwiLCJfaXNQcmVzZW50YXRpb25WYXJpYW50QW5ub3RhdGlvbiIsIkFycmF5IiwiaXNBcnJheSIsImkiLCJsZW5ndGgiLCIkQW5ub3RhdGlvblBhdGgiLCJnZXRNZXRhQ29udGV4dCJdLCJzb3VyY2VSb290IjoiLiIsInNvdXJjZXMiOlsiRGF0YVZpc3VhbGl6YXRpb24udHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHR5cGUgeyBFbnRpdHlUeXBlIH0gZnJvbSBcIkBzYXAtdXgvdm9jYWJ1bGFyaWVzLXR5cGVzXCI7XG5pbXBvcnQgdHlwZSB7XG5cdENoYXJ0LFxuXHRMaW5lSXRlbSxcblx0UHJlc2VudGF0aW9uVmFyaWFudCxcblx0UHJlc2VudGF0aW9uVmFyaWFudFR5cGUsXG5cdFNlbGVjdGlvblByZXNlbnRhdGlvblZhcmlhbnQsXG5cdFNlbGVjdGlvblZhcmlhbnRcbn0gZnJvbSBcIkBzYXAtdXgvdm9jYWJ1bGFyaWVzLXR5cGVzL3ZvY2FidWxhcmllcy9VSVwiO1xuaW1wb3J0IHsgVUlBbm5vdGF0aW9uVGVybXMgfSBmcm9tIFwiQHNhcC11eC92b2NhYnVsYXJpZXMtdHlwZXMvdm9jYWJ1bGFyaWVzL1VJXCI7XG5pbXBvcnQgeyBJc3N1ZUNhdGVnb3J5LCBJc3N1ZVNldmVyaXR5LCBJc3N1ZVR5cGUgfSBmcm9tIFwic2FwL2ZlL2NvcmUvY29udmVydGVycy9oZWxwZXJzL0lzc3VlTWFuYWdlclwiO1xuaW1wb3J0IENvbW1vbkhlbHBlciBmcm9tIFwic2FwL2ZlL21hY3Jvcy9Db21tb25IZWxwZXJcIjtcbmltcG9ydCB0eXBlIENvbnRleHQgZnJvbSBcInNhcC91aS9tb2RlbC9Db250ZXh0XCI7XG5pbXBvcnQgdHlwZSBPRGF0YU1vZGVsIGZyb20gXCJzYXAvdWkvbW9kZWwvb2RhdGEvdjQvT0RhdGFNb2RlbFwiO1xuaW1wb3J0IHR5cGUgQ29udmVydGVyQ29udGV4dCBmcm9tIFwiLi4vLi4vQ29udmVydGVyQ29udGV4dFwiO1xuaW1wb3J0IHR5cGUgeyBWaWV3UGF0aENvbmZpZ3VyYXRpb24gfSBmcm9tIFwiLi4vLi4vTWFuaWZlc3RTZXR0aW5nc1wiO1xuaW1wb3J0IHsgVGVtcGxhdGVUeXBlIH0gZnJvbSBcIi4uLy4uL01hbmlmZXN0U2V0dGluZ3NcIjtcbmltcG9ydCB0eXBlIHsgQ2hhcnRWaXN1YWxpemF0aW9uIH0gZnJvbSBcIi4vQ2hhcnRcIjtcbmltcG9ydCB7IGNyZWF0ZUNoYXJ0VmlzdWFsaXphdGlvbiB9IGZyb20gXCIuL0NoYXJ0XCI7XG5pbXBvcnQgdHlwZSB7IFRhYmxlVmlzdWFsaXphdGlvbiB9IGZyb20gXCIuL1RhYmxlXCI7XG5pbXBvcnQgVGFibGUgZnJvbSBcIi4vVGFibGVcIjtcblxuZXhwb3J0IHR5cGUgRGF0YVZpc3VhbGl6YXRpb25Bbm5vdGF0aW9ucyA9IExpbmVJdGVtIHwgQ2hhcnQgfCBQcmVzZW50YXRpb25WYXJpYW50IHwgU2VsZWN0aW9uVmFyaWFudCB8IFNlbGVjdGlvblByZXNlbnRhdGlvblZhcmlhbnQ7XG5cbmV4cG9ydCB0eXBlIEFjdHVhbFZpc3VhbGl6YXRpb25Bbm5vdGF0aW9ucyA9IExpbmVJdGVtIHwgQ2hhcnQ7XG5cbmV4cG9ydCB0eXBlIFZpc3VhbGl6YXRpb25BbmRQYXRoID0ge1xuXHR2aXN1YWxpemF0aW9uOiBBY3R1YWxWaXN1YWxpemF0aW9uQW5ub3RhdGlvbnM7XG5cdGFubm90YXRpb25QYXRoOiBzdHJpbmc7XG5cdHNlbGVjdGlvblZhcmlhbnRQYXRoPzogc3RyaW5nO1xuXHRjb252ZXJ0ZXJDb250ZXh0OiBDb252ZXJ0ZXJDb250ZXh0O1xufTtcblxuZXhwb3J0IHR5cGUgRGF0YVZpc3VhbGl6YXRpb25EZWZpbml0aW9uID0ge1xuXHR2aXN1YWxpemF0aW9uczogKFRhYmxlVmlzdWFsaXphdGlvbiB8IENoYXJ0VmlzdWFsaXphdGlvbilbXTtcblx0YW5ub3RhdGlvblBhdGg6IHN0cmluZztcbn07XG5cbmV4cG9ydCBjb25zdCBnZXRWaXN1YWxpemF0aW9uc0Zyb21QcmVzZW50YXRpb25WYXJpYW50ID0gZnVuY3Rpb24gKFxuXHRwcmVzZW50YXRpb25WYXJpYW50QW5ub3RhdGlvbjogUHJlc2VudGF0aW9uVmFyaWFudFR5cGUsXG5cdHZpc3VhbGl6YXRpb25QYXRoOiBzdHJpbmcsXG5cdGNvbnZlcnRlckNvbnRleHQ6IENvbnZlcnRlckNvbnRleHRcbik6IFZpc3VhbGl6YXRpb25BbmRQYXRoW10ge1xuXHRjb25zdCB2aXN1YWxpemF0aW9uQW5ub3RhdGlvbnM6IFZpc3VhbGl6YXRpb25BbmRQYXRoW10gPSBbXTtcblxuXHRjb25zdCBiSXNBTFAgPVxuXHRcdGNvbnZlcnRlckNvbnRleHQuZ2V0TWFuaWZlc3RXcmFwcGVyKCkuaGFzTXVsdGlwbGVWaXN1YWxpemF0aW9ucygpIHx8XG5cdFx0Y29udmVydGVyQ29udGV4dC5nZXRUZW1wbGF0ZVR5cGUoKSA9PT0gVGVtcGxhdGVUeXBlLkFuYWx5dGljYWxMaXN0UGFnZTtcblxuXHRpZiAoIWlzUHJlc2VudGF0aW9uQ29tcGxpYW50KHByZXNlbnRhdGlvblZhcmlhbnRBbm5vdGF0aW9uLCBiSXNBTFApKSB7XG5cdFx0Y29uc3QgZW50aXR5VHlwZSA9IGNvbnZlcnRlckNvbnRleHQuZ2V0RW50aXR5VHlwZSgpO1xuXHRcdGNvbnN0IGRlZmF1bHRMaW5lSXRlbUFubm90YXRpb24gPSBnZXREZWZhdWx0TGluZUl0ZW0oZW50aXR5VHlwZSk7XG5cdFx0aWYgKGRlZmF1bHRMaW5lSXRlbUFubm90YXRpb24pIHtcblx0XHRcdHZpc3VhbGl6YXRpb25Bbm5vdGF0aW9ucy5wdXNoKHtcblx0XHRcdFx0dmlzdWFsaXphdGlvbjogZGVmYXVsdExpbmVJdGVtQW5ub3RhdGlvbixcblx0XHRcdFx0YW5ub3RhdGlvblBhdGg6IGNvbnZlcnRlckNvbnRleHQuZ2V0UmVsYXRpdmVBbm5vdGF0aW9uUGF0aChkZWZhdWx0TGluZUl0ZW1Bbm5vdGF0aW9uLmZ1bGx5UXVhbGlmaWVkTmFtZSwgZW50aXR5VHlwZSksXG5cdFx0XHRcdGNvbnZlcnRlckNvbnRleHQ6IGNvbnZlcnRlckNvbnRleHRcblx0XHRcdH0pO1xuXHRcdH1cblx0fSBlbHNlIHtcblx0XHRjb25zdCBiYXNlVmlzdWFsaXphdGlvblBhdGggPSB2aXN1YWxpemF0aW9uUGF0aC5zcGxpdChcIkBcIilbMF07XG5cdFx0Y29uc3QgdmlzdWFsaXphdGlvbnMgPSBwcmVzZW50YXRpb25WYXJpYW50QW5ub3RhdGlvbi5WaXN1YWxpemF0aW9ucztcblxuXHRcdGNvbnN0IHB1c2hGaXJzdFZpek9mVHlwZSA9IGZ1bmN0aW9uIChhbGxvd2VkVGVybXM6IHN0cmluZ1tdKSB7XG5cdFx0XHRjb25zdCBmaXJzdFZpeiA9IHZpc3VhbGl6YXRpb25zLmZpbmQoKHZpeikgPT4ge1xuXHRcdFx0XHRyZXR1cm4gYWxsb3dlZFRlcm1zLmluZGV4T2Yodml6LiR0YXJnZXQudGVybSkgPj0gMDtcblx0XHRcdH0pO1xuXG5cdFx0XHRpZiAoZmlyc3RWaXopIHtcblx0XHRcdFx0dmlzdWFsaXphdGlvbkFubm90YXRpb25zLnB1c2goe1xuXHRcdFx0XHRcdHZpc3VhbGl6YXRpb246IGZpcnN0Vml6LiR0YXJnZXQgYXMgQWN0dWFsVmlzdWFsaXphdGlvbkFubm90YXRpb25zLFxuXHRcdFx0XHRcdGFubm90YXRpb25QYXRoOiBgJHtiYXNlVmlzdWFsaXphdGlvblBhdGh9JHtmaXJzdFZpei52YWx1ZX1gLFxuXHRcdFx0XHRcdGNvbnZlcnRlckNvbnRleHQ6IGNvbnZlcnRlckNvbnRleHRcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fTtcblxuXHRcdGlmIChiSXNBTFApIHtcblx0XHRcdC8vIEluIGNhc2Ugb2YgQUxQLCB3ZSB1c2UgdGhlIGZpcnN0IExpbmVJdGVtIGFuZCB0aGUgZmlyc3QgQ2hhcnRcblx0XHRcdHB1c2hGaXJzdFZpek9mVHlwZShbVUlBbm5vdGF0aW9uVGVybXMuTGluZUl0ZW1dKTtcblx0XHRcdHB1c2hGaXJzdFZpek9mVHlwZShbVUlBbm5vdGF0aW9uVGVybXMuQ2hhcnRdKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gT3RoZXJ3aXNlLCB3ZSB1c2UgdGhlIGZpcnN0IHZpeiBvbmx5IChDaGFydCBvciBMaW5lSXRlbSlcblx0XHRcdHB1c2hGaXJzdFZpek9mVHlwZShbVUlBbm5vdGF0aW9uVGVybXMuTGluZUl0ZW0sIFVJQW5ub3RhdGlvblRlcm1zLkNoYXJ0XSk7XG5cdFx0fVxuXHR9XG5cdHJldHVybiB2aXN1YWxpemF0aW9uQW5ub3RhdGlvbnM7XG59O1xuXG5leHBvcnQgZnVuY3Rpb24gZ2V0U2VsZWN0aW9uUHJlc2VudGF0aW9uVmFyaWFudChcblx0ZW50aXR5VHlwZTogRW50aXR5VHlwZSxcblx0YW5ub3RhdGlvblBhdGg6IHN0cmluZyB8IHVuZGVmaW5lZCxcblx0Y29udmVydGVyQ29udGV4dDogQ29udmVydGVyQ29udGV4dFxuKTogYW55IHtcblx0aWYgKGFubm90YXRpb25QYXRoKSB7XG5cdFx0Y29uc3QgcmVzb2x2ZWRUYXJnZXQgPSBjb252ZXJ0ZXJDb250ZXh0LmdldEVudGl0eVR5cGVBbm5vdGF0aW9uKGFubm90YXRpb25QYXRoKTtcblx0XHRjb25zdCBzZWxlY3Rpb25QcmVzZW50YXRpb25WYXJpYW50ID0gcmVzb2x2ZWRUYXJnZXQuYW5ub3RhdGlvbiBhcyBTZWxlY3Rpb25QcmVzZW50YXRpb25WYXJpYW50O1xuXHRcdGlmIChzZWxlY3Rpb25QcmVzZW50YXRpb25WYXJpYW50KSB7XG5cdFx0XHRpZiAoc2VsZWN0aW9uUHJlc2VudGF0aW9uVmFyaWFudC50ZXJtID09PSBVSUFubm90YXRpb25UZXJtcy5TZWxlY3Rpb25QcmVzZW50YXRpb25WYXJpYW50KSB7XG5cdFx0XHRcdHJldHVybiBzZWxlY3Rpb25QcmVzZW50YXRpb25WYXJpYW50O1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoXCJBbm5vdGF0aW9uIFBhdGggZm9yIHRoZSBTUFYgbWVudGlvbmVkIGluIHRoZSBtYW5pZmVzdCBpcyBub3QgZm91bmQsIFBsZWFzZSBhZGQgdGhlIFNQViBpbiB0aGUgYW5ub3RhdGlvblwiKTtcblx0XHR9XG5cdH0gZWxzZSB7XG5cdFx0cmV0dXJuIGVudGl0eVR5cGUuYW5ub3RhdGlvbnM/LlVJPy5TZWxlY3Rpb25QcmVzZW50YXRpb25WYXJpYW50O1xuXHR9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1NlbGVjdGlvblByZXNlbnRhdGlvbkNvbXBsaWFudChcblx0U2VsZWN0aW9uUHJlc2VudGF0aW9uVmFyaWFudDogU2VsZWN0aW9uUHJlc2VudGF0aW9uVmFyaWFudCxcblx0YklzQUxQOiBib29sZWFuXG4pOiBib29sZWFuIHwgdW5kZWZpbmVkIHtcblx0Y29uc3QgcHJlc2VudGF0aW9uVmFyaWFudCA9IFNlbGVjdGlvblByZXNlbnRhdGlvblZhcmlhbnQgJiYgU2VsZWN0aW9uUHJlc2VudGF0aW9uVmFyaWFudC5QcmVzZW50YXRpb25WYXJpYW50O1xuXHRpZiAocHJlc2VudGF0aW9uVmFyaWFudCkge1xuXHRcdHJldHVybiBpc1ByZXNlbnRhdGlvbkNvbXBsaWFudChwcmVzZW50YXRpb25WYXJpYW50LCBiSXNBTFApO1xuXHR9IGVsc2Uge1xuXHRcdHRocm93IG5ldyBFcnJvcihcIlByZXNlbnRhdGlvbiBWYXJpYW50IGlzIG5vdCBwcmVzZW50IGluIHRoZSBTUFYgYW5ub3RhdGlvblwiKTtcblx0fVxufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNQcmVzZW50YXRpb25Db21wbGlhbnQocHJlc2VudGF0aW9uVmFyaWFudDogUHJlc2VudGF0aW9uVmFyaWFudFR5cGUsIGJJc0FMUCA9IGZhbHNlKTogYm9vbGVhbiB7XG5cdGxldCBiSGFzVGFibGUgPSBmYWxzZSxcblx0XHRiSGFzQ2hhcnQgPSBmYWxzZTtcblx0aWYgKGJJc0FMUCkge1xuXHRcdGlmIChwcmVzZW50YXRpb25WYXJpYW50Py5WaXN1YWxpemF0aW9ucykge1xuXHRcdFx0Y29uc3QgYVZpc3VhbGl6YXRpb25zID0gcHJlc2VudGF0aW9uVmFyaWFudC5WaXN1YWxpemF0aW9ucztcblx0XHRcdGFWaXN1YWxpemF0aW9ucy5mb3JFYWNoKChvVmlzdWFsaXphdGlvbikgPT4ge1xuXHRcdFx0XHRpZiAob1Zpc3VhbGl6YXRpb24uJHRhcmdldC50ZXJtID09PSBVSUFubm90YXRpb25UZXJtcy5MaW5lSXRlbSkge1xuXHRcdFx0XHRcdGJIYXNUYWJsZSA9IHRydWU7XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKG9WaXN1YWxpemF0aW9uLiR0YXJnZXQudGVybSA9PT0gVUlBbm5vdGF0aW9uVGVybXMuQ2hhcnQpIHtcblx0XHRcdFx0XHRiSGFzQ2hhcnQgPSB0cnVlO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHR9XG5cdFx0cmV0dXJuIGJIYXNDaGFydCAmJiBiSGFzVGFibGU7XG5cdH0gZWxzZSB7XG5cdFx0cmV0dXJuIChcblx0XHRcdHByZXNlbnRhdGlvblZhcmlhbnQ/LlZpc3VhbGl6YXRpb25zICYmXG5cdFx0XHQhIXByZXNlbnRhdGlvblZhcmlhbnQuVmlzdWFsaXphdGlvbnMuZmluZCgodmlzdWFsaXphdGlvbikgPT4ge1xuXHRcdFx0XHRyZXR1cm4gdmlzdWFsaXphdGlvbi4kdGFyZ2V0LnRlcm0gPT09IFVJQW5ub3RhdGlvblRlcm1zLkxpbmVJdGVtIHx8IHZpc3VhbGl6YXRpb24uJHRhcmdldC50ZXJtID09PSBVSUFubm90YXRpb25UZXJtcy5DaGFydDtcblx0XHRcdH0pXG5cdFx0KTtcblx0fVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0RGVmYXVsdExpbmVJdGVtKGVudGl0eVR5cGU6IEVudGl0eVR5cGUpOiBMaW5lSXRlbSB8IHVuZGVmaW5lZCB7XG5cdHJldHVybiBlbnRpdHlUeXBlLmFubm90YXRpb25zLlVJPy5MaW5lSXRlbTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBnZXREZWZhdWx0Q2hhcnQoZW50aXR5VHlwZTogRW50aXR5VHlwZSk6IENoYXJ0IHwgdW5kZWZpbmVkIHtcblx0cmV0dXJuIGVudGl0eVR5cGUuYW5ub3RhdGlvbnMuVUk/LkNoYXJ0O1xufVxuZXhwb3J0IGZ1bmN0aW9uIGdldERlZmF1bHRQcmVzZW50YXRpb25WYXJpYW50KGVudGl0eVR5cGU6IEVudGl0eVR5cGUpOiBQcmVzZW50YXRpb25WYXJpYW50IHwgdW5kZWZpbmVkIHtcblx0cmV0dXJuIGVudGl0eVR5cGUuYW5ub3RhdGlvbnM/LlVJPy5QcmVzZW50YXRpb25WYXJpYW50O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0RGVmYXVsdFNlbGVjdGlvblZhcmlhbnQoZW50aXR5VHlwZTogRW50aXR5VHlwZSk6IFNlbGVjdGlvblZhcmlhbnQgfCB1bmRlZmluZWQge1xuXHRyZXR1cm4gZW50aXR5VHlwZS5hbm5vdGF0aW9ucz8uVUk/LlNlbGVjdGlvblZhcmlhbnQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRTZWxlY3Rpb25WYXJpYW50KGVudGl0eVR5cGU6IEVudGl0eVR5cGUsIGNvbnZlcnRlckNvbnRleHQ6IENvbnZlcnRlckNvbnRleHQpOiBTZWxlY3Rpb25WYXJpYW50IHwgdW5kZWZpbmVkIHtcblx0Y29uc3QgYW5ub3RhdGlvblBhdGggPSBjb252ZXJ0ZXJDb250ZXh0LmdldE1hbmlmZXN0V3JhcHBlcigpLmdldERlZmF1bHRUZW1wbGF0ZUFubm90YXRpb25QYXRoKCk7XG5cdGNvbnN0IHNlbGVjdGlvblByZXNlbnRhdGlvblZhcmlhbnQgPSBnZXRTZWxlY3Rpb25QcmVzZW50YXRpb25WYXJpYW50KGVudGl0eVR5cGUsIGFubm90YXRpb25QYXRoLCBjb252ZXJ0ZXJDb250ZXh0KTtcblx0bGV0IHNlbGVjdGlvblZhcmlhbnQ7XG5cdGlmIChzZWxlY3Rpb25QcmVzZW50YXRpb25WYXJpYW50KSB7XG5cdFx0c2VsZWN0aW9uVmFyaWFudCA9IHNlbGVjdGlvblByZXNlbnRhdGlvblZhcmlhbnQuU2VsZWN0aW9uVmFyaWFudDtcblx0XHRpZiAoc2VsZWN0aW9uVmFyaWFudCkge1xuXHRcdFx0cmV0dXJuIHNlbGVjdGlvblZhcmlhbnQ7XG5cdFx0fVxuXHR9IGVsc2Uge1xuXHRcdHNlbGVjdGlvblZhcmlhbnQgPSBnZXREZWZhdWx0U2VsZWN0aW9uVmFyaWFudChlbnRpdHlUeXBlKTtcblx0XHRyZXR1cm4gc2VsZWN0aW9uVmFyaWFudDtcblx0fVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0RGF0YVZpc3VhbGl6YXRpb25Db25maWd1cmF0aW9uKFxuXHR2aXN1YWxpemF0aW9uUGF0aDogc3RyaW5nLFxuXHRpc0NvbmRlbnNlZFRhYmxlTGF5b3V0Q29tcGxpYW50OiBib29sZWFuLFxuXHRpbkNvbnZlcnRlckNvbnRleHQ6IENvbnZlcnRlckNvbnRleHQsXG5cdHZpZXdDb25maWd1cmF0aW9uPzogVmlld1BhdGhDb25maWd1cmF0aW9uLFxuXHRkb05vdENoZWNrQXBwbHlTdXBwb3J0ZWQ/OiBib29sZWFuLFxuXHRhc3NvY2lhdGVkUHJlc2VudGF0aW9uVmFyaWFudFBhdGg/OiBzdHJpbmdcbik6IERhdGFWaXN1YWxpemF0aW9uRGVmaW5pdGlvbiB7XG5cdGNvbnN0IHJlc29sdmVkVGFyZ2V0ID1cblx0XHR2aXN1YWxpemF0aW9uUGF0aCAhPT0gXCJcIlxuXHRcdFx0PyBpbkNvbnZlcnRlckNvbnRleHQuZ2V0RW50aXR5VHlwZUFubm90YXRpb24odmlzdWFsaXphdGlvblBhdGgpXG5cdFx0XHQ6IHsgYW5ub3RhdGlvbjogdW5kZWZpbmVkLCBjb252ZXJ0ZXJDb250ZXh0OiBpbkNvbnZlcnRlckNvbnRleHQgfTtcblx0Y29uc3QgcmVzb2x2ZWRBc3NvY2lhdGVkUHJlc2VudGF0aW9uVmFyaWFudCA9IGFzc29jaWF0ZWRQcmVzZW50YXRpb25WYXJpYW50UGF0aFxuXHRcdD8gaW5Db252ZXJ0ZXJDb250ZXh0LmdldEVudGl0eVR5cGVBbm5vdGF0aW9uKGFzc29jaWF0ZWRQcmVzZW50YXRpb25WYXJpYW50UGF0aClcblx0XHQ6IG51bGw7XG5cdGNvbnN0IHJlc29sdmVkVmlzdWFsaXphdGlvbiA9IHJlc29sdmVkVGFyZ2V0LmFubm90YXRpb24gYXMgRGF0YVZpc3VhbGl6YXRpb25Bbm5vdGF0aW9ucztcblx0aW5Db252ZXJ0ZXJDb250ZXh0ID0gcmVzb2x2ZWRUYXJnZXQuY29udmVydGVyQ29udGV4dDtcblx0bGV0IHZpc3VhbGl6YXRpb25Bbm5vdGF0aW9uczogVmlzdWFsaXphdGlvbkFuZFBhdGhbXSA9IFtdO1xuXHRsZXQgcHJlc2VudGF0aW9uVmFyaWFudEFubm90YXRpb246IFByZXNlbnRhdGlvblZhcmlhbnRUeXBlO1xuXHRsZXQgcHJlc2VudGF0aW9uUGF0aDogc3RyaW5nID0gXCJcIjtcblx0bGV0IGNoYXJ0VmlzdWFsaXphdGlvbiwgdGFibGVWaXN1YWxpemF0aW9uO1xuXHRjb25zdCBzVGVybSA9IHJlc29sdmVkVmlzdWFsaXphdGlvbj8udGVybTtcblx0aWYgKHNUZXJtKSB7XG5cdFx0c3dpdGNoIChzVGVybSkge1xuXHRcdFx0Y2FzZSBVSUFubm90YXRpb25UZXJtcy5MaW5lSXRlbTpcblx0XHRcdGNhc2UgVUlBbm5vdGF0aW9uVGVybXMuQ2hhcnQ6XG5cdFx0XHRcdHByZXNlbnRhdGlvblZhcmlhbnRBbm5vdGF0aW9uID0gcmVzb2x2ZWRBc3NvY2lhdGVkUHJlc2VudGF0aW9uVmFyaWFudD8uYW5ub3RhdGlvbjtcblx0XHRcdFx0dmlzdWFsaXphdGlvbkFubm90YXRpb25zLnB1c2goe1xuXHRcdFx0XHRcdHZpc3VhbGl6YXRpb246IHJlc29sdmVkVmlzdWFsaXphdGlvbiBhcyBBY3R1YWxWaXN1YWxpemF0aW9uQW5ub3RhdGlvbnMsXG5cdFx0XHRcdFx0YW5ub3RhdGlvblBhdGg6IHZpc3VhbGl6YXRpb25QYXRoLFxuXHRcdFx0XHRcdGNvbnZlcnRlckNvbnRleHQ6IGluQ29udmVydGVyQ29udGV4dFxuXHRcdFx0XHR9KTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRjYXNlIFVJQW5ub3RhdGlvblRlcm1zLlByZXNlbnRhdGlvblZhcmlhbnQ6XG5cdFx0XHRcdHByZXNlbnRhdGlvblZhcmlhbnRBbm5vdGF0aW9uID0gcmVzb2x2ZWRWaXN1YWxpemF0aW9uO1xuXHRcdFx0XHR2aXN1YWxpemF0aW9uQW5ub3RhdGlvbnMgPSB2aXN1YWxpemF0aW9uQW5ub3RhdGlvbnMuY29uY2F0KFxuXHRcdFx0XHRcdGdldFZpc3VhbGl6YXRpb25zRnJvbVByZXNlbnRhdGlvblZhcmlhbnQocmVzb2x2ZWRWaXN1YWxpemF0aW9uLCB2aXN1YWxpemF0aW9uUGF0aCwgaW5Db252ZXJ0ZXJDb250ZXh0KVxuXHRcdFx0XHQpO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdGNhc2UgVUlBbm5vdGF0aW9uVGVybXMuU2VsZWN0aW9uUHJlc2VudGF0aW9uVmFyaWFudDpcblx0XHRcdFx0cHJlc2VudGF0aW9uVmFyaWFudEFubm90YXRpb24gPSByZXNvbHZlZFZpc3VhbGl6YXRpb24uUHJlc2VudGF0aW9uVmFyaWFudDtcblx0XHRcdFx0Ly8gUHJlc2VudGF0aW9uIGNhbiBiZSBpbmxpbmUgb3Igb3V0c2lkZSB0aGUgU2VsZWN0aW9uUHJlc2VudGF0aW9uVmFyaWFudFxuXHRcdFx0XHRwcmVzZW50YXRpb25QYXRoID0gcHJlc2VudGF0aW9uVmFyaWFudEFubm90YXRpb24uZnVsbHlRdWFsaWZpZWROYW1lO1xuXHRcdFx0XHR2aXN1YWxpemF0aW9uQW5ub3RhdGlvbnMgPSB2aXN1YWxpemF0aW9uQW5ub3RhdGlvbnMuY29uY2F0KFxuXHRcdFx0XHRcdGdldFZpc3VhbGl6YXRpb25zRnJvbVByZXNlbnRhdGlvblZhcmlhbnQocHJlc2VudGF0aW9uVmFyaWFudEFubm90YXRpb24sIHZpc3VhbGl6YXRpb25QYXRoLCBpbkNvbnZlcnRlckNvbnRleHQpXG5cdFx0XHRcdCk7XG5cblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRkZWZhdWx0OlxuXHRcdFx0XHRicmVhaztcblx0XHR9XG5cdFx0dmlzdWFsaXphdGlvbkFubm90YXRpb25zLmZvckVhY2goKHZpc3VhbGl6YXRpb25Bbm5vdGF0aW9uKSA9PiB7XG5cdFx0XHRjb25zdCB7IHZpc3VhbGl6YXRpb24sIGFubm90YXRpb25QYXRoLCBjb252ZXJ0ZXJDb250ZXh0IH0gPSB2aXN1YWxpemF0aW9uQW5ub3RhdGlvbjtcblx0XHRcdHN3aXRjaCAodmlzdWFsaXphdGlvbi50ZXJtKSB7XG5cdFx0XHRcdGNhc2UgVUlBbm5vdGF0aW9uVGVybXMuQ2hhcnQ6XG5cdFx0XHRcdFx0Y2hhcnRWaXN1YWxpemF0aW9uID0gY3JlYXRlQ2hhcnRWaXN1YWxpemF0aW9uKFxuXHRcdFx0XHRcdFx0dmlzdWFsaXphdGlvbixcblx0XHRcdFx0XHRcdGFubm90YXRpb25QYXRoLFxuXHRcdFx0XHRcdFx0Y29udmVydGVyQ29udGV4dCxcblx0XHRcdFx0XHRcdGRvTm90Q2hlY2tBcHBseVN1cHBvcnRlZFxuXHRcdFx0XHRcdCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgVUlBbm5vdGF0aW9uVGVybXMuTGluZUl0ZW06XG5cdFx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdFx0dGFibGVWaXN1YWxpemF0aW9uID0gVGFibGUuY3JlYXRlVGFibGVWaXN1YWxpemF0aW9uKFxuXHRcdFx0XHRcdFx0dmlzdWFsaXphdGlvbixcblx0XHRcdFx0XHRcdGFubm90YXRpb25QYXRoLFxuXHRcdFx0XHRcdFx0Y29udmVydGVyQ29udGV4dCxcblx0XHRcdFx0XHRcdHByZXNlbnRhdGlvblZhcmlhbnRBbm5vdGF0aW9uLFxuXHRcdFx0XHRcdFx0aXNDb25kZW5zZWRUYWJsZUxheW91dENvbXBsaWFudCxcblx0XHRcdFx0XHRcdHZpZXdDb25maWd1cmF0aW9uXG5cdFx0XHRcdFx0KTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdH1cblx0XHR9KTtcblx0fSBlbHNlIHtcblx0XHR0YWJsZVZpc3VhbGl6YXRpb24gPSBUYWJsZS5jcmVhdGVEZWZhdWx0VGFibGVWaXN1YWxpemF0aW9uKGluQ29udmVydGVyQ29udGV4dCk7XG5cdFx0aW5Db252ZXJ0ZXJDb250ZXh0LmdldERpYWdub3N0aWNzKCkuYWRkSXNzdWUoSXNzdWVDYXRlZ29yeS5Bbm5vdGF0aW9uLCBJc3N1ZVNldmVyaXR5Lk1lZGl1bSwgSXNzdWVUeXBlLk1JU1NJTkdfTElORUlURU0pO1xuXHR9XG5cdGNvbnN0IGFWaXN1YWxpemF0aW9uczogYW55ID0gW107XG5cdGxldCBzUGF0aCA9XG5cdFx0c1Rlcm0gPT09IFVJQW5ub3RhdGlvblRlcm1zLlNlbGVjdGlvblByZXNlbnRhdGlvblZhcmlhbnRcblx0XHRcdD8gcHJlc2VudGF0aW9uUGF0aFxuXHRcdFx0OiByZXNvbHZlZFZpc3VhbGl6YXRpb24gJiYgcmVzb2x2ZWRWaXN1YWxpemF0aW9uLmZ1bGx5UXVhbGlmaWVkTmFtZTtcblx0aWYgKHNQYXRoID09PSB1bmRlZmluZWQpIHtcblx0XHRzUGF0aCA9IFwiL1wiO1xuXHR9XG5cdGlmIChjaGFydFZpc3VhbGl6YXRpb24pIHtcblx0XHRhVmlzdWFsaXphdGlvbnMucHVzaChjaGFydFZpc3VhbGl6YXRpb24pO1xuXHR9XG5cdGlmICh0YWJsZVZpc3VhbGl6YXRpb24pIHtcblx0XHRhVmlzdWFsaXphdGlvbnMucHVzaCh0YWJsZVZpc3VhbGl6YXRpb24pO1xuXHR9XG5cdHJldHVybiB7XG5cdFx0dmlzdWFsaXphdGlvbnM6IGFWaXN1YWxpemF0aW9ucyxcblx0XHRhbm5vdGF0aW9uUGF0aDogaW5Db252ZXJ0ZXJDb250ZXh0LmdldEVudGl0eVNldEJhc2VkQW5ub3RhdGlvblBhdGgoc1BhdGgpXG5cdH07XG59XG5cbi8qKlxuICogUmV0dXJuIFVJIENvbnRyb2wgKExpbmVJdGVtL0NoYXJ0KSBDb250ZXh0LlxuICpcbiAqIEBmdW5jdGlvblxuICogQG5hbWUgZ2V0VWlDb250cm9sXG4gKiBAcGFyYW0gb1ByZXNlbnRhdGlvbkNvbnRleHQgUHJlc2VudGF0aW9uIGNvbnRleHQgb2JqZWN0IChQcmVzZW50YXRpb24gdmFyaWFudCBvciBVSS5MaW5lSXRlbS9DaGFydClcbiAqIEBwYXJhbSBzQ29udHJvbFBhdGggQ29udHJvbCBwYXRoXG4gKiBAcmV0dXJucyBUaGUgQ29udHJvbCAoTGluZUl0ZW0vQ2hhcnQpIGNvbnRleHRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFVpQ29udHJvbChvUHJlc2VudGF0aW9uQ29udGV4dDogQ29udGV4dCwgc0NvbnRyb2xQYXRoOiBTdHJpbmcpIHtcblx0Y29uc3Qgb1ByZXNlbnRhdGlvbiA9IG9QcmVzZW50YXRpb25Db250ZXh0LmdldE9iamVjdChvUHJlc2VudGF0aW9uQ29udGV4dC5nZXRQYXRoKCkpIGFzIGFueSxcblx0XHRvUHJlc2VudGF0aW9uVmFyaWFudFBhdGggPSBDb21tb25IZWxwZXIuY3JlYXRlUHJlc2VudGF0aW9uUGF0aENvbnRleHQob1ByZXNlbnRhdGlvbkNvbnRleHQpLFxuXHRcdG9Nb2RlbCA9IG9QcmVzZW50YXRpb25Db250ZXh0LmdldE1vZGVsKCkgYXMgT0RhdGFNb2RlbDtcblx0aWYgKENvbW1vbkhlbHBlci5faXNQcmVzZW50YXRpb25WYXJpYW50QW5ub3RhdGlvbihvUHJlc2VudGF0aW9uVmFyaWFudFBhdGguZ2V0UGF0aCgpKSkge1xuXHRcdC8vIFVuY29tcGxldGUgUHJlc2VudGF0aW9uVmFyaWFudCBjYW4gYmUgcGFzc2VkIHRvIG1hY3JvIHZpYSBTZWxlY3Rpb25QcmVzZW50YXRpb25WYXJpYW50XG5cdFx0Y29uc3QgYVZpc3VhbGl6YXRpb25zID0gb1ByZXNlbnRhdGlvbi5WaXN1YWxpemF0aW9ucztcblx0XHRpZiAoQXJyYXkuaXNBcnJheShhVmlzdWFsaXphdGlvbnMpKSB7XG5cdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IGFWaXN1YWxpemF0aW9ucy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRpZiAoYVZpc3VhbGl6YXRpb25zW2ldLiRBbm5vdGF0aW9uUGF0aC5pbmRleE9mKHNDb250cm9sUGF0aCkgIT09IC0xKSB7XG5cdFx0XHRcdFx0c0NvbnRyb2xQYXRoID0gYVZpc3VhbGl6YXRpb25zW2ldLiRBbm5vdGF0aW9uUGF0aDtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gKG9Nb2RlbCBhcyBhbnkpLmdldE1ldGFDb250ZXh0KG9QcmVzZW50YXRpb25Db250ZXh0LmdldFBhdGgoKS5zcGxpdChcIkBcIilbMF0gKyBzQ29udHJvbFBhdGgpO1xuXHR9XG5cdHJldHVybiBvUHJlc2VudGF0aW9uQ29udGV4dDtcbn1cbiJdLCJtYXBwaW5ncyI6IjtBQUFBO0FBQUE7QUFBQTs7Ozs7Ozs7Ozs7RUFzQ08sSUFBTUEsd0NBQXdDLEdBQUcsVUFDdkRDLDZCQUR1RCxFQUV2REMsaUJBRnVELEVBR3ZEQyxnQkFIdUQsRUFJOUI7SUFDekIsSUFBTUMsd0JBQWdELEdBQUcsRUFBekQ7SUFFQSxJQUFNQyxNQUFNLEdBQ1hGLGdCQUFnQixDQUFDRyxrQkFBakIsR0FBc0NDLHlCQUF0QyxNQUNBSixnQkFBZ0IsQ0FBQ0ssZUFBakIsT0FBdUNDLFlBQVksQ0FBQ0Msa0JBRnJEOztJQUlBLElBQUksQ0FBQ0MsdUJBQXVCLENBQUNWLDZCQUFELEVBQWdDSSxNQUFoQyxDQUE1QixFQUFxRTtNQUNwRSxJQUFNTyxVQUFVLEdBQUdULGdCQUFnQixDQUFDVSxhQUFqQixFQUFuQjtNQUNBLElBQU1DLHlCQUF5QixHQUFHQyxrQkFBa0IsQ0FBQ0gsVUFBRCxDQUFwRDs7TUFDQSxJQUFJRSx5QkFBSixFQUErQjtRQUM5QlYsd0JBQXdCLENBQUNZLElBQXpCLENBQThCO1VBQzdCQyxhQUFhLEVBQUVILHlCQURjO1VBRTdCSSxjQUFjLEVBQUVmLGdCQUFnQixDQUFDZ0IseUJBQWpCLENBQTJDTCx5QkFBeUIsQ0FBQ00sa0JBQXJFLEVBQXlGUixVQUF6RixDQUZhO1VBRzdCVCxnQkFBZ0IsRUFBRUE7UUFIVyxDQUE5QjtNQUtBO0lBQ0QsQ0FWRCxNQVVPO01BQ04sSUFBTWtCLHFCQUFxQixHQUFHbkIsaUJBQWlCLENBQUNvQixLQUFsQixDQUF3QixHQUF4QixFQUE2QixDQUE3QixDQUE5QjtNQUNBLElBQU1DLGNBQWMsR0FBR3RCLDZCQUE2QixDQUFDdUIsY0FBckQ7O01BRUEsSUFBTUMsa0JBQWtCLEdBQUcsVUFBVUMsWUFBVixFQUFrQztRQUM1RCxJQUFNQyxRQUFRLEdBQUdKLGNBQWMsQ0FBQ0ssSUFBZixDQUFvQixVQUFDQyxHQUFELEVBQVM7VUFDN0MsT0FBT0gsWUFBWSxDQUFDSSxPQUFiLENBQXFCRCxHQUFHLENBQUNFLE9BQUosQ0FBWUMsSUFBakMsS0FBMEMsQ0FBakQ7UUFDQSxDQUZnQixDQUFqQjs7UUFJQSxJQUFJTCxRQUFKLEVBQWM7VUFDYnZCLHdCQUF3QixDQUFDWSxJQUF6QixDQUE4QjtZQUM3QkMsYUFBYSxFQUFFVSxRQUFRLENBQUNJLE9BREs7WUFFN0JiLGNBQWMsWUFBS0cscUJBQUwsU0FBNkJNLFFBQVEsQ0FBQ00sS0FBdEMsQ0FGZTtZQUc3QjlCLGdCQUFnQixFQUFFQTtVQUhXLENBQTlCO1FBS0E7TUFDRCxDQVpEOztNQWNBLElBQUlFLE1BQUosRUFBWTtRQUNYO1FBQ0FvQixrQkFBa0IsQ0FBQyx1Q0FBRCxDQUFsQjtRQUNBQSxrQkFBa0IsQ0FBQyxvQ0FBRCxDQUFsQjtNQUNBLENBSkQsTUFJTztRQUNOO1FBQ0FBLGtCQUFrQixDQUFDLDJFQUFELENBQWxCO01BQ0E7SUFDRDs7SUFDRCxPQUFPckIsd0JBQVA7RUFDQSxDQWpETTs7OztFQW1EQSxTQUFTOEIsK0JBQVQsQ0FDTnRCLFVBRE0sRUFFTk0sY0FGTSxFQUdOZixnQkFITSxFQUlBO0lBQ04sSUFBSWUsY0FBSixFQUFvQjtNQUNuQixJQUFNaUIsY0FBYyxHQUFHaEMsZ0JBQWdCLENBQUNpQyx1QkFBakIsQ0FBeUNsQixjQUF6QyxDQUF2QjtNQUNBLElBQU1tQiw0QkFBNEIsR0FBR0YsY0FBYyxDQUFDRyxVQUFwRDs7TUFDQSxJQUFJRCw0QkFBSixFQUFrQztRQUNqQyxJQUFJQSw0QkFBNEIsQ0FBQ0wsSUFBN0IsOERBQUosRUFBMEY7VUFDekYsT0FBT0ssNEJBQVA7UUFDQTtNQUNELENBSkQsTUFJTztRQUNOLE1BQU0sSUFBSUUsS0FBSixDQUFVLDBHQUFWLENBQU47TUFDQTtJQUNELENBVkQsTUFVTztNQUFBOztNQUNOLGdDQUFPM0IsVUFBVSxDQUFDNEIsV0FBbEIsb0ZBQU8sc0JBQXdCQyxFQUEvQiwyREFBTyx1QkFBNEJDLDRCQUFuQztJQUNBO0VBQ0Q7Ozs7RUFFTSxTQUFTQyxnQ0FBVCxDQUNORCw0QkFETSxFQUVOckMsTUFGTSxFQUdnQjtJQUN0QixJQUFNdUMsbUJBQW1CLEdBQUdGLDRCQUE0QixJQUFJQSw0QkFBNEIsQ0FBQ0csbUJBQXpGOztJQUNBLElBQUlELG1CQUFKLEVBQXlCO01BQ3hCLE9BQU9qQyx1QkFBdUIsQ0FBQ2lDLG1CQUFELEVBQXNCdkMsTUFBdEIsQ0FBOUI7SUFDQSxDQUZELE1BRU87TUFDTixNQUFNLElBQUlrQyxLQUFKLENBQVUsMkRBQVYsQ0FBTjtJQUNBO0VBQ0Q7Ozs7RUFFTSxTQUFTNUIsdUJBQVQsQ0FBaUNpQyxtQkFBakMsRUFBd0c7SUFBQSxJQUF6QnZDLE1BQXlCLHVFQUFoQixLQUFnQjtJQUM5RyxJQUFJeUMsU0FBUyxHQUFHLEtBQWhCO0lBQUEsSUFDQ0MsU0FBUyxHQUFHLEtBRGI7O0lBRUEsSUFBSTFDLE1BQUosRUFBWTtNQUNYLElBQUl1QyxtQkFBSixhQUFJQSxtQkFBSixlQUFJQSxtQkFBbUIsQ0FBRXBCLGNBQXpCLEVBQXlDO1FBQ3hDLElBQU13QixlQUFlLEdBQUdKLG1CQUFtQixDQUFDcEIsY0FBNUM7UUFDQXdCLGVBQWUsQ0FBQ0MsT0FBaEIsQ0FBd0IsVUFBQ0MsY0FBRCxFQUFvQjtVQUMzQyxJQUFJQSxjQUFjLENBQUNuQixPQUFmLENBQXVCQyxJQUF2QiwwQ0FBSixFQUFnRTtZQUMvRGMsU0FBUyxHQUFHLElBQVo7VUFDQTs7VUFDRCxJQUFJSSxjQUFjLENBQUNuQixPQUFmLENBQXVCQyxJQUF2Qix1Q0FBSixFQUE2RDtZQUM1RGUsU0FBUyxHQUFHLElBQVo7VUFDQTtRQUNELENBUEQ7TUFRQTs7TUFDRCxPQUFPQSxTQUFTLElBQUlELFNBQXBCO0lBQ0EsQ0FiRCxNQWFPO01BQ04sT0FDQyxDQUFBRixtQkFBbUIsU0FBbkIsSUFBQUEsbUJBQW1CLFdBQW5CLFlBQUFBLG1CQUFtQixDQUFFcEIsY0FBckIsS0FDQSxDQUFDLENBQUNvQixtQkFBbUIsQ0FBQ3BCLGNBQXBCLENBQW1DSSxJQUFuQyxDQUF3QyxVQUFDWCxhQUFELEVBQW1CO1FBQzVELE9BQU9BLGFBQWEsQ0FBQ2MsT0FBZCxDQUFzQkMsSUFBdEIsOENBQTZEZixhQUFhLENBQUNjLE9BQWQsQ0FBc0JDLElBQXRCLHVDQUFwRTtNQUNBLENBRkMsQ0FGSDtJQU1BO0VBQ0Q7Ozs7RUFFTSxTQUFTakIsa0JBQVQsQ0FBNEJILFVBQTVCLEVBQTBFO0lBQUE7O0lBQ2hGLGlDQUFPQSxVQUFVLENBQUM0QixXQUFYLENBQXVCQyxFQUE5QiwyREFBTyx1QkFBMkJVLFFBQWxDO0VBQ0E7Ozs7RUFDTSxTQUFTQyxlQUFULENBQXlCeEMsVUFBekIsRUFBb0U7SUFBQTs7SUFDMUUsaUNBQU9BLFVBQVUsQ0FBQzRCLFdBQVgsQ0FBdUJDLEVBQTlCLDJEQUFPLHVCQUEyQlksS0FBbEM7RUFDQTs7OztFQUNNLFNBQVNDLDZCQUFULENBQXVDMUMsVUFBdkMsRUFBZ0c7SUFBQTs7SUFDdEcsaUNBQU9BLFVBQVUsQ0FBQzRCLFdBQWxCLHFGQUFPLHVCQUF3QkMsRUFBL0IsMkRBQU8sdUJBQTRCSSxtQkFBbkM7RUFDQTs7OztFQUVNLFNBQVNVLDBCQUFULENBQW9DM0MsVUFBcEMsRUFBMEY7SUFBQTs7SUFDaEcsaUNBQU9BLFVBQVUsQ0FBQzRCLFdBQWxCLHFGQUFPLHVCQUF3QkMsRUFBL0IsMkRBQU8sdUJBQTRCZSxnQkFBbkM7RUFDQTs7OztFQUVNLFNBQVNDLG1CQUFULENBQTZCN0MsVUFBN0IsRUFBcURULGdCQUFyRCxFQUF1SDtJQUM3SCxJQUFNZSxjQUFjLEdBQUdmLGdCQUFnQixDQUFDRyxrQkFBakIsR0FBc0NvRCxnQ0FBdEMsRUFBdkI7SUFDQSxJQUFNckIsNEJBQTRCLEdBQUdILCtCQUErQixDQUFDdEIsVUFBRCxFQUFhTSxjQUFiLEVBQTZCZixnQkFBN0IsQ0FBcEU7SUFDQSxJQUFJd0QsZ0JBQUo7O0lBQ0EsSUFBSXRCLDRCQUFKLEVBQWtDO01BQ2pDc0IsZ0JBQWdCLEdBQUd0Qiw0QkFBNEIsQ0FBQ21CLGdCQUFoRDs7TUFDQSxJQUFJRyxnQkFBSixFQUFzQjtRQUNyQixPQUFPQSxnQkFBUDtNQUNBO0lBQ0QsQ0FMRCxNQUtPO01BQ05BLGdCQUFnQixHQUFHSiwwQkFBMEIsQ0FBQzNDLFVBQUQsQ0FBN0M7TUFDQSxPQUFPK0MsZ0JBQVA7SUFDQTtFQUNEOzs7O0VBRU0sU0FBU0MsaUNBQVQsQ0FDTjFELGlCQURNLEVBRU4yRCwrQkFGTSxFQUdOQyxrQkFITSxFQUlOQyxpQkFKTSxFQUtOQyx3QkFMTSxFQU1OQyxpQ0FOTSxFQU93QjtJQUM5QixJQUFNOUIsY0FBYyxHQUNuQmpDLGlCQUFpQixLQUFLLEVBQXRCLEdBQ0c0RCxrQkFBa0IsQ0FBQzFCLHVCQUFuQixDQUEyQ2xDLGlCQUEzQyxDQURILEdBRUc7TUFBRW9DLFVBQVUsRUFBRTRCLFNBQWQ7TUFBeUIvRCxnQkFBZ0IsRUFBRTJEO0lBQTNDLENBSEo7SUFJQSxJQUFNSyxxQ0FBcUMsR0FBR0YsaUNBQWlDLEdBQzVFSCxrQkFBa0IsQ0FBQzFCLHVCQUFuQixDQUEyQzZCLGlDQUEzQyxDQUQ0RSxHQUU1RSxJQUZIO0lBR0EsSUFBTUcscUJBQXFCLEdBQUdqQyxjQUFjLENBQUNHLFVBQTdDO0lBQ0F3QixrQkFBa0IsR0FBRzNCLGNBQWMsQ0FBQ2hDLGdCQUFwQztJQUNBLElBQUlDLHdCQUFnRCxHQUFHLEVBQXZEO0lBQ0EsSUFBSUgsNkJBQUo7SUFDQSxJQUFJb0UsZ0JBQXdCLEdBQUcsRUFBL0I7SUFDQSxJQUFJQyxrQkFBSixFQUF3QkMsa0JBQXhCO0lBQ0EsSUFBTUMsS0FBSyxHQUFHSixxQkFBSCxhQUFHQSxxQkFBSCx1QkFBR0EscUJBQXFCLENBQUVwQyxJQUFyQzs7SUFDQSxJQUFJd0MsS0FBSixFQUFXO01BQ1YsUUFBUUEsS0FBUjtRQUNDO1FBQ0E7VUFDQ3ZFLDZCQUE2QixHQUFHa0UscUNBQUgsYUFBR0EscUNBQUgsdUJBQUdBLHFDQUFxQyxDQUFFN0IsVUFBdkU7VUFDQWxDLHdCQUF3QixDQUFDWSxJQUF6QixDQUE4QjtZQUM3QkMsYUFBYSxFQUFFbUQscUJBRGM7WUFFN0JsRCxjQUFjLEVBQUVoQixpQkFGYTtZQUc3QkMsZ0JBQWdCLEVBQUUyRDtVQUhXLENBQTlCO1VBS0E7O1FBQ0Q7VUFDQzdELDZCQUE2QixHQUFHbUUscUJBQWhDO1VBQ0FoRSx3QkFBd0IsR0FBR0Esd0JBQXdCLENBQUNxRSxNQUF6QixDQUMxQnpFLHdDQUF3QyxDQUFDb0UscUJBQUQsRUFBd0JsRSxpQkFBeEIsRUFBMkM0RCxrQkFBM0MsQ0FEZCxDQUEzQjtVQUdBOztRQUNEO1VBQ0M3RCw2QkFBNkIsR0FBR21FLHFCQUFxQixDQUFDdkIsbUJBQXRELENBREQsQ0FFQzs7VUFDQXdCLGdCQUFnQixHQUFHcEUsNkJBQTZCLENBQUNtQixrQkFBakQ7VUFDQWhCLHdCQUF3QixHQUFHQSx3QkFBd0IsQ0FBQ3FFLE1BQXpCLENBQzFCekUsd0NBQXdDLENBQUNDLDZCQUFELEVBQWdDQyxpQkFBaEMsRUFBbUQ0RCxrQkFBbkQsQ0FEZCxDQUEzQjtVQUlBOztRQUNEO1VBQ0M7TUExQkY7O01BNEJBMUQsd0JBQXdCLENBQUM2QyxPQUF6QixDQUFpQyxVQUFDeUIsdUJBQUQsRUFBNkI7UUFDN0QsSUFBUXpELGFBQVIsR0FBNER5RCx1QkFBNUQsQ0FBUXpELGFBQVI7UUFBQSxJQUF1QkMsY0FBdkIsR0FBNER3RCx1QkFBNUQsQ0FBdUJ4RCxjQUF2QjtRQUFBLElBQXVDZixnQkFBdkMsR0FBNER1RSx1QkFBNUQsQ0FBdUN2RSxnQkFBdkM7O1FBQ0EsUUFBUWMsYUFBYSxDQUFDZSxJQUF0QjtVQUNDO1lBQ0NzQyxrQkFBa0IsR0FBR0ssd0JBQXdCLENBQzVDMUQsYUFENEMsRUFFNUNDLGNBRjRDLEVBRzVDZixnQkFINEMsRUFJNUM2RCx3QkFKNEMsQ0FBN0M7WUFNQTs7VUFDRDtVQUNBO1lBQ0NPLGtCQUFrQixHQUFHSyxLQUFLLENBQUNDLHdCQUFOLENBQ3BCNUQsYUFEb0IsRUFFcEJDLGNBRm9CLEVBR3BCZixnQkFIb0IsRUFJcEJGLDZCQUpvQixFQUtwQjRELCtCQUxvQixFQU1wQkUsaUJBTm9CLENBQXJCO1lBUUE7UUFuQkY7TUFxQkEsQ0F2QkQ7SUF3QkEsQ0FyREQsTUFxRE87TUFDTlEsa0JBQWtCLEdBQUdLLEtBQUssQ0FBQ0UsK0JBQU4sQ0FBc0NoQixrQkFBdEMsQ0FBckI7TUFDQUEsa0JBQWtCLENBQUNpQixjQUFuQixHQUFvQ0MsUUFBcEMsQ0FBNkNDLGFBQWEsQ0FBQ0MsVUFBM0QsRUFBdUVDLGFBQWEsQ0FBQ0MsTUFBckYsRUFBNkZDLFNBQVMsQ0FBQ0MsZ0JBQXZHO0lBQ0E7O0lBQ0QsSUFBTXRDLGVBQW9CLEdBQUcsRUFBN0I7SUFDQSxJQUFJdUMsS0FBSyxHQUNSZixLQUFLLDhEQUFMLEdBQ0dILGdCQURILEdBRUdELHFCQUFxQixJQUFJQSxxQkFBcUIsQ0FBQ2hELGtCQUhuRDs7SUFJQSxJQUFJbUUsS0FBSyxLQUFLckIsU0FBZCxFQUF5QjtNQUN4QnFCLEtBQUssR0FBRyxHQUFSO0lBQ0E7O0lBQ0QsSUFBSWpCLGtCQUFKLEVBQXdCO01BQ3ZCdEIsZUFBZSxDQUFDaEMsSUFBaEIsQ0FBcUJzRCxrQkFBckI7SUFDQTs7SUFDRCxJQUFJQyxrQkFBSixFQUF3QjtNQUN2QnZCLGVBQWUsQ0FBQ2hDLElBQWhCLENBQXFCdUQsa0JBQXJCO0lBQ0E7O0lBQ0QsT0FBTztNQUNOaEQsY0FBYyxFQUFFeUIsZUFEVjtNQUVOOUIsY0FBYyxFQUFFNEMsa0JBQWtCLENBQUMwQiwrQkFBbkIsQ0FBbURELEtBQW5EO0lBRlYsQ0FBUDtFQUlBO0VBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7OztFQUNPLFNBQVNFLFlBQVQsQ0FBc0JDLG9CQUF0QixFQUFxREMsWUFBckQsRUFBMkU7SUFDakYsSUFBTUMsYUFBYSxHQUFHRixvQkFBb0IsQ0FBQ0csU0FBckIsQ0FBK0JILG9CQUFvQixDQUFDSSxPQUFyQixFQUEvQixDQUF0QjtJQUFBLElBQ0NDLHdCQUF3QixHQUFHQyxZQUFZLENBQUNDLDZCQUFiLENBQTJDUCxvQkFBM0MsQ0FENUI7SUFBQSxJQUVDUSxNQUFNLEdBQUdSLG9CQUFvQixDQUFDUyxRQUFyQixFQUZWOztJQUdBLElBQUlILFlBQVksQ0FBQ0ksZ0NBQWIsQ0FBOENMLHdCQUF3QixDQUFDRCxPQUF6QixFQUE5QyxDQUFKLEVBQXVGO01BQ3RGO01BQ0EsSUFBTTlDLGVBQWUsR0FBRzRDLGFBQWEsQ0FBQ3BFLGNBQXRDOztNQUNBLElBQUk2RSxLQUFLLENBQUNDLE9BQU4sQ0FBY3RELGVBQWQsQ0FBSixFQUFvQztRQUNuQyxLQUFLLElBQUl1RCxDQUFDLEdBQUcsQ0FBYixFQUFnQkEsQ0FBQyxHQUFHdkQsZUFBZSxDQUFDd0QsTUFBcEMsRUFBNENELENBQUMsRUFBN0MsRUFBaUQ7VUFDaEQsSUFBSXZELGVBQWUsQ0FBQ3VELENBQUQsQ0FBZixDQUFtQkUsZUFBbkIsQ0FBbUMzRSxPQUFuQyxDQUEyQzZELFlBQTNDLE1BQTZELENBQUMsQ0FBbEUsRUFBcUU7WUFDcEVBLFlBQVksR0FBRzNDLGVBQWUsQ0FBQ3VELENBQUQsQ0FBZixDQUFtQkUsZUFBbEM7WUFDQTtVQUNBO1FBQ0Q7TUFDRDs7TUFDRCxPQUFRUCxNQUFELENBQWdCUSxjQUFoQixDQUErQmhCLG9CQUFvQixDQUFDSSxPQUFyQixHQUErQnhFLEtBQS9CLENBQXFDLEdBQXJDLEVBQTBDLENBQTFDLElBQStDcUUsWUFBOUUsQ0FBUDtJQUNBOztJQUNELE9BQU9ELG9CQUFQO0VBQ0EifQ==