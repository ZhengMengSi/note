/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/core/converters/annotations/DataField","sap/fe/core/helpers/BindingToolkit","sap/fe/core/helpers/ModelHelper","sap/fe/core/templating/DataModelPathHelper","../../../helpers/StableIdHelper","../../helpers/ConfigurableObject","../../helpers/DataFieldHelper","../../helpers/ID","../../helpers/Key","../../ManifestSettings"],function(e,t,n,a,o,i,r,l,v,s){"use strict";var c={};var u=s.ActionType;var f=v.KeyHelper;var d=l.getFormStandardActionButtonID;var p=l.getFormID;var m=r.isReferencePropertyStaticallyHidden;var O=i.Placement;var y=i.insertCustomElements;var b=o.generate;var P=a.getTargetObjectPath;var g=a.getTargetEntitySetPath;var h=t.pathInModel;var F=t.not;var E=t.ifElse;var C=t.getExpressionFromAnnotation;var D=t.equal;var I=t.compileExpression;var S=e.getSemanticObjectPath;function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach(function(t){A(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function A(e,t,n){if(t in e){Object.defineProperty(e,t,{value:n,enumerable:true,configurable:true,writable:true})}else{e[t]=n}return e}var j;(function(e){e["Default"]="Default";e["Slot"]="Slot";e["Annotation"]="Annotation"})(j||(j={}));c.FormElementType=j;function U(){return{textLinesEdit:4}}function N(e,t){var n,a,o,i;return(t===null||t===void 0?void 0:t.valueOf())===false||((n=e.annotations)===null||n===void 0?void 0:(a=n.UI)===null||a===void 0?void 0:a.PartOfPreview)===undefined||((o=e.annotations)===null||o===void 0?void 0:(i=o.UI)===null||i===void 0?void 0:i.PartOfPreview.valueOf())===true}function M(e,t){var n=[];var a=t.getEntityTypeAnnotation(e.Target.value);var o=a.annotation;t=a.converterContext;function i(e,a){var o,i,r;var l=S(t,e);if(e.$Type!=="com.sap.vocabularies.UI.v1.DataFieldForAction"&&e.$Type!=="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"&&!m(e)&&((o=e.annotations)===null||o===void 0?void 0:(i=o.UI)===null||i===void 0?void 0:(r=i.Hidden)===null||r===void 0?void 0:r.valueOf())!==true){n.push({key:f.generateKeyFromDataField(e),type:j.Annotation,annotationPath:"".concat(t.getEntitySetBasedAnnotationPath(e.fullyQualifiedName),"/"),semanticObjectPath:l,formatOptions:U(),isPartOfPreview:N(e,a)})}}switch(o===null||o===void 0?void 0:o.term){case"com.sap.vocabularies.UI.v1.FieldGroup":o.Data.forEach(function(t){var n,a;return i(t,(n=e.annotations)===null||n===void 0?void 0:(a=n.UI)===null||a===void 0?void 0:a.PartOfPreview)});break;case"com.sap.vocabularies.UI.v1.Identification":o.forEach(function(t){var n,a;return i(t,(n=e.annotations)===null||n===void 0?void 0:(a=n.UI)===null||a===void 0?void 0:a.PartOfPreview)});break;case"com.sap.vocabularies.UI.v1.DataPoint":n.push({key:"DataPoint::".concat(o.qualifier?o.qualifier:""),type:j.Annotation,annotationPath:"".concat(t.getEntitySetBasedAnnotationPath(o.fullyQualifiedName),"/")});break;case"com.sap.vocabularies.Communication.v1.Contact":n.push({key:"Contact::".concat(o.qualifier?o.qualifier:""),type:j.Annotation,annotationPath:"".concat(t.getEntitySetBasedAnnotationPath(o.fullyQualifiedName),"/")});break;default:break}return n}function _(e,t){var n=t.getManifestWrapper();var a=n.getFormContainer(e.Target.value);var o={};if(a!==null&&a!==void 0&&a.fields){Object.keys(a===null||a===void 0?void 0:a.fields).forEach(function(e){o[e]={key:e,id:"CustomFormElement::".concat(e),type:a.fields[e].type||j.Default,template:a.fields[e].template,label:a.fields[e].label,position:a.fields[e].position||{placement:O.After},formatOptions:T(T({},U()),a.fields[e].formatOptions)}})}return o}c.getFormElementsFromManifest=_;function k(e,t,a){var o,i,r,l,v,s;var c=b([{Facet:e}]);var f="/".concat(e.fullyQualifiedName);var p=t.getEntityTypeAnnotation(e.Target.value);var m=I(F(D(true,C((o=e.annotations)===null||o===void 0?void 0:(i=o.UI)===null||i===void 0?void 0:i.Hidden))));var O;if(p.converterContext.getEntitySet()&&p.converterContext.getEntitySet()!==t.getEntitySet()){O=g(p.converterContext.getDataModelObjectPath())}else if(((r=p.converterContext.getDataModelObjectPath().targetObject)===null||r===void 0?void 0:r.containsTarget)===true){O=P(p.converterContext.getDataModelObjectPath(),false)}else if(p.converterContext.getEntitySet()&&!O&&n.isSingleton(p.converterContext.getEntitySet())){var S;O=(S=p.converterContext.getEntitySet())===null||S===void 0?void 0:S.fullyQualifiedName}var w=y(M(e,t),_(e,t),{formatOptions:"overwrite"});a=a!==undefined?a.filter(function(t){return t.facetName==e.fullyQualifiedName}):[];if(a.length===0){a=undefined}var T={id:d(c,"ShowHideDetails"),key:"StandardAction::ShowHideDetails",text:I(E(D(h("showDetails","internal"),true),h("T_COMMON_OBJECT_PAGE_HIDE_FORM_CONTAINER_DETAILS","sap.fe.i18n"),h("T_COMMON_OBJECT_PAGE_SHOW_FORM_CONTAINER_DETAILS","sap.fe.i18n"))),type:u.ShowFormDetails,press:"FormContainerRuntime.toggleDetails"};if(((l=e.annotations)===null||l===void 0?void 0:(v=l.UI)===null||v===void 0?void 0:(s=v.PartOfPreview)===null||s===void 0?void 0:s.valueOf())!==false&&w.some(function(e){return e.isPartOfPreview===false})){if(a!==undefined){a.push(T)}else{a=[T]}}return{id:c,formElements:w,annotationPath:f,isVisible:m,entitySet:O,actions:a}}c.getFormContainer=k;function x(e,t,n){var a;var o=[];(a=e.Facets)===null||a===void 0?void 0:a.forEach(function(e){if(e.$Type==="com.sap.vocabularies.UI.v1.CollectionFacet"){return}o.push(k(e,t,n))});return o}function H(e){return e.$Type==="com.sap.vocabularies.UI.v1.ReferenceFacet"}c.isReferenceFacet=H;function R(e,t,n,a){var o,i,r;switch(e.$Type){case"com.sap.vocabularies.UI.v1.CollectionFacet":return{id:p({Facet:e}),useFormContainerLabels:true,hasFacetsNotPartOfPreview:e.Facets.some(function(e){var t,n,a;return((t=e.annotations)===null||t===void 0?void 0:(n=t.UI)===null||n===void 0?void 0:(a=n.PartOfPreview)===null||a===void 0?void 0:a.valueOf())===false}),formContainers:x(e,n,a),isVisible:t};case"com.sap.vocabularies.UI.v1.ReferenceFacet":return{id:p({Facet:e}),useFormContainerLabels:false,hasFacetsNotPartOfPreview:((o=e.annotations)===null||o===void 0?void 0:(i=o.UI)===null||i===void 0?void 0:(r=i.PartOfPreview)===null||r===void 0?void 0:r.valueOf())===false,formContainers:[k(e,n,a)],isVisible:t};default:throw new Error("Cannot create form based on ReferenceURLFacet")}}c.createFormDefinition=R;return c},false);
//# sourceMappingURL=Form.js.map