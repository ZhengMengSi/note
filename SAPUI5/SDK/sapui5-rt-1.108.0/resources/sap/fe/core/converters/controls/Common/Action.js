/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/core/converters/helpers/BindingHelper","sap/fe/core/converters/helpers/ConfigurableObject","sap/fe/core/converters/helpers/ID","sap/fe/core/converters/ManifestSettings","sap/fe/core/formatters/FPMFormatter","sap/fe/core/helpers/BindingToolkit","sap/fe/core/helpers/StableIdHelper"],function(e,n,r,t,i,o,a){"use strict";var l={};var u=a.replaceSpecialChars;var c=o.resolveBindingString;var f=o.pathInModel;var v=o.or;var d=o.isConstant;var s=o.ifElse;var p=o.greaterOrEqual;var b=o.getExpressionFromAnnotation;var y=o.formatResult;var m=o.equal;var h=o.compileExpression;var g=o.and;var A=t.ActionType;var O=r.getCustomActionID;var S=n.Placement;var E=e.bindingContextPathVisitor;function j(e){return w(e)||k(e)||I(e)||P()}function P(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function k(e){if(typeof Symbol!=="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function w(e){if(Array.isArray(e))return B(e)}function x(e,n){var r=typeof Symbol!=="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=I(e))||n&&e&&typeof e.length==="number"){if(r)e=r;var t=0;var i=function(){};return{s:i,n:function(){if(t>=e.length)return{done:true};return{done:false,value:e[t++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o=true,a=false,l;return{s:function(){r=r.call(e)},n:function(){var e=r.next();o=e.done;return e},e:function(e){a=true;l=e},f:function(){try{if(!o&&r.return!=null)r.return()}finally{if(a)throw l}}}}function I(e,n){if(!e)return;if(typeof e==="string")return B(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor)r=e.constructor.name;if(r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return B(e,n)}function B(e,n){if(n==null||n>e.length)n=e.length;for(var r=0,t=new Array(n);r<n;r++){t[r]=e[r]}return t}function C(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}function M(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?C(Object(r),!0).forEach(function(n){D(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function D(e,n,r){if(n in e){Object.defineProperty(e,n,{value:r,enumerable:true,configurable:true,writable:true})}else{e[n]=r}return e}var F;(function(e){e["Accept"]="Accept";e["Attention"]="Attention";e["Back"]="Back";e["Critical"]="Critical";e["Default"]="Default";e["Emphasized"]="Emphasized";e["Ghost"]="Ghost";e["Negative"]="Negative";e["Neutral"]="Neutral";e["Reject"]="Reject";e["Success"]="Success";e["Transparent"]="Transparent";e["Unstyled"]="Unstyled";e["Up"]="Up"})(F||(F={}));l.ButtonType=F;function N(e,n,r,t){var i=n.find(function(e){return e.key===t});var o=e[t];var a=M({},i!==null&&i!==void 0?i:o);if(i){var l,u;a.enabled=(l=o===null||o===void 0?void 0:o.enabled)!==null&&l!==void 0?l:i.enabled;a.visible=(u=o===null||o===void 0?void 0:o.visible)!==null&&u!==void 0?u:i.visible;for(var c in o||{}){if(!i[c]&&c!=="menu"){a[c]=o[c]}}}var f=((a===null||a===void 0?void 0:a.visible)||(a===null||a===void 0?void 0:a.type)===A.DataFieldForAction||(a===null||a===void 0?void 0:a.type)===A.DataFieldForIntentBasedNavigation)&&!r.find(function(e){return e.key===(a===null||a===void 0?void 0:a.key)});return{action:a,canBeMenuItem:f}}function T(e,n,r,t,i){var o=N(n,r,i,e.defaultAction),a=o.action,l=o.canBeMenuItem;if(l){e.defaultAction=a}if(a.command){t[a.key]=a}}function q(e,n,r,t,i){var o;var a=[];var l=x((o=e.menu)!==null&&o!==void 0?o:[]),u;try{for(l.s();!(u=l.n()).done;){var f=u.value;var d=N(n,r,i,f),s=d.action,p=d.canBeMenuItem;if(p){a.push(s)}if(s.command){t[f]=s}}}catch(e){l.e(e)}finally{l.f()}e.menu=a;var b=a.map(function(e){return c(e.visible,"boolean")});e.visible=h(g(c(e.visible,"boolean"),v.apply(void 0,j(b))))}function U(e,n,r){var t={};var i=[];var o={};for(var a in e){var l=e[a];if(l.defaultAction!==undefined){T(l,e,n,o,r)}if(l.type===A.Menu){var u;i.push.apply(i,j(l.menu));q(l,e,n,o,r);if(!((u=l.menu)!==null&&u!==void 0&&u.length)){i.push(l.key)}}if(l.command){o[a]=l}t[a]=l}i.forEach(function(e){return delete t[e]});return{actions:t,commandActions:o}}var _=function(e,n,r){if(n&&e.enabled===undefined){return undefined}var t=G(e.enabled,r);return h(s(e.requiresSelection===true,g(p(f("numberOfSelectedContexts","internal"),1),t),t))};var R=function(e,n,r){if(n&&e.visible===undefined){return undefined}var t=G(e.visible,r);return h(t)};function V(e,n){var r,t;if(!n){return}e.type=n.type;e.annotationPath=n.annotationPath;e.press=n.press;e.enabled=(r=e.enabled)!==null&&r!==void 0?r:n.enabled;e.visible=(t=e.visible)!==null&&t!==void 0?t:n.visible}function $(e,n){if(n!==null&&n!==void 0&&n.find(function(n){return n.key===e.key})){e.visible="false"}}function z(e,n,r,t,i,o,a){var l={};var c=function(c){var f,v,d;var s=e[c];var p=((f=s.press)===null||f===void 0?void 0:f.lastIndexOf("."))||-1;var b=r===null||r===void 0?void 0:r.find(function(e){return e.key===c});var y=!!b;if(s.facetName){a=s.facetName}l[c]={id:b?c:O(c),type:s.menu?A.Menu:A.Default,visible:R(s,y,n),enabled:_(s,y,n),handlerModule:s.press&&s.press.substring(0,p).replace(/\./gi,"/"),handlerMethod:s.press&&s.press.substring(p+1),press:s.press,text:s.text,noWrap:s.__noWrap,key:u(c),enableOnSelect:s.enableOnSelect,defaultValuesExtensionFunction:s.defaultValuesFunction,position:{anchor:(v=s.position)===null||v===void 0?void 0:v.anchor,placement:s.position===undefined?S.After:s.position.placement},isNavigable:Q(s,t,i),command:s.command,requiresSelection:s.requiresSelection===undefined?false:s.requiresSelection,enableAutoScroll:J(s),menu:(d=s.menu)!==null&&d!==void 0?d:[],facetName:s.inline?a:undefined,defaultAction:s.defaultAction};V(l[c],b);$(l[c],o)};for(var f in e){c(f)}return U(l,r!==null&&r!==void 0?r:[],o!==null&&o!==void 0?o:[])}l.getActionsFromManifest=z;function G(e,n){var r=c(e,"boolean");var t;if(d(r)&&r.value===undefined){t=true}else if(d(r)&&typeof r.value==="boolean"){t=r.value}else if(r._type!=="EmbeddedBinding"&&r._type!=="EmbeddedExpressionBinding"){var o=r.value;t=y([f("/","$view"),o,f("selectedContexts","internal")],i.customBooleanPropertyCheck,n.getEntityType())}else{t=r}return t}var H=function(e){var n={};e.forEach(function(e){var r;if(e!==null&&e!==void 0&&(r=e.menu)!==null&&r!==void 0&&r.length){n=e.menu.reduce(function(e,n){var r=n.key;if(r&&!e[r]){e[r]=true}return e},n)}});return e.filter(function(e){return!n[e.key]})};l.removeDuplicateActions=H;function L(e,n){var r;if((n===null||n===void 0?void 0:n.isBound)!==true){return"true"}if(n!==null&&n!==void 0&&(r=n.parameters)!==null&&r!==void 0&&r.length){var t,i;var o=n===null||n===void 0?void 0:n.parameters[0].fullyQualifiedName,a=b(n===null||n===void 0?void 0:(t=n.annotations.Core)===null||t===void 0?void 0:t.OperationAvailable,[],undefined,function(n){return E(n,e,o)});if((n===null||n===void 0?void 0:(i=n.annotations.Core)===null||i===void 0?void 0:i.OperationAvailable)!==undefined){return h(m(a,true))}}return"true"}l.getEnabledForAnnotationAction=L;function W(e){var n=[];e.forEach(function(e){var r={LocalProperty:{$PropertyPath:e.LocalProperty.value},SemanticObjectProperty:e.SemanticObjectProperty};n.push(r)});return n}l.getSemanticObjectMapping=W;function Q(e,n,r){var t,i;var o=true;if(r){var a=n&&(n.detail||n.display);o=a!==null&&a!==void 0&&a.route?true:false}if(e&&e.afterExecution&&(((t=e.afterExecution)===null||t===void 0?void 0:t.navigateToInstance)===false||((i=e.afterExecution)===null||i===void 0?void 0:i.enableAutoScroll)===true)||!o){return false}return true}l.isActionNavigable=Q;function J(e){var n;return(e===null||e===void 0?void 0:(n=e.afterExecution)===null||n===void 0?void 0:n.enableAutoScroll)===true}l.enableAutoScroll=J;return l},false);
//# sourceMappingURL=Action.js.map