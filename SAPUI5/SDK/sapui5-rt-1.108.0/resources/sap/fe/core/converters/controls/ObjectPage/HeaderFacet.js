/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/core/converters/annotations/DataField","sap/fe/core/converters/helpers/ConfigurableObject","sap/fe/core/converters/helpers/ID","sap/fe/core/converters/helpers/Key","sap/fe/core/helpers/BindingToolkit","../../../helpers/StableIdHelper","../../helpers/DataFieldHelper","../Common/Form"],function(e,t,a,i,n,o,r,l){"use strict";var v={};var d=l.getFormElementsFromManifest;var c=l.FormElementType;var u=r.isReferencePropertyStaticallyHidden;var s=r.isAnnotationFieldStaticallyHidden;var f=o.generate;var p=n.not;var b=n.getExpressionFromAnnotation;var g=n.equal;var m=n.compileExpression;var y=i.KeyHelper;var F=a.getHeaderFacetID;var I=a.getHeaderFacetFormID;var h=a.getHeaderFacetContainerID;var T=a.getCustomHeaderFacetID;var U=t.Placement;var D=t.insertCustomElements;var P=e.getSemanticObjectPath;function O(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,i)}return a}function C(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?O(Object(a),!0).forEach(function(t){$(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):O(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}function $(e,t,a){if(t in e){Object.defineProperty(e,t,{value:a,enumerable:true,configurable:true,writable:true})}else{e[t]=a}return e}var A;(function(e){e["Annotation"]="Annotation";e["XMLFragment"]="XMLFragment"})(A||(A={}));v.HeaderFacetType=A;var S;(function(e){e["Reference"]="Reference";e["Collection"]="Collection"})(S||(S={}));v.FacetType=S;var H;(function(e){e["Default"]="Default";e["NotAdaptable"]="not-adaptable";e["NotAdaptableTree"]="not-adaptable-tree";e["NotAdaptableVisibility"]="not-adaptable-visibility"})(H||(H={}));v.FlexDesignTimeType=H;var E;(function(e){e["ProgressIndicator"]="ProgressIndicator";e["RatingIndicator"]="RatingIndicator";e["Content"]="Content"})(E||(E={}));var R;(function(e){e["None"]="None";e["DataPoint"]="DataPoint";e["Chart"]="Chart";e["Identification"]="Identification";e["Contact"]="Contact";e["Address"]="Address";e["FieldGroup"]="FieldGroup"})(R||(R={}));function N(e){var t,a,i;var n=[];(t=e.getEntityType().annotations)===null||t===void 0?void 0:(a=t.UI)===null||a===void 0?void 0:(i=a.HeaderFacets)===null||i===void 0?void 0:i.forEach(function(t){var a=B(t,e);if(a){n.push(a)}});return n}v.getHeaderFacetsFromAnnotations=N;function j(e){var t={};Object.keys(e).forEach(function(a){var i=e[a];t[a]=K(i,a)});return t}v.getHeaderFacetsFromManifest=j;function k(e,t,a){var i;if(e.$Type==="com.sap.vocabularies.UI.v1.ReferenceFacet"&&t.$Type==="com.sap.vocabularies.UI.v1.CollectionFacet"){return false}var n=f([{Facet:e}]);var o=a.getManifestWrapper().getHeaderFacets();var r=(i=o[n])===null||i===void 0?void 0:i.stashed;return r===true}v.getStashedSettingsForHeaderFacet=k;function x(e,t,a){var i=H.Default;var n=f([{Facet:e}]);if(e.$Type==="com.sap.vocabularies.UI.v1.ReferenceFacet"&&t.$Type==="com.sap.vocabularies.UI.v1.CollectionFacet"){i=H.NotAdaptableTree}else{var o=a.getManifestWrapper().getHeaderFacets();if(n){var r,l;var v=(r=o[n])===null||r===void 0?void 0:(l=r.flexSettings)===null||l===void 0?void 0:l.designtime;switch(v){case H.NotAdaptable:case H.NotAdaptableTree:case H.NotAdaptableVisibility:i=v;break;default:break}}}return i}v.getDesignTimeMetadataSettingsForHeaderFacet=x;function L(e,t,a){var i,n,o;if(e.$Type==="com.sap.vocabularies.UI.v1.ReferenceFacet"&&!(((i=e.annotations)===null||i===void 0?void 0:(n=i.UI)===null||n===void 0?void 0:(o=n.Hidden)===null||o===void 0?void 0:o.valueOf())===true)){var r,l;var v=F({Facet:e}),d=function(e,t){var a,i;return((a=e.ID)===null||a===void 0?void 0:a.toString())||((i=e.Label)===null||i===void 0?void 0:i.toString())||t},c=e.Target.value,u=M(e);var f;var y;switch(u){case R.FieldGroup:f=V(e,a);break;case R.DataPoint:y=W(e);break;default:break}var I=e.annotations;if(((r=e.Target)===null||r===void 0?void 0:(l=r.$target)===null||l===void 0?void 0:l.term)==="com.sap.vocabularies.UI.v1.Chart"&&s(e)){return undefined}else{var T,U;return{type:A.Annotation,facetType:S.Reference,id:v,containerId:h({Facet:e}),key:d(e,v),flexSettings:{designtime:x(e,t,a)},stashed:k(e,t,a),visible:m(p(g(b(I===null||I===void 0?void 0:(T=I.UI)===null||T===void 0?void 0:(U=T.Hidden)===null||U===void 0?void 0:U.valueOf()),true))),annotationPath:"".concat(a.getEntitySetBasedAnnotationPath(e.fullyQualifiedName),"/"),targetAnnotationValue:c,targetAnnotationType:u,headerFormData:f,headerDataPointData:y}}}return undefined}function w(e,t){if(e.$Type==="com.sap.vocabularies.UI.v1.CollectionFacet"){var a,i,n;var o=[],r=F({Facet:e}),l=function(e,t){var a,i;return((a=e.ID)===null||a===void 0?void 0:a.toString())||((i=e.Label)===null||i===void 0?void 0:i.toString())||t};e.Facets.forEach(function(a){var i=L(a,e,t);if(i){o.push(i)}});return{type:A.Annotation,facetType:S.Collection,id:r,containerId:h({Facet:e}),key:l(e,r),flexSettings:{designtime:x(e,e,t)},stashed:k(e,e,t),visible:m(p(g(b((a=e.annotations)===null||a===void 0?void 0:(i=a.UI)===null||i===void 0?void 0:(n=i.Hidden)===null||n===void 0?void 0:n.valueOf()),true))),annotationPath:"".concat(t.getEntitySetBasedAnnotationPath(e.fullyQualifiedName),"/"),facets:o}}return undefined}function M(e){var t=R.None;var a={"com.sap.vocabularies.UI.v1.DataPoint":R.DataPoint,"com.sap.vocabularies.UI.v1.Chart":R.Chart,"com.sap.vocabularies.UI.v1.Identification":R.Identification,"com.sap.vocabularies.Communication.v1.Contact":R.Contact,"com.sap.vocabularies.Communication.v1.Address":R.Address,"com.sap.vocabularies.UI.v1.FieldGroup":R.FieldGroup};if(e.$Type!=="com.sap.vocabularies.UI.v1.ReferenceURLFacet"&&e.$Type!=="com.sap.vocabularies.UI.v1.CollectionFacet"){var i,n;t=a[(i=e.Target)===null||i===void 0?void 0:(n=i.$target)===null||n===void 0?void 0:n.term]||R.None}return t}function V(e,t){var a;if(!e){throw new Error("Cannot get FieldGroup form data without facet definition")}var i=D(G(e,t),d(e,t));return{id:I({Facet:e}),label:(a=e.Label)===null||a===void 0?void 0:a.toString(),formElements:i}}function G(e,t){var a=[];if(e.$Type!=="com.sap.vocabularies.UI.v1.ReferenceURLFacet"&&e.$Type!=="com.sap.vocabularies.UI.v1.CollectionFacet"){var i,n;(i=e.Target)===null||i===void 0?void 0:(n=i.$target)===null||n===void 0?void 0:n.Data.forEach(function(i){var n,o,r;if(!(((n=i.annotations)===null||n===void 0?void 0:(o=n.UI)===null||o===void 0?void 0:(r=o.Hidden)===null||r===void 0?void 0:r.valueOf())===true)){var l=P(t,i);if((i.$Type==="com.sap.vocabularies.UI.v1.DataField"||i.$Type==="com.sap.vocabularies.UI.v1.DataFieldWithUrl"||i.$Type==="com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath"||i.$Type==="com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation"||i.$Type==="com.sap.vocabularies.UI.v1.DataFieldWithAction")&&!u(i)){var v,d,s,f,F,h,T,U,D,O,C;var $=i.annotations;a.push({isValueMultilineText:((v=i.Value)===null||v===void 0?void 0:(d=v.$target)===null||d===void 0?void 0:(s=d.annotations)===null||s===void 0?void 0:(f=s.UI)===null||f===void 0?void 0:(F=f.MultiLineText)===null||F===void 0?void 0:F.valueOf())===true,type:c.Annotation,key:y.generateKeyFromDataField(i),visible:m(p(g(b($===null||$===void 0?void 0:(h=$.UI)===null||h===void 0?void 0:(T=h.Hidden)===null||T===void 0?void 0:T.valueOf()),true))),label:((U=i.Value)===null||U===void 0?void 0:(D=U.$target)===null||D===void 0?void 0:(O=D.annotations)===null||O===void 0?void 0:(C=O.Common)===null||C===void 0?void 0:C.Label)||i.Label,idPrefix:I({Facet:e},i),annotationPath:"".concat(t.getEntitySetBasedAnnotationPath(i.fullyQualifiedName),"/"),semanticObjectPath:l})}else if(i.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&!u(i)){var A,S,H,E,R,N,j,k,x,L,w,M,V;var G=i.annotations;a.push({isValueMultilineText:((A=i.Target)===null||A===void 0?void 0:(S=A.$target)===null||S===void 0?void 0:(H=S.annotations)===null||H===void 0?void 0:(E=H.UI)===null||E===void 0?void 0:(R=E.MultiLineText)===null||R===void 0?void 0:R.valueOf())===true,type:c.Annotation,key:y.generateKeyFromDataField(i),visible:m(p(g(b(G===null||G===void 0?void 0:(N=G.UI)===null||N===void 0?void 0:(j=N.Hidden)===null||j===void 0?void 0:j.valueOf()),true))),label:((k=i.Target)===null||k===void 0?void 0:(x=k.$target)===null||x===void 0?void 0:(L=x.annotations)===null||L===void 0?void 0:(w=L.Common)===null||w===void 0?void 0:(M=w.Label)===null||M===void 0?void 0:M.toString())||((V=i.Label)===null||V===void 0?void 0:V.toString()),idPrefix:I({Facet:e},i),annotationPath:"".concat(t.getEntitySetBasedAnnotationPath(i.fullyQualifiedName),"/"),semanticObjectPath:l})}}})}return a}function W(e){var t=E.Content;if(e.$Type==="com.sap.vocabularies.UI.v1.ReferenceFacet"&&!s(e)){var a,i,n,o;if(((a=e.Target)===null||a===void 0?void 0:(i=a.$target)===null||i===void 0?void 0:i.Visualization)==="UI.VisualizationType/Progress"){t=E.ProgressIndicator}else if(((n=e.Target)===null||n===void 0?void 0:(o=n.$target)===null||o===void 0?void 0:o.Visualization)==="UI.VisualizationType/Rating"){t=E.RatingIndicator}}return{type:t}}function B(e,t){var a;switch(e.$Type){case"com.sap.vocabularies.UI.v1.ReferenceFacet":a=L(e,e,t);break;case"com.sap.vocabularies.UI.v1.CollectionFacet":a=w(e,t);break;default:break}return a}function z(e){if(!e){return undefined}var t=["Heroes","Decoration","Workers","LongRunners"].indexOf(e)!==-1?"$auto.".concat(e):e;return"{ path : '', parameters : { $$groupId : '".concat(t,"' } }")}function K(e,t){var a=T(t);var i=e.position;if(!i){i={placement:U.After}}return{facetType:S.Reference,facets:[],type:e.type,id:a,containerId:a,key:t,position:i,visible:e.visible,fragmentName:e.template||e.name,title:e.title,subTitle:e.subTitle,stashed:e.stashed||false,flexSettings:C(C({},{designtime:H.Default}),e.flexSettings),binding:z(e.requestGroupId),templateEdit:e.templateEdit}}return v},false);
//# sourceMappingURL=HeaderFacet.js.map