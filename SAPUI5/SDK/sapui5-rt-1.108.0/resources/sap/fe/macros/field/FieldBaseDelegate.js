/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/fe/core/CommonUtils","sap/ui/mdc/odata/v4/FieldBaseDelegate","sap/ui/model/Filter"],function(e,t,r,n){"use strict";function a(e,t){var r=typeof Symbol!=="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=o(e))||t&&e&&typeof e.length==="number"){if(r)e=r;var n=0;var a=function(){};return{s:a,n:function(){if(n>=e.length)return{done:true};return{done:false,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i=true,u=false,l;return{s:function(){r=r.call(e)},n:function(){var e=r.next();i=e.done;return e},e:function(e){u=true;l=e},f:function(){try{if(!i&&r.return!=null)r.return()}finally{if(u)throw l}}}}function o(e,t){if(!e)return;if(typeof e==="string")return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor)r=e.constructor.name;if(r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return i(e,t)}function i(e,t){if(t==null||t>e.length)t=e.length;for(var r=0,n=new Array(t);r<t;r++){n[r]=e[r]}return n}function u(e,t){return e.Parameters.filter(function(e){if(e.LocalDataProperty){return e.LocalDataProperty.$PropertyPath===t}else{return false}})}function l(e,t,r,o,i){var u=[];var l=e.Parameters.filter(function(e){return e.$Type.indexOf("In")>48});var c=a(l),f;try{for(c.s();!(f=c.n()).done;){var s=f.value;if(s.LocalDataProperty.$PropertyPath===t){u.push(new n({path:r,operator:"EQ",value1:o}))}else if(s.$Type.indexOf("In")>48&&i!==null&&i!==void 0&&i.isActionParameterDialog){var v="APD_::".concat(s.LocalDataProperty.$PropertyPath);var d=sap.ui.getCore().byId(v);var p=d===null||d===void 0?void 0:d.getValue();if(p!=null){u.push(new n({path:s.ValueListProperty,operator:"EQ",value1:p}))}}}}catch(e){c.e(e)}finally{c.f()}return u}return Object.assign({},r,{getDescription:function(r,n,a){if(r!==null&&r!==void 0&&r.retrieveTextFromValueList||r!==null&&r!==void 0&&r.isFilterField){var o=n.getModel();var i=o?o.getMetaModel():t.getAppComponent(n).getModel().getMetaModel();var c=n===null||n===void 0?void 0:n.getPayload();var f=c===null||c===void 0?void 0:c.propertyPath;var s;return i.requestValueListInfo(f,true,n.getBindingContext()).then(function(e){var t=i.getObject("".concat(f,"@sapui.name"));var r=e[Object.keys(e)[0]];var n;var o=u(r,t);if(o&&o[0]){n=o[0].ValueListProperty}else{return Promise.reject("Inconsistent value help annotation for ".concat(t))}var v=r.$model;var d=v.getMetaModel().getObject("/".concat(r.CollectionPath,"/").concat(n,"@com.sap.vocabularies.Common.v1.Text"));if(d&&d.$Path){s=d.$Path;var p=l(r,t,n,a,c);var y=v.bindList("/".concat(r.CollectionPath),undefined,undefined,p,{$select:s});return y.requestContexts(0,2)}else{return Promise.reject("Text Annotation for ".concat(n,"is not defined"))}}).then(function(e){return e&&e[0]?e[0].getObject()[s]:""}).catch(function(t){var r=t.status&&t.status===404?"Metadata not found (".concat(t.status,") for value help of property ").concat(f):t.message;e.error(r)})}}})},false);
//# sourceMappingURL=FieldBaseDelegate.js.map