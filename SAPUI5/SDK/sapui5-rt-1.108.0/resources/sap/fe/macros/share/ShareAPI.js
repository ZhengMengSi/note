/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/util/ObjectPath","sap/fe/core/CommonUtils","sap/fe/core/helpers/ClassSupport","sap/m/MenuItem","sap/suite/ui/commons/collaboration/ServiceContainer","sap/ui/core/Core","sap/ui/core/CustomData","../MacroAPI"],function(e,t,r,n,o,i,a,u){"use strict";var s,l,c,f,p,v,b,d;var m=r.xmlEventHandler;var h=r.property;var y=r.defineUI5Class;function g(e,t,r,n){if(!r)return;Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})}function P(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function w(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;O(e,t)}function O(e,t){O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,r){t.__proto__=r;return t};return O(e,t)}function M(e,t,r,n,o){var i={};Object.keys(n).forEach(function(e){i[e]=n[e]});i.enumerable=!!i.enumerable;i.configurable=!!i.configurable;if("value"in i||i.initializer){i.writable=true}i=r.slice().reverse().reduce(function(r,n){return n(e,t,r)||r},i);if(o&&i.initializer!==void 0){i.value=i.initializer?i.initializer.call(o):void 0;i.initializer=undefined}if(i.initializer===void 0){Object.defineProperty(e,t,i);i=null}return i}function I(e,t){throw new Error("Decorating class property failed. Please ensure that "+"proposal-class-properties is enabled and runs after the decorators transform.")}var j=(s=y("sap.fe.macros.ShareAPI",{interfaces:["sap.m.IOverflowToolbarContent"]}),l=h({type:"string"}),c=h({type:"boolean",defaultValue:true}),f=m(),s(p=(v=function(r){w(u,r);function u(e){var t;for(var n=arguments.length,o=new Array(n>1?n-1:0),a=1;a<n;a++){o[a-1]=arguments[a]}t=r.call.apply(r,[this,e].concat(o))||this;g(t,"id",b,P(t));g(t,"visible",d,P(t));if(t.content){var u=t.content.getId();var s=u+"-internalBtn";t._internalMenuButton=i.byId(s);t._internalMenuButton.attachEventOnce("press",{},t.onMenuButtonPressed,P(t))}return t}var s=u.prototype;s.getOverflowToolbarConfig=function e(){return{canOverflow:true}};s.onMenuButtonPressed=function t(){try{var r=this;var i=[];return Promise.resolve(o.getServiceAsync()).then(function(t){var o=t.getOptions();o.forEach(function(e){var t;var o={text:e.text,icon:e.icon};if(e!==null&&e!==void 0&&e.subOptions&&(e===null||e===void 0?void 0:(t=e.subOptions)===null||t===void 0?void 0:t.length)>0){o["items"]=[];e.subOptions.forEach(function(e){var t;var i=new n({text:e.text,icon:e.icon,press:r.menuItemPress,customData:new a({key:"collaborationData",value:e})});(t=o["items"])===null||t===void 0?void 0:t.push(i)})}else{o["press"]=r.menuItemPress;o["customData"]=new a({key:"collaborationData",value:e})}var u=new n(o);i.push(u)});if(i){var u=r.content;var s=u.getMenu();var l=e.get("sap.ushell.Container.getUser");var c=0;if(!!l&&l().isJamActive()){c=2}else{c=1}i.forEach(function(e){s.insertItem(e,c);c++})}})}catch(e){return Promise.reject(e)}};s.menuItemPress=function e(r){try{var n=r.getSource();return Promise.resolve(o.getServiceAsync()).then(function(e){var r=t.getTargetView(n);var o=r.getController();return Promise.resolve(o.share._adaptShareMetadata()).then(function(){var t=r.getModel("collaborationInfo").getData();e.share(n.data("collaborationData"),t)})})}catch(e){return Promise.reject(e)}};s.openMenu=function e(){var t;(t=this._internalMenuButton)===null||t===void 0?void 0:t.firePress()};return u}(u),b=M(v.prototype,"id",[l],{configurable:true,enumerable:true,writable:true,initializer:null}),d=M(v.prototype,"visible",[c],{configurable:true,enumerable:true,writable:true,initializer:null}),M(v.prototype,"onMenuButtonPressed",[f],Object.getOwnPropertyDescriptor(v.prototype,"onMenuButtonPressed"),v.prototype),v))||p);return j},false);
//# sourceMappingURL=ShareAPI.js.map