/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/core/formatters/ValueFormatter","sap/fe/core/helpers/BindingToolkit","sap/fe/core/templating/DataModelPathHelper","sap/fe/core/templating/PropertyHelper","sap/fe/core/templating/UIFormatters","sap/ui/model/odata/v4/AnnotationHelper"],function(e,t,r,a,i,n){"use strict";var o={};var v=i.getDisplayMode;var l=i.getBindingWithUnitOrCurrency;var u=i.getBindingWithTimezone;var s=i.formatWithTypeInformation;var d=i.EDM_TYPE_MAPPING;var c=a.isProperty;var f=a.hasStaticPercentUnit;var g=r.getRelativePaths;var p=r.enhanceDataModelPath;var m=t.unresolveableExpression;var O=t.isPathInModelExpression;var T=t.getExpressionFromAnnotation;var I=t.formatResult;var b=t.compileExpression;var _=function(e){return e!==null&&e!==void 0&&e.TargetValue?T(e.TargetValue):m};var E=sap.ui.getCore().getLibraryResourceBundle("sap.fe.macros");var P=function(t){var r;var a=(t===null||t===void 0?void 0:(r=t.targetObject)===null||r===void 0?void 0:r.Value)||"";var i=g(t);var n=T(a,i);var o=_(t.targetObject);if(n&&o){var v,l,u,d;var p=t.targetObject.Value;if(!c(p)){p=t.targetObject.Value.$target}var m=((v=p.annotations)===null||v===void 0?void 0:(l=v.Measures)===null||l===void 0?void 0:l.Unit)||((u=p.annotations)===null||u===void 0?void 0:(d=u.Measures)===null||d===void 0?void 0:d.ISOCurrency);if(!m){return E.getText("T_COMMON_PROGRESS_INDICATOR_DISPLAY_VALUE_NO_UOM",[b(n),b(o)])}if(f(a===null||a===void 0?void 0:a.$target)){return"".concat(b(n)," %")}n=s(p,n);var O=m.$target?s(m.$target,T(m,i)):T(m,i);return b(I([n,o,O],e.formatProgressIndicatorText))}return undefined};o.buildExpressionForProgressIndicatorDisplayValue=P;var A=function(e){var t,r,a,i,n,o;var v=g(e);var l=e===null||e===void 0?void 0:(t=e.targetObject)===null||t===void 0?void 0:(r=t.Value)===null||r===void 0?void 0:r.$target;if(!c(l)){return""}var u=((a=l.annotations)===null||a===void 0?void 0:(i=a.Measures)===null||i===void 0?void 0:i.Unit)||((n=l.annotations)===null||n===void 0?void 0:(o=n.Measures)===null||o===void 0?void 0:o.ISOCurrency);return u?b(T(u,v)):""};o.buildUnitBindingExpression=A;var D=function(e,t){if(t){return N(n.value(t,{context:e}))}};var N=function(e){if(e){var t=e>1?E.getText("T_ANNOTATION_HELPER_RATING_INDICATOR_SUBTITLE_LABEL_PLURAL"):E.getText("T_ANNOTATION_HELPER_RATING_INDICATOR_SUBTITLE_LABEL");return E.getText("T_ANNOTATION_HELPER_RATING_INDICATOR_SUBTITLE",[String(e),t])}};var h=function(e,t){if(t&&t.SampleSize){return D(e,t.SampleSize)}else if(t&&t.Description){var r=n.value(t.Description,{context:e});return"${path:"+r+"}"}};h.requiresIContext=true;o.getHeaderRatingIndicatorText=h;var x=function(e){var t,r,a;var i=g(e);if(e!==null&&e!==void 0&&(t=e.targetObject)!==null&&t!==void 0&&(r=t.annotations)!==null&&r!==void 0&&(a=r.Common)!==null&&a!==void 0&&a.Text){var n,o;var v=T(e===null||e===void 0?void 0:(n=e.targetObject.annotations)===null||n===void 0?void 0:(o=n.Common)===null||o===void 0?void 0:o.Text,i);if(O(v)){v.parameters={$$noPatch:true}}return v}return undefined};var M=function(e,t,r){if(!e.constraints){e.constraints={}}e.constraints=Object.assign(e.constraints,{precision:t.$target.precision,scale:r?r:t.$target.scale});if(r){if(!e.formatOptions){e.formatOptions={}}e.formatOptions=Object.assign(e.formatOptions,{preserveDecimals:false})}return e};var V=function(e,t,r,a){var i;var n;var o=(t===null||t===void 0?void 0:(i=t.path)===null||i===void 0?void 0:i.indexOf("/"))===-1?g(e):[];n=T(t,o);var v=e.targetObject;if(r&&O(n)){var l;s(v,n);n.type=(l=d[r])===null||l===void 0?void 0:l.type;switch(r){case"Edm.Decimal":n=M(n,t,a);break;default:}}return n};var j=function(t,r,a){var i,n,o,l;var s=t.targetObject;var d=(s===null||s===void 0?void 0:s.Value)||"";var c=d===null||d===void 0?void 0:(i=d.$target)===null||i===void 0?void 0:i.type;var f;if(c==="Edm.Decimal"&&s.ValueFormat){if(s.ValueFormat.NumberOfFractionalDigits){f=s.ValueFormat.NumberOfFractionalDigits}}var g=p(t,d.path);var m=g?x(g):undefined;var O=V(g,d,c,f);var T=m?r.displayMode||v(g):"Value";var _;switch(T){case"Description":_=m;break;case"ValueDescription":_=I([O,m],e.formatWithBrackets);break;case"DescriptionValue":_=I([m,O],e.formatWithBrackets);break;default:if((n=g.targetObject)!==null&&n!==void 0&&(o=n.annotations)!==null&&o!==void 0&&(l=o.Common)!==null&&l!==void 0&&l.Timezone){_=u(g,O)}else{_=y(g,O,a||(r===null||r===void 0?void 0:r.measureDisplayMode)==="Hidden")}}return b(_)};o.buildFieldBindingExpression=j;var y=function(e,t,r){var a,i,n,o,v,u;if((a=e.targetObject)!==null&&a!==void 0&&(i=a.annotations)!==null&&i!==void 0&&(n=i.Measures)!==null&&n!==void 0&&n.Unit||(o=e.targetObject)!==null&&o!==void 0&&(v=o.annotations)!==null&&v!==void 0&&(u=v.Measures)!==null&&u!==void 0&&u.ISOCurrency){if(r&&f(e.targetObject)){return t}return l(e,t,undefined,r?{showMeasure:false}:undefined)}return t};o._computeBindingWithUnitOrCurrency=y;var R=function(t){var r,a,i,n,o;var v=(t===null||t===void 0?void 0:(r=t.targetObject)===null||r===void 0?void 0:r.Value)||"";var l=g(t);var u=T(v,l);var d=_(t.targetObject);var c=v.$target;var f=((a=c.annotations)===null||a===void 0?void 0:(i=a.Measures)===null||i===void 0?void 0:i.Unit)||((n=c.annotations)===null||n===void 0?void 0:(o=n.Measures)===null||o===void 0?void 0:o.ISOCurrency);if(f){var p=f.$target?s(f.$target,T(f,l)):T(f,l);return b(I([u,d,p],e.computePercentage))}return b(I([u,d,""],e.computePercentage))};o.buildExpressionForProgressIndicatorPercentValue=R;return o},false);
//# sourceMappingURL=DataPointTemplating.js.map