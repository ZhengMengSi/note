/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/core/CommonUtils","sap/fe/core/helpers/ModelHelper","sap/fe/core/templating/DisplayModeFormatter","sap/fe/macros/CommonHelper","sap/ui/model/odata/v4/AnnotationHelper"],function(e,t,n,r,i){"use strict";var a=n.EDM_TYPE_MAPPING;var o={isRequiredInFilter:function(n,i){var a=i.context.getModel(),o=i.context.getPath(),s=r.getLocationForPropertyPath(a,o);var l=t.getEntitySetPath(s,a);var c,f,u=a.getObject(l+"/@com.sap.vocabularies.Common.v1.ResultContext");if(!u){if(typeof n==="string"){c=n}else{c=a.getObject("".concat(o,"@sapui.name"))}f=e.getFilterRestrictionsByPath(l,a);u=f&&f.RequiredProperties&&f.RequiredProperties.indexOf(c)>-1}return u},maxConditions:function(t,n){var i,a=-1;var o=n.context.getModel(),s=n.context.getPath();var l=r.getLocationForPropertyPath(o,s);if(o.getObject("".concat(l,"/@com.sap.vocabularies.Common.v1.ResultContext"))===true){return 1}if(typeof t==="string"){i=t}else{i=o.getObject("".concat(s,"@sapui.name"))}var c=e.getFilterRestrictionsByPath(l,o);var f=o.getObject("".concat(l,"/").concat(i));if(!f){f=o.getObject(s)}if(f.$Type==="Edm.Boolean"){a=1}else if(c&&c.FilterAllowedExpressions&&c.FilterAllowedExpressions[i]){var u=e.getSpecificAllowedExpression(c.FilterAllowedExpressions[i]);if(u==="SingleValue"||u==="SingleRange"){a=1}}return a},getConditionsBinding:function(e,t,n){var r=e.getInterface(0),i=r.getModel(),a=r.getPath();var o="",s=e.getInterface(1).getPath(),l,c;if(n&&n["$kind"]==="EntityType"&&a.startsWith(s)){s=e.getInterface(1).getPath();var f=a.replace(s,"");l=f.split("/")}else{l=a.substring(1).split("/");s="/".concat(l.shift(),"/")}for(c=0;c<l.length;++c){t=i.getProperty(s+l.slice(0,c+1).join("/"));if(t.$kind==="NavigationProperty"&&t.$isCollection){o+="".concat(l[c],"*/")}else if(typeof t!=="string"){o+="".concat(l[c],"/")}}return"{$filters>/conditions/".concat(o.substring(0,o.length-1),"}")},constraints:function(e,t){var n=i.format(e,t),r=n&&n.match(/constraints:.*?({.*?})/);var a=r&&r[1];if(n.indexOf("sap.ui.model.odata.type.DateTimeOffset")>-1){if(a){a="".concat(a.substr(0,r===null||r===void 0?void 0:r[1].indexOf("}")),", V4: true}")}else{a="{V4: true}"}}if(a&&a.indexOf("'nullable':false")>=0){a=a.replace(/,[ ]*'nullable':false/,"").replace(/'nullable':false[, ]*/,"");if(a==="{}"){return undefined}}return a||undefined},formatOptions:function(e,t){if(e.$Type==="Edm.String"&&(!e.hasOwnProperty("$Nullable")||e.$Nullable===true)){t.arguments=[null,{parseKeepsEmptyString:false}]}var n=i.format(e,t),r=n&&n.match(/formatOptions:.*?({.*?})/);return r&&r[1]||undefined},getDataType:function(e){var t=a[e];return t?t.type:e}};o.getConditionsBinding.requiresIContext=true;return o},false);
//# sourceMappingURL=FilterFieldHelper.js.map