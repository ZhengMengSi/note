{"version":3,"file":"ExportHandler.js","names":["sap","ui","define","library","ExportUtils","ExportDialog","MessageToast","Core","EventProvider","ODataModel","openWindow","Destination","FileType","ExportHandler","extend","constructor","mCapabilities","that","this","call","_mCapabilities","Object","XLSX","_initialized","Promise","fnResolve","isGoogleSheetSupported","then","bSupported","GSHEET","_mDialogSettings","destination","REMOTE","fileType","finally","prototype","attachBeforeExport","oData","fnHandler","oListener","attachEvent","detachBeforeExport","detachEvent","initialized","destroy","apply","arguments","_oModel","_oFileShareBinding","_oDataSource","bIsDestroyed","getFileShareContexts","getFileShareModel","oModel","resolve","bindList","requestContexts","bind","getRemoteFileLocation","sFileName","fnReject","all","getResourceBundle","aResolve","oResourceBundle","require","CloudFilePicker","oFilePicker","sharedModel","suggestedFileName","enableDuplicateCheck","fileNameMandatory","confirmButtonText","getText","title","attachSelect","oEvent","aSelectedFiles","oSelectedFolder","bReplaceFile","mCloudFileInfo","getParameter","getFileShareId","getFileShareItemId","Array","isArray","length","oCloudFile","shift","open","getExportInstance","mExportSettings","mCustomSettings","oExportInstance","mEventExportSettings","fireEvent","exportSettings","userExportSettings","attachBeforeSave","aArrayBuffer","oExportDialog","getMimeType","uInt8Array","Uint8Array","stringArray","i","String","fromCharCode","btoa","join","updateStatus","preventDefault","uploadFile","show","catch","showErrorMessage","finish","oBinding","oContext","sContentProperty","sTypeProperty","sPath","getKeepAliveContext","FileShare","FileShareItem","setProperty","getProperty","ParentFileShareItem","_createFile","sUrl","fnCreateCompleted","bSuccess","detachCreateCompleted","attachCreateCompleted","create","export","reject","build","exportAs","oSettings","fnResolveColumnLabel","mUserSettings","assign","aContexts","getExportSettingsViaDialog","mDialogSettings","PDF","validateFileSettings","splitCells","includeFilterSettings","workbook","columns","splitColumns","parseFilterConfiguration","dataSource","oFilterConfig","context","metaSheetName","name","metainfo","push","parseTechnicalConfiguration","aUserConfig","forEach","oUserConfig","unshift","LOCAL","fileName","validateFileShare","oFileShareContext","find","isGoogleWorkspace","fetchDataSource","oDataSource","serviceUrl","uri","synchronizationMode","autoExpandSelect","some","sDescription","sVendorType","URL","window","location","href","search","indexOf"],"sources":["ExportHandler-dbg.js"],"mappings":"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"}