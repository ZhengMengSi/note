sap.ui.define(["sap/ui/core/mvc/OverrideExecution","sap/suite/ui/generic/template/lib/TemplateAssembler","sap/suite/ui/generic/template/ListReport/controller/ControllerImplementation","sap/suite/ui/generic/template/ListReport/controllerFrameworkExtensions","sap/suite/ui/generic/template/genericUtilities/testableHelper","sap/suite/ui/generic/template/listTemplates/filterSettingsPreparationHelper","sap/suite/ui/generic/template/js/staticChecksHelper","sap/suite/ui/generic/template/js/preparationHelper","sap/base/util/deepExtend","sap/suite/ui/generic/template/genericUtilities/FeError","sap/suite/ui/generic/template/js/StableIdHelper","sap/ui/model/Context","sap/suite/ui/generic/template/js/AnnotationHelper","sap/base/util/isEmptyObject","sap/suite/ui/generic/template/ListReport/AnnotationHelper"],function(e,t,a,i,n,l,o,r,s,u,c,p,d,f,b){"use strict";var g="ListReport.Component";function m(e,t){var n={};return{oControllerSpecification:{getMethods:a.getMethods.bind(null,n),oControllerDefinition:i,oControllerExtensionDefinition:{onInitSmartFilterBar:function(e){},provideExtensionAppStateData:function(e){},restoreExtensionAppStateData:function(e){},ensureFieldsForSelect:function(e,t){},addFilters:function(e,t){}}},oComponentData:{templateName:"sap.suite.ui.generic.template.ListReport.view.ListReport",designtimePath:"sap/suite/ui/generic/template/designtime/ListReport.designtime"},init:function(){var t=e.getModel("_templPriv");t.setProperty("/listReport",{})},adaptToChildContext:function(e){n.adaptToChildContext(e)},refreshBinding:function(e,t){n.refreshBinding(e,t)},getItems:function(){return n.getItems()},displayNextObject:function(e){return n.displayNextObject(e)},getTemplateSpecificParameters:function(e,a,i,n,m,y,S){function v(t,a){var i=e.getODataEntitySet(t);var n=e.getODataEntityType(i.entityType);var l,o,r;o=a.annotationPath;r=!!o&&n[o];if(r&&r.PresentationVariant){if(r.PresentationVariant.Visualizations){l=r.PresentationVariant.Visualizations[0].AnnotationPath}else if(r.PresentationVariant.Path){var s=r.PresentationVariant.Path.split("@")[1];var u=s&&n[s];l=u.Visualizations[0].AnnotationPath}}else if(r&&r.Visualizations){l=r.Visualizations[0].AnnotationPath}return!!(l&&l.indexOf("com.sap.vocabularies.UI.v1.Chart")>-1)}function V(){var e="/"+n;var t=new p(y,e);var a=S.getODataDraftFunctionImportName(t,"NewAction");return!!a}function E(t,a,i,n){var l=t?t.tableSettings:a.tableSettings;var r=false;var s=l.mode;if(l.multiEdit.enabled!==false&&a.isResponsiveTable&&!a.isWorklist){r=true;if(i["Org.OData.Capabilities.V1.UpdateRestrictions"]&&i["Org.OData.Capabilities.V1.UpdateRestrictions"].Updatable&&i["Org.OData.Capabilities.V1.UpdateRestrictions"].Updatable.Bool==="false"){r=false}else if(s==="None"){s=l.multiSelect?"MultiSelect":"SingleSelectLeft"}var u=l.multiEdit.annotationPath;if(u){o.checkErrorforMultiEditDialog(n,u);var c=n[u].Data;var p=c.filter(function(t){var a=e.getODataProperty(n,t.Value.Path);if(a){return t.RecordType==="com.sap.vocabularies.UI.v1.DataField"&&a["sap:updatable"]!=="false"&&(!t["com.sap.vocabularies.UI.v1.Hidden"]||t["com.sap.vocabularies.UI.v1.Hidden"].Bool==="false")&&(!a["Org.OData.Core.V1.Immutable"]||a["Org.OData.Core.V1.Immutable"].Bool==="false")}})}}return{multiEditEnabled:r,selectionMode:s,fields:p}}function h(a,i){function l(e){return{Create:{action:"Create",callbackName:"._templateEventHandlers.addEntry",text:A.createWithFilters?"{i18n>CREATE_NEW_OBJECT}":"{i18n>CREATE_OBJECT}",id:c.getStableId({type:"ListReportAction",subType:"Create",sQuickVariantKey:e}),press:"cmd:Create",enabled:true,isStandardAction:true},CreateWithFilters:{action:"CreateWithFilters",callbackName:"._templateEventHandlers.addEntryWithFilters",text:"{i18n>ST_CREATE_WITH_FILTERS}",id:c.getStableId({type:"ListReportAction",subType:"CreateWithFilter",sQuickVariantKey:e}),press:"cmd:CreateWithFilters",enabled:"{_templPriv>/generic/bDataAreShownInTable}",isStandardAction:true},Delete:{action:"Delete",callbackName:"._templateEventHandlers.deleteEntries",text:"{i18n>DELETE}",id:c.getStableId({type:"ListReportAction",subType:"Delete",sQuickVariantKey:e}),press:"cmd:Delete",enabled:"{_templPriv>/listReport/deleteEnabled}",isStandardAction:true}}}function o(e,t){if(f(e)){throw new u(g,"Identified an invalid value of 'logicalAction' i.e., '"+t.logicalAction+"' for a custom action in the manifest.")}return s({},e,{callbackName:t.press,text:t.text,id:t.id&&d.getBreakoutActionButtonId(t,A.quickVariantSelectionX?A.quickVariantSelectionX.variants[i]:undefined),enabled:d.getBreakoutActionEnabledKey(t,A.quickVariantSelectionX?A.quickVariantSelectionX.variants[i]:undefined),press:"cmd:"+t.logicalAction,isStandardAction:false})}function r(){var t=e.getObject(P.$path+"/"+b.getRelevantPresentationVariantPath(P,A.annotationPath));if(t&&t.Visualizations){var a=t.Visualizations.find(function(e){var t="/"+e.AnnotationPath.slice(1);return t.indexOf("com.sap.vocabularies.UI.v1.LineItem")>-1});if(a){return a.AnnotationPath.split("#")[1]||""}}if(A.quickVariantSelectionX){var n=P[A.quickVariantSelectionX.variants[i].annotationPath];if(n&&n.Visualizations){var l=n.Visualizations[0].AnnotationPath;if(l){if(l.indexOf("com.sap.vocabularies.UI.v1.LineItem")>-1){return(P.$path+"/"+l.slice(1)).split("#")[1]||""}}}}return""}var p=l(a);var y=t.getControllerExtensions();var S=[],v=Object.create(null),V=Object.create(null),E=Object.create(null);Object.values(y&&y.Actions||{}).forEach(function(e){if(e.logicalAction){if(A.quickVariantSelectionX&&A.quickVariantSelectionX.variants[i].entitySet&&A.quickVariantSelectionX.variants[i].entitySet!==n){return}p[e.logicalAction]=o(s({},p[e.logicalAction]),e)}else if(!e.global){var t=e.global?{type:"Action",subType:"Global",sAction:e.id}:{type:"ListReportAction",subType:"TableExtension",sAction:e.id,sQuickVariantKey:a};var l=c.getStableId(t);if(e.command){v[e.id]={id:l,action:e.command,callbackName:e.press};e.press="cmd:"+e.command}e.enabled=d.getBreakoutActionEnabledKey(e,A.quickVariantSelectionX?A.quickVariantSelectionX.variants[i]:undefined);e.id=l;S.push(e)}});var h=r();(P["com.sap.vocabularies.UI.v1.LineItem"+(h?"#"+h:"")]||[]).forEach(function(e){switch(e.RecordType){case"com.sap.vocabularies.UI.v1.DataFieldForAction":var a=t.getToolbarDataFieldForActionCommandDetails(e,A,A.quickVariantSelectionX?A.quickVariantSelectionX.variants[i]:undefined);if(!f(a)){V[a.id]=a}break;case"com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation":var a=t.getToolbarDataFieldForIBNCommandDetails(e,A,m,A.quickVariantSelectionX?A.quickVariantSelectionX.variants[i]:undefined);if(!f(a)){E[a.id]=a}break;default:break}});return{commandExecution:s(p,v,V,E),extensionActions:S}}var A=s({},a);A.targetEntities={};function T(t){if(!A.targetEntities[t.entityType]){A.targetEntities[t.entityType]=r.getTargetEntityForQuickView(e,t)}}A.bNewAction=a.useNewActionForCreate&&V();var C=t.getControllerExtensions();var k=C&&C.Actions;var D=e.getODataEntitySet(n);var P=e.getODataEntityType(D.entityType);var I=r.getLineItemFromVariant(e,D.entityType);var R;if(A.quickVariantSelectionX){var F=r.getNormalizedTableSettings(e,A,i,n,k,I);var O=A.quickVariantSelectionX.variants||{};for(var x in O){var w=O[x].entitySet||n;var L=e.getODataEntitySet(w);if(!L){delete O[x];continue}O[x].isSmartChart=v(w,O[x]);if(!O[x].isSmartChart){var j=r.getLineItemFromVariant(e,e.getODataEntitySet(w).entityType,O[x].annotationPath&&O[x].annotationPath.split("#")[1]);O[x].tableSettings=O[x].tableSettings||F;O[x].tableSettings=r.getNormalizedTableSettings(e,O[x],i,w,k,j);O[x].tableSettings.selectAll=O[x].tableSettings.selectAll===undefined?false:O[x].tableSettings.selectAll;if(A.isResponsiveTable===undefined){A.isResponsiveTable=O[x].tableSettings.type==="ResponsiveTable"}else if(A.isResponsiveTable!==(O[x].tableSettings.type==="ResponsiveTable")){throw new u(g,"Variant with key "+x+" resulted in invalid Table Type combination. Please check documentation and update manifest.json.")}var q=e.getODataEntityType(L.entityType);if(q&&q.property&&O[x].tableSettings&&O[x].tableSettings.createWithParameterDialog){o.checkErrorforCreateWithDialog(q,O[x].tableSettings);A.quickVariantSelectionX.variants[x].tableSettings.createWithParameterDialog.id=c.getStableId({type:"ListReportAction",subType:"CreateWithDialog",sQuickVariantKey:O[x].key})}if(O[x].tableSettings.multiEdit){R=E(O[x],A,L,P);O[x].tableSettings.multiEdit.enabled=R.multiEditEnabled;if(R.multiEditEnabled){O[x].tableSettings.multiEdit.fields=R.fields;O[x].tableSettings.mode=R.selectionMode}}T(L);O[x].tableSettings=s(O[x].tableSettings,h(O[x].key,x))}}delete A.tableSettings;if(A.isResponsiveTable===undefined){A.isResponsiveTable=true}}else{A.tableSettings=r.getNormalizedTableSettings(e,a,i,n,k,I);A.tableSettings.selectAll=A.tableSettings.selectAll===undefined?false:A.tableSettings.selectAll;A.isResponsiveTable=A.tableSettings.type==="ResponsiveTable";if(A.tableSettings.multiEdit){R=E(undefined,A,D,P);A.tableSettings.multiEdit.enabled=R.multiEditEnabled;if(R.multiEditEnabled){A.tableSettings.multiEdit.fields=R.fields;A.tableSettings.mode=R.selectionMode}}T(D);A.tableSettings=s(A.tableSettings,h())}A.controlConfigurationSettings=l.getControlConfigurationSettings(A,P,D,y);if(P&&P.property&&a&&A&&A.tableSettings&&A.tableSettings.createWithParameterDialog){o.checkErrorforCreateWithDialog(P,A.tableSettings);A.tableSettings.createWithParameterDialog.id=c.getStableId({type:"ListReportAction",subType:"CreateWithDialog"})}A.isSelflinkRequired=true;A.isIndicatorRequired=true;A.isSemanticallyConnected=false;if(window["sap-ushell-config"]&&window["sap-ushell-config"].apps&&window["sap-ushell-config"].apps.insights){A.bInsightsEnabled=window["sap-ushell-config"].apps.insights.enabled?true:false}else{A.bInsightsEnabled=false}return A},executeAfterInvokeActionFromExtensionAPI:function(e){e.oPresentationControlHandler.setEnabledToolbarButtons();e.oPresentationControlHandler.setEnabledFooterButtons()},getCurrentState:function(){return n.getCurrentState.apply(null,arguments)},applyState:function(){n.applyState.apply(null,arguments)},getStatePreserverSettings:function(){return{callAlways:false}}}}n.testableStatic(m,"Component_getMethods");return t.getTemplateComponent(m,"sap.suite.ui.generic.template.ListReport",{metadata:{library:"sap.suite.ui.generic.template",properties:{hideChevronForUnauthorizedExtNav:{type:"boolean",defaultValue:"false"},treeTable:{type:"boolean",defaultValue:false},gridTable:{type:"boolean",defaultValue:false},tableType:{type:"string",defaultValue:undefined},multiSelect:{type:"boolean",defaultValue:false},tableSettings:{type:"object",properties:{type:{type:"string",defaultValue:undefined},multiSelect:{type:"boolean",defaultValue:false},inlineDelete:{type:"boolean",defaultValue:false},selectAll:{type:"boolean",defaultValue:false},selectionLimit:{type:"int",defaultValue:200},multiEdit:{type:"object",properties:{enabled:{type:"boolean",defaultValue:true},annotationPath:{type:"string"},ignoredFields:{type:"string",defaultValue:""}}}}},createWithFilters:"object",condensedTableLayout:"boolean",smartVariantManagement:{type:"boolean",defaultValue:false},hideTableVariantManagement:{type:"boolean",defaultValue:false},variantManagementHidden:{type:"boolean",defaultValue:false},createWithParameterDialog:{type:"object",properties:{fields:{type:"object"}}},creationEntitySet:"string",enableTableFilterInPageVariant:{type:"boolean",defaultValue:false},useNewActionForCreate:{type:"boolean",defaultValue:false},multiContextActions:"object",isWorklist:{type:"boolean",defaultValue:false},filterSettings:l.getFilterSettingsMetadata(),dataLoadSettings:{type:"object",properties:{loadDataOnAppLaunch:{type:"string",defaultValue:"ifAnyFilterExist"}}},quickVariantSelectionX:{type:"object",properties:{showCounts:{type:"boolean",defaultValue:false},variants:{type:"object",mapEntryProperties:{key:{type:"string",optional:true},annotationPath:{type:"string"},entitySet:{type:"string",optional:true},tableSettings:{type:"object",properties:{type:{type:"string",defaultValue:undefined},multiSelect:{type:"boolean",defaultValue:false},inlineDelete:{type:"boolean",defaultValue:false},selectAll:{type:"boolean",defaultValue:false},selectionLimit:{type:"int",defaultValue:200}}}}}}},quickVariantSelection:{type:"object",properties:{showCounts:{type:"boolean",defaultValue:false},variants:{type:"object",mapEntryProperties:{key:{type:"string",optional:true},annotationPath:{type:"string"}}}}},annotationPath:{type:"string",defaultValue:undefined},editFlow:{type:"string",defaultValue:"display"}},manifest:"json"}})});
//# sourceMappingURL=Component.js.map