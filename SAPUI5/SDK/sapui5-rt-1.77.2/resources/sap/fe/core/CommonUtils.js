/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
        (c) Copyright 2009-2017 SAP SE. All rights reserved
    
 */
sap.ui.define(["sap/ui/core/mvc/View","sap/ui/core/Component","sap/m/MessageBox","sap/base/Log","sap/fe/navigation/SelectionVariant"],function(V,C,M,L,S){"use strict";function g(o){while(o&&!(o instanceof V)){o=o.getParent();}return o;}function h(l){var H=false;l.getCurrentContexts().forEach(function(o){if(o&&o.isTransient()){H=true;}});return H;}function u(E,o,x,s,k,l,m,q,t){var P={};if(E){if(l&&l.length>0){for(var j=0;j<l.length;j++){var v=l[j].$PropertyPath;if(!P[v]){P[v]=[];P[v].push(E[v]);}}}else{var T=q.getObject(t+"/$Type/$Key");for(var w in T){var O=T[w];if(!P[O]){P[O]=[];P[O].push(E[O]);}}}}var y=x.getLinks({semanticObject:s,params:P});y.done(function(z){z.sort(function(F,H){if(F.text<H.text){return-1;}if(F.text>H.text){return 1;}return 0;});if(z&&z.length>0){var I=[];for(var i=0;i<z.length;i++){var A=z[i];var B=A.intent;var D=B.split("-")[1].split("?")[0];if(D!==k&&(!m||(m&&m.indexOf(D)===-1))){I.push({text:A.text,targetSemObject:B.split("#")[1].split("-")[0],targetAction:D.split("~")[0],targetParams:P});}}o.getModel("relatedAppsModel").setProperty("/visibility",I.length>0);o.getModel("relatedAppsModel").setProperty("/items",I);}else{o.getModel("relatedAppsModel").setProperty("/visibility",false);}});}function U(o){var i=sap.ushell&&sap.ushell.Container;var x=i&&i.getService("CrossApplicationNavigation");var j=i&&i.getService("URLParsing");var P=j&&j.parseShellHash(document.location.hash);var s=P.semanticObject;var k=P.action;var m=o.getModel().getMetaModel();var B=o.getBindingContext();var l=B&&B.getPath();var q=m.getMetaPath(l);var t=q+"/"+"@com.sap.vocabularies.Common.v1.SemanticKey";var v=m.getObject(t);var w=m.getObject(q+"/"+"@com.sap.vocabularies.Common.v1.SemanticObjectUnavailableActions");var E=B.getObject();if(!E){B.requestObject().then(function(E){u(E,o,x,s,k,v,w,m,q);});}else{u(E,o,x,s,k,v,w,m,q);}}function f(B){var A=["sap.m.Button","sap.m.OverflowToolbarButton"];if(B&&A.indexOf(B.getMetadata().getName())!==-1&&B.getVisible()&&B.getEnabled()){B.firePress();}}function r(v){if(v==="true"||v===true){return true;}else{return false;}}function a(o){var O=C.getOwnerComponentFor(o);if(!O){return o;}else{return a(O);}}function p(P,o,i,j){var k=o&&o.getModel("ui")&&o.getModel("ui").getData(),l=k.createMode||k.editable==="Editable",R=sap.ui.getCore().getLibraryResourceBundle("sap.fe.templates"),w=R&&R.getText("NAVIGATION_AWAY_MSG"),s=R&&R.getText("NAVIGATION_AWAY_CONFIRM_BUTTON"),m=R&&R.getText("NAVIGATION_AWAY_CANCEL_BUTTON");if(i==="Sticky"&&l){return M.warning(w,{actions:[s,m],onClose:function(A){if(A===s){var q=o&&o.getModel("localUI");L.info("Navigation confirmed.");if(q){q.setProperty("/sessionOn",false);}else{L.warning("Local UIModel couldn't be found.");}P();if(j){j.editFlow.fnStickyDiscard(o.getBindingContext());}}else{L.info("Navigation rejected.");}}});}return P();}function n(v,s,i,A,o){s=s?s:new S();var N=s.toJSONString();var j=e.getAppComponent(v);j.getService("navigation").then(function(k){k.navigate(i,A,N,null,o);});}function G(m,E){var o=m.getObject("/"+E+"/")||{},P={};for(var k in o){if(o.hasOwnProperty(k)&&!/^\$/i.test(k)&&o[k].$kind&&o[k].$kind==="Property"){P[k]=o[k];}}return P;}function b(m,E){var i;if(m&&E){i=m.getObject("/"+E+"@Org.OData.Capabilities.V1.FilterRestrictions/RequiredProperties");}return i;}function c(l){var o=sap.ushell&&sap.ushell.Container;var x=o&&o.getService("CrossApplicationNavigation");var j=x.getLinks({params:{}});j.then(function(k){if(k&&k.length>0){var m={};for(var i=0;i<k.length;i++){m[k[i].intent.substring(1)]=true;}l.setProperty("/IBNActions",m);}});}function d(F,R,P,E){var s;if(R){if(E){s=F+"|"+E;if(R.getText(s,P,true)){return R.getText(s,P,true);}}if(R.getText(F,P,true)){return R.getText(F,P,true);}}R=sap.ui.getCore().getLibraryResourceBundle("sap.fe.core");return R.getText(F,P);}var e={fireButtonPress:f,getParentViewOfControl:g,hasTransientContext:h,updateRelatedAppsDetails:U,resolveStringtoBoolean:r,getAppComponent:a,processDataLossConfirmation:p,navigateToExternalApp:n,getMandatoryFilterFields:b,getEntitySetProperties:G,updateDataFiledForIBNButtonsVisibility:c,getTranslatedText:d};return e;});
