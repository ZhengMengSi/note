sap.ui.define("sap/fe/core/converters/common/AnnotationConverter",[],function(){"use strict";function _(n,i){return e(n)||d(n,i)||b(n,i)||a();}function a(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function b(o,i){if(!o)return;if(typeof o==="string")return c(o,i);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(n);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(o,i);}function c(n,o){if(o==null||o>n.length)o=n.length;for(var i=0,s=new Array(o);i<o;i++){s[i]=n[i];}return s;}function d(n,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(n)))return;var o=[];var s=true;var t=false;var u=undefined;try{for(var v=n[Symbol.iterator](),w;!(s=(w=v.next()).done);s=true){o.push(w.value);if(i&&o.length===i)break;}}catch(x){t=true;u=x;}finally{try{if(!s&&v["return"]!=null)v["return"]();}finally{if(t)throw u;}}return o;}function e(i){if(Array.isArray(i))return i;}function f(i,C){if(!(i instanceof C)){throw new TypeError("Cannot call a class as a function");}}var P=function P(i,t){f(this,P);this.path=i.Path;this.type="Path";this.$target=t;};function g(i){var o={};if(i.schema.entityContainer&&i.schema.entityContainer.fullyQualifiedName){o[i.schema.entityContainer.fullyQualifiedName]=i.schema.entityContainer;}i.schema.entitySets.forEach(function(n){o[n.fullyQualifiedName]=n;});i.schema.actions.forEach(function(n){o[n.fullyQualifiedName]=n;n.parameters.forEach(function(s){o[s.fullyQualifiedName]=s;});});i.schema.entityTypes.forEach(function(n){o[n.fullyQualifiedName]=n;n.entityProperties.forEach(function(s){o[s.fullyQualifiedName]=s;});n.navigationProperties.forEach(function(s){o[s.fullyQualifiedName]=s;});});Object.keys(i.schema.annotations).forEach(function(n){i.schema.annotations[n].forEach(function(s){var t=i.unalias(s.target);s.annotations.forEach(function(u){var v="".concat(t,"/@").concat(i.unalias(u.term));if(u.qualifier){v+="#".concat(u.qualifier);}o[v]=u;u.fullyQualifiedName=v;});});});return o;}function r(o,i,n){var s=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;n=i.fullyQualifiedName+"/"+n;var t=n.split("/");var u=n;var v=t.reduce(function(w,x){if(!w){u=x;}else if(w._type==="EntitySet"&&w.entityType){u=w.entityType+"/"+x;}else if(w._type==="NavigationProperty"&&w.targetTypeName){u=w.targetTypeName+"/"+x;}else if(w._type==="NavigationProperty"&&w.targetType){u=w.targetType.fullyQualifiedName+"/"+x;}else if(w._type==="Property"){u=i.fullyQualifiedName.substr(0,i.fullyQualifiedName.lastIndexOf("/"))+"/"+x;}else if(w._type==="Action"&&w.isBound){u=w.fullyQualifiedName+"/"+x;if(!o[u]){u=w.sourceType+"/"+x;}}else if(w._type==="ActionParameter"&&w.isEntitySet){u=w.type+"/"+x;}else if(w._type==="ActionParameter"&&!w.isEntitySet){u=i.fullyQualifiedName.substr(0,i.fullyQualifiedName.lastIndexOf("/"))+"/"+x;if(!o[u]){u=o[i.fullyQualifiedName.substr(0,i.fullyQualifiedName.lastIndexOf("/"))].sourceType+"/"+x;}}else{u=w.fullyQualifiedName+"/"+x;}return o[u];},null);if(!v){}if(s){return u;}return v;}function p(i,n,o,s,t){if(i===undefined){return undefined;}switch(i.type){case"String":return i.String;case"Int":return i.Int;case"Bool":return i.Bool;case"Decimal":return i.Decimal;case"Date":return i.Date;case"EnumMember":return i.EnumMember;case"PropertyPath":return{type:"PropertyPath",value:i.PropertyPath,$target:r(s,o,i.PropertyPath)};case"NavigationPropertyPath":return{type:"NavigationPropertyPath",value:i.NavigationPropertyPath,$target:r(s,o,i.NavigationPropertyPath)};case"AnnotationPath":var u=r(s,o,n.unalias(i.AnnotationPath),true);var v={type:"AnnotationPath",value:i.AnnotationPath,$target:u};t.push(v);return v;case"Path":var $=r(s,o,i.Path,true);var w=new P(i,$);t.push(w);return w;case"Record":return h(i.Record,n,o,s,t);case"Collection":return j(i.Collection,n,o,s,t);case"Apply":return i;}}function h(i,n,o,s,t){var u={$Type:n.unalias(i.type)};var v={};i.propertyValues.forEach(function(w){v[w.name]=p(w.value,n,o,s,t);});return Object.assign(u,v);}function j(i,n,o,s,t){switch(i.type){case"PropertyPath":return i.map(function(u){return{type:"PropertyPath",value:u.PropertyPath,$target:r(s,o,u.PropertyPath)};});case"Path":return i.map(function(u){var $=r(s,o,u.Path,true);var v=new P(u,$);t.push(v);return v;});case"AnnotationPath":return i.map(function(u){var v=r(s,o,u.AnnotationPath,true);var w={type:"AnnotationPath",value:u.AnnotationPath,$target:v};t.push(w);return w;});case"NavigationPropertyPath":return i.map(function(u){return{type:"NavigationPropertyPath",value:u.NavigationPropertyPath,$target:r(s,o,u.NavigationPropertyPath)};});case"Record":return i.map(function(u){return h(u,n,o,s,t);});case"String":return i.map(function(u){return u;});default:if(i.length===0){return[];}throw new Error("Unsupported case");}}function k(i,n,o,s,t){if(i.record){var u={$Type:n.unalias(i.record.type),fullyQualifiedName:i.fullyQualifiedName,qualifier:i.qualifier};var v={};i.record.propertyValues.forEach(function(x){v[x.name]=p(x.value,n,o,s,t);});return Object.assign(u,v);}else if(!i.isCollection){if(i.value){return p(i.value,n,o,s,t);}else{return true;}}else if(i.collection){var w=j(i.collection,n,o,s,t);w.fullyQualifiedName=i.fullyQualifiedName;return w;}else{throw new Error("Unsupported case");}}function l(i,o){return function(n){return r(o,i,n);};}function m(i,o){i.schema.entityTypes.forEach(function(n){n.navigationProperties.forEach(function(s){if(s.targetTypeName){s.targetType=o[s.targetTypeName];}else if(s.relationship){var t=i.schema.associations.find(function(v){return v.fullyQualifiedName===s.relationship;});if(t){var u=t.associationEnd.find(function(v){return v.role===s.toRole;});if(u){s.targetType=o[u.type];}}}});n.resolvePath=l(n,o);});}function q(i){var o=g(i);m(i,o);var t=[];var u=[];Object.keys(i.schema.annotations).forEach(function(n){i.schema.annotations[n].forEach(function(s){var v=i.unalias(s.target);var w=o[v];if(!w){if(v.indexOf("@")!==-1){u.push(s);}}else{if(!w.annotations){w.annotations={};}s.annotations.forEach(function(x){var y=x.term.split("."),z=_(y,2),B=z[0],C=z[1];if(!w.annotations[B]){w.annotations[B]={};}if(!w.annotations._annotations){w.annotations._annotations={};}var D="".concat(C).concat(x.qualifier?"#".concat(x.qualifier):"");w.annotations[B][D]=k(x,i,w,o,t);if(typeof w.annotations[B][D]==="object"){w.annotations[B][D].term=i.unalias("".concat(B,".").concat(C));w.annotations[B][D].qualifier=x.qualifier;}w.annotations._annotations["".concat(B,".").concat(D)]=w.annotations[B][D];o["".concat(v,"@").concat(i.unalias(B+"."+D))]=w.annotations[B][D];});}});});u.forEach(function(n){var s=i.unalias(n.target);var v=s.split("@"),w=_(v,2),x=w[0],y=w[1];var z=y.split("/");x=x+"@"+z[0];var B=z.slice(1).reduce(function(C,D){if(!C){return null;}return C[D];},o[x]);if(!B){}else{if(!B.annotations){B.annotations={};}n.annotations.forEach(function(C){var D=C.term.split("."),E=_(D,2),F=E[0],G=E[1];if(!B.annotations[F]){B.annotations[F]={};}if(!B.annotations._annotations){B.annotations._annotations={};}var H="".concat(G).concat(C.qualifier?"#".concat(C.qualifier):"");B.annotations[F][H]=k(C,i,B,o,t);if(typeof B.annotations[F][H]==="object"){B.annotations[F][H].term=i.unalias("".concat(F,".").concat(G));B.annotations[F][H].qualifier=C.qualifier;}B.annotations._annotations["".concat(F,".").concat(H)]=B.annotations[F][H];o["".concat(s,"@").concat(i.unalias(F+"."+H))]=B.annotations[F][H];});}});t.forEach(function(n){n.$target=o[n.$target];});return i;}var A={convertTypes:q};return A;});
