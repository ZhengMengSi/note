sap.ui.define(["sap/fe/macros/StableIdHelper","sap/ui/model/odata/v4/AnnotationHelper","./ManifestSettings","./ConverterUtil"],function(S,A,M,C){"use strict";var a=M.SectionType;var P=M.Placement;function o(i,j){var k=Object.keys(i);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);if(j)s=s.filter(function(l){return Object.getOwnPropertyDescriptor(i,l).enumerable;});k.push.apply(k,s);}return k;}function _(t){for(var i=1;i<arguments.length;i++){var s=arguments[i]!=null?arguments[i]:{};if(i%2){o(Object(s),true).forEach(function(k){b(t,k,s[k]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(t,Object.getOwnPropertyDescriptors(s));}else{o(Object(s)).forEach(function(k){Object.defineProperty(t,k,Object.getOwnPropertyDescriptor(s,k));});}}return t;}function b(i,k,v){if(k in i){Object.defineProperty(i,k,{value:v,enumerable:true,configurable:true,writable:true});}else{i[k]=v;}return i;}var c=function(i){return i.type!==undefined&&i.type==="Path";};var g=function(i,j,k){if(!i){return k;}else if(c(i)){return A.format({$Path:i.path},{context:j});}else{return A.format(i,{context:j});}};var d=function(i,j,k){if(!i){return k;}var l=g(i,j,k);return"{= !$".concat(l,"}");};var e=function(s,i,j){var k=s.concat();if(i.ID){k.push(i.ID);}else{switch(i.$Type){case"com.sap.vocabularies.UI.v1.ReferenceURLFacet":k.push(j);break;case"com.sap.vocabularies.UI.v1.ReferenceFacet":k.push(i.Target.value);break;case"com.sap.vocabularies.UI.v1.CollectionFacet":k.push(j);break;}}return S.generate(k);};var f=function(i,j){var k,l;return((k=i.ID)===null||k===void 0?void 0:k.toString())||((l=i.Label)===null||l===void 0?void 0:l.toString())||j;};var p=function(s,k){if(!s){throw new Error("undefined section");}if(s.visible===undefined||s.visible===null){s.visible=true;}s.showTitle=s.title!==undefined;if(!s.type){s.type=a.Default;}if((s.type===a.XMLFragment||s.type===a.Default)&&(!s.subSections||!Object.keys(s.subSections).length)){s.subSections={"default":_({},s,{},{showTitle:false,position:undefined,controlId:S.generate(["fe","opss",k])})};}return s;};var h=function(i,m,s,j){var k,l;var n={controlId:e(s,i,j),title:g(i.Label,m),visible:d((k=i.annotations)===null||k===void 0?void 0:(l=k.UI)===null||l===void 0?void 0:l.Hidden,m,true),annotationRef:m.getPath("@".concat(j)),subSections:{},type:a.Annotation};n.showTitle=n.title!==undefined;switch(i.$Type){case"com.sap.vocabularies.UI.v1.CollectionFacet":var q=i.Facets.find(function(i){return i.$Type==="com.sap.vocabularies.UI.v1.CollectionFacet";});if(q){var r;i.Facets.forEach(function(i,t){var u=h(i,m,["fe","opss"],"".concat(j,"/Facets/").concat(t));if(r!==undefined){u.position={anchor:r,placement:P.After};}r=f(i,t.toString());n.subSections[r]=u;});}else{n.subSections[f(i,e(["fe","opss"],i,j))]={controlId:e(["fe","opss"],i,j),title:n.title,type:a.Annotation,visible:n.visible,annotationRef:n.annotationRef};}break;case"com.sap.vocabularies.UI.v1.ReferenceFacet":n.subSections[f(i,e(["fe","opss"],i,j))]={controlId:e(["fe","opss"],i,j),title:n.title,type:a.Annotation,visible:n.visible,annotationRef:n.annotationRef};break;case"com.sap.vocabularies.UI.v1.ReferenceURLFacet":break;}return n;};return{convertPage:function(i,m,j,u){var k,l;var s={};var n;(k=i.annotations.UI)===null||k===void 0?void 0:(l=k.Facets)===null||l===void 0?void 0:l.forEach(function(z,B){var D=h(z,m,["fe","ops"],"".concat(u("UI.Facets"),"/").concat(B));if(n!=null){D.position={anchor:n,placement:P.After};}n=f(z,B.toString());s[n]=D;});for(var q in(r=j.content)===null||r===void 0?void 0:(t=r.body)===null||t===void 0?void 0:t.sections){var r,t,v,w;var x=(v=j.content)===null||v===void 0?void 0:(w=v.body)===null||w===void 0?void 0:w.sections[q];s[q]=p(_({},{controlId:S.generate(["fe","ops",q])},{},s[q],{},x),q);}var y=C.orderByPosition(s).filter(function(z){return z.visible;}).map(function(z){z.subSections=C.orderByPosition(z.subSections);return z;});return{sections:y};}};});
