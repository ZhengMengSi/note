/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.define(["sap/ui/core/Control","sap/ui/vk/AnnotationStyle","sap/ui/vk/AnnotationPositionType","sap/ui/vk/SafeArea","sap/ui/vk/AnnotationRenderer","sap/ui/vk/NodeUtils","sap/ui/vk/NodeContentType","sap/m/FormattedText","sap/ui/richtexteditor/RichTextEditor","sap/ui/richtexteditor/EditorType"],function(C,A,c,S,d,N,e,F,R,E){"use strict";var f=C.extend("sap.ui.vk.Annotation",{metadata:{properties:{annotationId:"string",annotationName:"string",annotationType:"string",nodeRef:"any",title:"string",style:{type:"sap.ui.vk.AnnotationStyle",defaultValue:A.Default},visible:{type:"boolean",defaultValue:false},isStatic:{type:"boolean",defaultValue:false},selected:{type:"boolean",defaultValue:false},editable:{type:"boolean",defaultValue:false},xCoordinate:{type:"float"},yCoordinate:{type:"float"},height:{type:"float"},width:{type:"float"},positionType:{type:"sap.ui.vk.AnnotationPositionType",defaultValue:c.Relative}},events:{textUpdated:{parameters:{text:{type:"string"},nodeRef:{type:"object"}}},positionChanged:{parameters:{nodeRef:{type:"object"},x:{type:"float"},y:{type:"float"}}},sizeChanged:{parameters:{nodeRef:{type:"object"},width:{type:"float"},height:{type:"float"}}},doubleClicked:{parameters:{nodeRef:{type:"sap.ui.core.control"}}}},aggregations:{textEditor:{type:"sap.ui.core.Control",multiple:false}}},constructor:function(i,m){C.apply(this,arguments);}});f.prototype._getNodeRefScreenCenter=function(v,n){var a=N.centerOfNodes([n||this.getNodeRef()]);return v.projectToScreen(a[0],a[1],a[2],v.getCamera());};f.prototype._getSortIndex=function(v){this.zIndex=this.zIndex||"auto";if(this.getNodeRef()){var a=N.centerOfNodes([this.getNodeRef()]);var b=v.projectToScreen(a[0],a[1],a[2],v.getCamera());this.zIndex=Math.floor(10000*(1-b.depth));}return this.zIndex;};f.prototype.setSceneView=function(a,v){this._sceneRef=a;this._viewIds=this._viewIds||new Map();if(v){this._viewIds.set(v,true);}};f.prototype._getOpacity=function(){if(this._sceneRef){var z=this.zIndex;var a=[];this._sceneRef.getAnnotations().forEach(function(k){if(k.getVisible()===true){a.push(k);}});if(a.length>1){var b=Array.from(a,function(k){return k.zIndex;});var i=Math.max.apply(null,b);var j=Math.min.apply(null,b);return 0.7+(z-j)*0.3/(i-j);}}return 1;};f.prototype.setBlocked=function(i){this._isBlocked=i;};f.prototype._updateBlocked=function(v){var a=this.getNodeRef();var b=v.getDomRef().getBoundingClientRect();var n=this._getNodeRefScreenCenter(v,a);var i=v.hitTest(n.x,b.height-n.y);if(i){if([a.uuid,a.parent.uuid].includes(i.object.uuid)){this._isBlocked=false;this.getDomRef().className="sapUiVizKitAnnotation"+this.getStyle();}else{this._isBlocked=true;var j=sap.ui.getCore().byId(v.getViewStateManager());var w=j.getTransformationWorld(i.object).translation;var k=v.projectToScreen(w[0],w[1],w[2],v.getCamera());if(k.z<n.z){this.getDomRef().className="sapUiVizKitAnnotationHidden";}else{this.getDomRef().className="sapUiVizKitAnnotation"+this.getStyle();}}}};f.prototype._getDelay=function(){if(this._sceneRef){var z=this.zIndex;var i=[];this._sceneRef.getAnnotations().forEach(function(a){if(a.getVisible()===true){i.push(a);}});if(i.length<=1){return 0;}var j=Array.from(i,function(a){return a.zIndex;}).sort(function(a,b){return b-a;});return j.indexOf(z);}};f.prototype.setTitle=function(t){this.setProperty("title",t);this.fireTextUpdated({text:this.getTitle(),nodeRef:this.getAnnotationNode()});this.setText(t);};f.prototype.setText=function(t){if(this.getTextEditor()){this._textDiv.value=t;return this;}if(this._textDiv==null){this._textDiv=new F({htmlText:t,width:this._textWidth?this._textWidth:"100px",height:this._textHeight?this._textHeight:"40px"});this._textDiv.addStyleClass("sapUiVizKitAnnotationText");this._textDiv.onclick=this._handleSelect.bind(this);}else if(this.getStyle()===A.Random){this._setRandomText(t);}else{this._textDiv.setHtmlText(t);}return this;};f.prototype._setRandomText=function(t){if(this.getTextEditor()){return this;}var n="";for(var i=0;i<t.length;i++){if(t[i]==="<"){n+="<";while(t[i]!==">"){i++;n+=t[i];}}if(t[i]!==">"){var r=(this._getDelay()+Math.random())+"s";var a=this.getIsStatic()?"annotationStatic":"annotationRandomTextSpan";n+="<span style='animation: "+a+" 4s linear "+r+" 1 alternate both;'>";n+=t[i];n+="</span>";}}this._textDiv.setHtmlText(n);return this;};f.prototype.setStyle=function(v){this.setProperty("style",v);this.setText(this.getTitle());};f.prototype.init=function(){this.attachBrowserEvent("dblclick",function(){this.fireDoubleClicked();});};f.prototype.openEditor=function(){var r=new R({editorType:E.TinyMCE4,width:this._textDiv.getWidth(),height:this._textDiv.getHeight(),value:this.getTitle()});if(this._textDiv){this._textDiv.onclick=null;this._textDiv.destroy();}r.addStyleClass("sapUiVizKitAnnotationRTE");this._textDiv=r;this.setTextEditor(r);this.rerender();return r;};f.prototype.closeEditor=function(){if(this.getTextEditor()==null){return;}var t=this._textDiv.getValue();this.destroyTextEditor();this._textDiv=null;this.setText(t);};f.prototype.onAfterRendering=function(){var a=this.getDomRef();if(a){a.style.display=this.getTitle()?"block":"none";this._initialOffsetWidth=a.offsetWidth;this._initialOffsetHeight=a.offsetHeight;delete this._textDiv.ontouchstart;if(!this.getVisible()){a.style.visibility="hidden";}}};f.prototype._handleSelect=function(a){var n=this.getAnnotationNode();var p=n?[n]:[];if(this._viewport.getSelectionMode()===sap.ui.vk.SelectionMode.Exclusive){this._viewport.exclusiveSelectionHandler(p);}else if(this._viewport.getSelectionMode()===sap.ui.vk.SelectionMode.Sticky){this._viewport.stickySelectionHandler(p);}a.stopPropagation();};f.prototype.setVisibleFromNode=function(v){var a=sap.ui.getCore().byId(v.getViewStateManager());var n=this.getAnnotationNode();this.setProperty("visible",a.getVisibilityState(n));return this;};f.prototype.setVisible=function(v){this.setProperty("visible",v);var a=this.getDomRef();if(a){var b=sap.ui.getCore().byId(this._viewport.getViewStateManager());var n=this.getAnnotationNode();if(b.getVisibilityState(n)!==v){b.setVisibilityState(n,v);}var i=a.nextSibling;var j=i.nextSibling;a.style.visibility=v?"visible":"hidden";i.style.visibility=v?"visible":"hidden";if(!this._moving){j.style.visibility=v?"visible":"hidden";}}return this;};f.prototype.setEditable=function(a){var b=this.getDomRef();if(b){if(a){this._previousState=this._previousState||{};var i=b.getBoundingClientRect();this._previousState.style=this.getStyle();this._previousState.positionType=this.getPositionType();this._previousState.x=i.x;this._previousState.y=i.y;this.setPositionType(c.Fixed);this.setStyle(A.Editing);}else{if(!this.getEditable()){return this;}var j=this._offsetTop?c.Fixed:this._previousState.positionType;this.setPositionType(j);this.setIsStatic(true);this.setStyle(this._previousState.style);}this._shouldRenderVp=true;this.setProperty("editable",a);}return this;};f.prototype.setSelected=function(a){this.setProperty("selected",a);var v=sap.ui.getCore().byId(this._viewport.getViewStateManager());var n=this.getAnnotationNode();if(v.getSelectionState(n)!==a){v.setSelectionState(n,a);}return this;};f.prototype.setAnnotationId=function(a,b){this.setProperty("annotationId",a);var n=this.getAnnotationNode();if(n){n.userData.nodeId=a;b.setNodePersistentId(n,this.getAnnotationId());}};f.prototype.setHeight=function(a){if(a<0){return;}this.setProperty("height",a);if(!this._viewport){return;}var b=this.getDomRef();if(this._viewport.getSafeArea()){var i=document.getElementById(this._viewport.getSafeArea().sId);var j=parseFloat(i.style.height);j*=a;if(b){b.style.height="calc("+j+"px + 1rem)";}}else{var v=this._viewport.getDomRef();if(v){var k=v.getBoundingClientRect().height;k*=a;if(b){b.style.height="calc("+k+"px + 1rem)";}}}};f.prototype.setWidth=function(w){if(w<0){return;}this.setProperty("width",w);if(!this._viewport){return;}var a=this.getDomRef();if(this._viewport.getSafeArea()){var b=document.getElementById(this._viewport.getSafeArea().sId);var i=parseFloat(b.style.width);i*=w;if(a){a.style.width="calc("+i+"px + 1rem)";a.style.maxWidth="calc("+i+"px + 1rem)";}}else{var v=this._viewport.getDomRef();if(v){var j=v.getBoundingClientRect().width;j*=w;if(a){a.style.width="calc("+j+"px + 1rem)";a.style.maxWidth="calc("+j+"px + 1rem)";}}}};f.prototype.setXCoordinate=function(x){this.setProperty("xCoordinate",x);if(!this._viewport){return;}var a=this.getDomRef();var n=Math.abs(x)*2;var b=window.getComputedStyle(document.getElementById(this._viewport.getSafeArea().sId));var i=parseFloat(b.width);var j=parseFloat(b.left);if(this._viewport.getSafeArea()&&!(i===0&&j===0)){var k=j+(i/2);var l=i/2;if(x<0){n=1-n;l*=n;a.style.left=((j+l)+2)+"px";}else if(x>0){l*=n;a.style.left=((k+l)+2)+"px";}else{a.style.left=k+"px";}}else{var v=this._viewport.getDomRef();if(v){v=v.getBoundingClientRect();var m=parseFloat(v.width);var o=m/2;var p=m/2;if(x<0){n=1-n;p*=n;a.style.left=p+"px";}else if(x>0){p*=n;a.style.left=(o+p)+"px";}else{a.style.left=o+"px";}}}};f.prototype.getXCoordinate=function(){var a=this.getDomRef();if(a&&this._viewport){var b=window.getComputedStyle(document.getElementById(this.sId));var i=parseFloat(b.left);var j=window.getComputedStyle(document.getElementById(this._viewport.getSafeArea().sId));var k=parseFloat(j.width);var l=parseFloat(j.left);if(this._viewport.getSafeArea()&&!(k===0&&l===0)){i-=2;var x=(((i-l))/k)+-0.5;return x;}else{var v=this._viewport.getDomRef();if(v){v=v.getBoundingClientRect();var m=parseFloat(v.width);var n=(i/m)+-0.5;return n;}}}else{return this.getProperty("xCoordinate");}};f.prototype.setYCoordinate=function(y){this.setProperty("yCoordinate",y);if(!this._viewport){return;}var a=this.getDomRef();var n=Math.abs(y)*2;var b=window.getComputedStyle(document.getElementById(this._viewport.getSafeArea().sId));var i=parseFloat(b.height);var j=parseFloat(b.top);if(this._viewport.getSafeArea()&&!(i===0&&j===0)){var k=j+(i/2);var l=i/2;if(y<0){n=1-n;l*=n;a.style.top=((j+l)+2)+"px";}else if(y>0){l*=n;a.style.top=((k+l)+2)+"px";}else{a.style.top=k+"px";}}else{var v=this._viewport.getDomRef();if(v){v=v.getBoundingClientRect();var m=parseFloat(v.height);var o=m/2;var p=m/2;if(y<0){n=1-n;p*=n;a.style.top=p+"px";}else if(y>0){p*=n;a.style.top=(o+p)+"px";}else{a.style.top=o+"px";}}}};f.prototype.getYCoordinate=function(){var a=this.getDomRef();if(a&&this._viewport){var b=window.getComputedStyle(document.getElementById(this.sId));var i=parseFloat(b.top);var j=window.getComputedStyle(document.getElementById(this._viewport.getSafeArea().sId));var k=parseFloat(j.height);var l=parseFloat(j.top);if(this._viewport.getSafeArea()&&!(k===0&&l===0)){i-=2;var y=(((i-l))/k)+-0.5;return y;}else{var v=this._viewport.getDomRef();if(v){v=v.getBoundingClientRect();var m=parseFloat(v.height);var n=(i/m)+-0.5;return n;}}}else{return this.getProperty("yCoordinate");}};f.prototype.getAnnotationNode=function(){if(this.sourceData){return this.sourceData.node;}return null;};f.prototype.setSelectedState=function(a){var b=this.getDomRef();if(a&&b){b.style.setProperty("--border-color","red");}else{b.style.setProperty("--border-color","transparent");}};f.prototype.setEditableState=function(){var t=this;var a=this.getDomRef();var b=this._sceneRef.getEditableAnnotations();var v=this._viewport.getDomRef().getBoundingClientRect();var i=a.nextSibling;var j=new Map();b.forEach(function(a){var l=parseInt(a._textDiv.getWidth().slice(0,-2),10);var m=parseInt(a._textDiv.getHeight().slice(0,-2),10);j.set(a.getAnnotationId(),{width:l,height:m});});var k=a.childNodes;this._textDiv.onmousedown=function(l){var o=l||event;if(o.button===0){b.forEach(function(a){a._moving=true;a._initialX=o.clientX;a._initialY=o.clientY;});document.onmousemove=function(l){o=l||event;t._viewport._viewportGestureHandler._gesture=false;b.forEach(function(a){a._currentX=o.clientX-a._initialX;a._currentY=o.clientY-a._initialY;s(a._currentX,a._currentY,a.getDomRef());});};document.onmouseup=function(){b.forEach(function(a){a._handleViewportStop();});document.onmousemove=null;document.onmouseup=null;};}};i.onmousedown=function(l){var o=l||event;var m;var n={_initialX:o.clientX,_initialY:o.clientY};var p=t.getNodeRef();document.onmousemove=function(l){t._moving=true;t._viewport._viewportGestureHandler._gesture=false;o=l||event;s(o.clientX-n._initialX,o.clientY-n._initialY,i);m=t._viewport.hitTest(o.clientX-v.x,o.clientY-v.y);};document.onmouseup=function(){t._moving=false;var q=window.getComputedStyle(i);var r=i.style.transform;i.style.transform="";var x=parseFloat(r.substring(r.indexOf("(")+1,r.indexOf(",")));var y=parseFloat(r.substring(r.indexOf(",")+1,r.indexOf(")")));i.style.left=parseFloat(q.left)+x+"px";i.style.top=parseFloat(q.top)+y+"px";if(m){t.setNodeRef(m.object);}else{t.setNodeRef(p);}t._shouldRenderVp=true;document.onmousemove=null;document.onmouseup=null;};};k[0].onmousedown=function(l){var o=l||event;if(o.button===0){var m=o.clientX-k[0].offsetLeft;var n=o.clientY-k[0].offsetTop;document.onmousemove=function(l){t._viewport._viewportGestureHandler._gesture=false;var o=l||event;var p=o.clientX-m;var q=o.clientY-n;b.forEach(function(a){a._moving=true;a._textWidth=j.get(a.getAnnotationId()).width-p+"px";a._textHeight=j.get(a.getAnnotationId()).height-q+"px";a._textDiv.setWidth(a._textWidth);a._textDiv.setHeight(a._textHeight);a._textDiv.getDomRef().style.width=a._textWidth;a._textDiv.getDomRef().style.height=a._textHeight;s(p,q,a.getDomRef());});};document.onmouseup=function(){b.forEach(function(a){a._handleViewportStop();var p=a.getDomRef().getBoundingClientRect();var q=a.getWidth()?a.getWidth():p.width/v.width;var r=a.getHeight()?a.getHeight():p.height/v.height;a.getAnnotationNode().scale.set(q,r,1);a.fireSizeChanged({nodeRef:a.getAnnotationNode(),width:q,height:r});});document.onmousemove=null;document.onmouseup=null;};}};k[1].onmousedown=function(l){var o=l||event;if(o.button===0){var m=o.clientY-k[0].offsetTop;document.onmousemove=function(l){t._viewport._viewportGestureHandler._gesture=false;var o=l||event;var n=o.clientY-m;b.forEach(function(a){a._moving=true;a._textHeight=j.get(a.getAnnotationId()).height-n+"px";a._textDiv.setHeight(a._textHeight);a._textDiv.getDomRef().style.height=a._textHeight;s(0,n,a.getDomRef());});};document.onmouseup=function(){b.forEach(function(a){a._handleViewportStop();var n=a.getDomRef().getBoundingClientRect();var p=a.getWidth()?a.getWidth():n.width/v.width;var q=a.getHeight()?a.getHeight():n.height/v.height;a.getAnnotationNode().scale.set(p,q,1);a.fireSizeChanged({nodeRef:a.getAnnotationNode(),width:p,height:q});});document.onmousemove=null;document.onmouseup=null;};}};k[2].onmousedown=function(l){var o=l||event;if(o.button===0){var m=o.clientX-k[0].offsetLeft;var n=o.clientY-k[0].offsetTop;document.onmousemove=function(l){t._viewport._viewportGestureHandler._gesture=false;var o=l||event;var p=o.clientX-m;var q=o.clientY-n;b.forEach(function(a){a._moving=true;a._textWidth=j.get(a.getAnnotationId()).width+p+"px";a._textHeight=j.get(a.getAnnotationId()).height-q+"px";a._textDiv.setWidth(a._textWidth);a._textDiv.setHeight(a._textHeight);a._textDiv.getDomRef().style.width=a._textWidth;a._textDiv.getDomRef().style.height=a._textHeight;s(0,q,a.getDomRef());});};document.onmouseup=function(){b.forEach(function(a){a._handleViewportStop();var p=a.getDomRef().getBoundingClientRect();var q=a.getWidth()?a.getWidth():p.width/v.width;var r=a.getHeight()?a.getHeight():p.height/v.height;a.getAnnotationNode().scale.set(q,r,1);a.fireSizeChanged({nodeRef:a.getAnnotationNode(),width:q,height:r});});document.onmousemove=null;document.onmouseup=null;};}};k[3].onmousedown=function(l){var o=l||event;if(o.button===0){var m=o.clientX-k[0].offsetLeft;document.onmousemove=function(l){t._viewport._viewportGestureHandler._gesture=false;var o=l||event;var n=o.clientX-m;b.forEach(function(a){a._moving=true;a._textWidth=j.get(a.getAnnotationId()).width+n+"px";a._textDiv.setWidth(a._textWidth);a._textDiv.getDomRef().style.width=a._textWidth;});};document.onmouseup=function(){b.forEach(function(a){a._handleViewportStop();var n=a.getDomRef().getBoundingClientRect();var p=a.getWidth()?a.getWidth():n.width/v.width;var q=a.getHeight()?a.getHeight():n.height/v.height;a.getAnnotationNode().scale.set(p,q,1);a.fireSizeChanged({nodeRef:a.getAnnotationNode(),width:p,height:q});});document.onmousemove=null;document.onmouseup=null;};}};k[4].onmousedown=function(l){var o=l||event;if(o.button===0){var m=o.clientX-k[0].offsetLeft;var n=o.clientY-k[0].offsetTop;document.onmousemove=function(l){t._viewport._viewportGestureHandler._gesture=false;var o=l||event;var p=o.clientX-m;var q=o.clientY-n;b.forEach(function(a){a._moving=true;a._textWidth=j.get(a.getAnnotationId()).width+p+"px";a._textHeight=j.get(a.getAnnotationId()).height+q+"px";a._textDiv.setWidth(a._textWidth);a._textDiv.setHeight(a._textHeight);a._textDiv.getDomRef().style.width=a._textWidth;a._textDiv.getDomRef().style.height=a._textHeight;});};document.onmouseup=function(){b.forEach(function(a){a._handleViewportStop();var p=a.getDomRef().getBoundingClientRect();var q=a.getWidth()?a.getWidth():p.width/v.width;var r=a.getHeight()?a.getHeight():p.height/v.height;a.getAnnotationNode().scale.set(q,r,1);a.fireSizeChanged({nodeRef:a.getAnnotationNode(),width:q,height:r});});document.onmousemove=null;document.onmouseup=null;};}};k[5].onmousedown=function(l){var o=l||event;if(o.button===0){var m=o.clientY-k[0].offsetTop;document.onmousemove=function(l){t._viewport._viewportGestureHandler._gesture=false;var o=l||event;var n=o.clientY-m;b.forEach(function(a){a._moving=true;a._textHeight=j.get(a.getAnnotationId()).height+n+"px";a._textDiv.setHeight(a._textHeight);a._textDiv.getDomRef().style.height=a._textHeight;});};document.onmouseup=function(){b.forEach(function(a){a._handleViewportStop();var n=a.getDomRef().getBoundingClientRect();var p=a.getWidth()?a.getWidth():n.width/v.width;var q=a.getHeight()?a.getHeight():n.height/v.height;a.getAnnotationNode().scale.set(p,q,1);a.fireSizeChanged({nodeRef:a.getAnnotationNode(),width:p,height:q});});document.onmousemove=null;document.onmouseup=null;};}};k[6].onmousedown=function(l){var o=l||event;if(o.button===0){var m=o.clientX-k[0].offsetLeft;var n=o.clientY-k[0].offsetTop;document.onmousemove=function(l){t._viewport._viewportGestureHandler._gesture=false;var o=l||event;var p=o.clientX-m;var q=o.clientY-n;b.forEach(function(a){a._moving=true;a._textWidth=j.get(a.getAnnotationId()).width-p+"px";a._textHeight=j.get(a.getAnnotationId()).height+q+"px";a._textDiv.setWidth(a._textWidth);a._textDiv.setHeight(a._textHeight);a._textDiv.getDomRef().style.width=a._textWidth;a._textDiv.getDomRef().style.height=a._textHeight;s(p,0,a.getDomRef());});};document.onmouseup=function(){b.forEach(function(a){a._handleViewportStop();var p=a.getDomRef().getBoundingClientRect();var q=a.getWidth()?a.getWidth():p.width/v.width;var r=a.getHeight()?a.getHeight():p.height/v.height;a.getAnnotationNode().scale.set(q,r,1);a.fireSizeChanged({nodeRef:a.getAnnotationNode(),width:q,height:r});});document.onmousemove=null;document.onmouseup=null;};}};k[7].onmousedown=function(l){var o=l||event;if(o.button===0){var m=o.clientX-k[7].offsetLeft;document.onmousemove=function(l){t._viewport._viewportGestureHandler._gesture=false;var o=l||event;var n=o.clientX-m;b.forEach(function(a){a._moving=true;a._textWidth=j.get(a.getAnnotationId()).width-n+"px";a._textDiv.setWidth(a._textWidth);a._textDiv.getDomRef().style.width=a._textWidth;s(n,0,a.getDomRef());});};document.onmouseup=function(){b.forEach(function(a){a._handleViewportStop();var n=a.getDomRef().getBoundingClientRect();var p=a.getWidth()?a.getWidth():n.width/v.width;var q=a.getHeight()?a.getHeight():n.height/v.height;a.getAnnotationNode().scale.set(p,q,1);a.fireSizeChanged({nodeRef:a.getAnnotationNode(),width:p,height:q});});document.onmousemove=null;document.onmouseup=null;};}};};f.prototype._update=function(v){var t=this;this._viewport=v;if(this._shouldRenderVp){v.invalidate();this._shouldRenderVp=false;}var a=this.getDomRef();if(a){var b=a.nextSibling;var i=b.nextSibling;b.style.visibility=this.getVisible()?"visible":"hidden";i.style.visibility=(!this._moving&&this.getVisible())?"visible":"hidden";var m=function(){t._handleViewportMove(t,event);};var j=function(){t._handleViewportTouchMove(t,event,m,j,t._viewport,k);};var k=function(){t._handleViewportStop(t,m,j,t._viewport,k);};if(this.getVisible()){if(this.getWidth()){this.setWidth(this.getWidth());}if(this.getHeight()){this.setHeight(this.getHeight());}if(this.getIsStatic()){a.style.setProperty("--animation-name","annotationStatic");}this.setSelectedState(this.getSelected());var n=this.getNodeRef()?this._getNodeRefScreenCenter(v):{x:0,y:0,depth:0};var l=v.getDomRef().getBoundingClientRect();var o=this._getDelay();if(this.getEditable()){this.setEditableState();}if(this.getPositionType()===c.Relative&&this.getNodeRef()){if(!this._isBlocked){this._updateBlocked(v);}if(this.getStyle()!==A.Fixed){a.style.zIndex=this._getSortIndex(v);a.style.opacity=this._getOpacity();a.style.animationDelay=o+"s";a.style.transform="perspective(1px) scale3d("+a.style.opacity+", "+a.style.opacity+", "+a.style.opacity+")";}b.style.visibility="hidden";switch(this.getStyle()){case A.Default:a.style.transformOrigin="bottom center";a.style.left=(n.x-a.offsetWidth/2)+"px";var p=n.y;a.style.bottom="calc("+(p+(a.offsetHeight*0.25))+"px + 2.5rem)";break;case A.Explode:a.style.transformOrigin="bottom left";var q=(n.x-this._initialOffsetWidth/2);a.style.left="calc("+(q+(this._initialOffsetWidth*0.25))+"px - 3rem)";a.style.bottom="calc("+(n.y+this._initialOffsetHeight*0.25)+"px + 3rem)";break;case A.Square:a.style.transformOrigin="top right";a.style.right="calc("+(l.width-(n.x-this._initialOffsetWidth/2))+"px + 3rem)";a.style.top="calc("+(l.height-n.y)+"px + 3rem)";break;case A.Random:var r=a.childNodes;if(r){var u={leftMargin:"5rem",bottomMargin:"5rem",squareLeft:"-6rem",squareBottom:"-6rem",transformOrigin:"bottom left",connectSquare:r[1]};var w={leftMargin:"-15rem",bottomMargin:"5rem",squareLeft:"15rem",squareBottom:"-6rem",transformOrigin:"bottom right",connectSquare:r[4]};this._position=n.x<l.width/2?w:u;}a.style.setProperty("--square-left",this._position.squareLeft);a.style.setProperty("--square-bottom",this._position.squareBottom);a.style.setProperty("--background-color",this.options?this.options.backgroundColor:"#dddddd");a.style.setProperty("--div-width",this.options&&this.options.width?"calc("+this.options.width+"px - 1rem)":"auto");a.style.setProperty("--div-height",this.options&&this.options.height?"calc("+this.options.height+"px - 1rem)":"auto");a.style.transformOrigin=this._position.transformOrigin;a.style.left="calc("+n.x+"px + "+this._position.leftMargin+")";a.style.bottom="calc("+n.y+"px + "+this._position.bottomMargin+")";if(r[0]&&this._position.connectSquare&&r[2]){this.setLeaderLine(r[0],this._position.connectSquare,r[2]);}if(this._prevText!==this.getTitle()){this.setText(this.getTitle());this._prevText=this.getTitle();}break;case A.Fixed:if(this.getProperty("xCoordinate")||this.getProperty("xCoordinate")===0){this.setXCoordinate(this.getProperty("xCoordinate"));}if(this.getProperty("yCoordinate")||this.getProperty("yCoordinate")===0){this.setYCoordinate(this.getProperty("yCoordinate"));}if(sap.ui.Device.support.touch){this._textDiv.ontouchstart=function(y){if(y.originalEvent.button===0||!y.originalEvent.button){delete t._textDiv.ontouchend;t._moving=true;t._initialX=y.targetTouches[0].clientX;t._initialY=y.targetTouches[0].clientY;v.attachBrowserEvent("touchmove",j);v.attachBrowserEvent("mousemove",m);v.attachBrowserEvent("mouseup",k);}};}else{this._textDiv.onmousedown=function(y){if(y.originalEvent.button===0){t._moving=true;t._initialX=y.clientX;t._initialY=y.clientY;v.attachBrowserEvent("mousemove",m);v.attachBrowserEvent("mouseup",k);}};}break;default:break;}}else{b.style.left="calc("+n.x+"px)";b.style.bottom="calc("+n.y+"px)";switch(this.getStyle()){case A.Default:a.childNodes[0].style.visibility="hidden";a.childNodes[1].style.visibility="hidden";a.childNodes[2].style.visibility="hidden";a.childNodes[3].style.visibility="hidden";a.childNodes[4].style.visibility="hidden";break;case A.Explode:a.childNodes[0].style.visibility="hidden";a.childNodes[1].style.visibility="hidden";a.childNodes[2].style.visibility="hidden";break;case A.Square:a.childNodes[0].style.visibility="hidden";a.childNodes[1].style.visibility="hidden";a.childNodes[2].style.visibility="hidden";break;case A.Random:a.childNodes[0].style.visibility="hidden";a.style.setProperty("--background-color",this.options?this.options.backgroundColor:"#dddddd");a.style.setProperty("--div-width",this.options&&this.options.width?"calc("+this.options.width+"px - 1rem)":"auto");a.style.setProperty("--div-height",this.options&&this.options.height?"calc("+this.options.height+"px - 1rem)":"auto");if(this.options){var x=this._getNodeRefScreenCenter(v,this.options.annotationNode);if(this.options.width&&this.options.height){a.style.left="calc("+(x.x-this.options.width/2)+"px)";a.style.bottom="calc("+(x.y-this.options.height/2)+"px)";}}break;case A.Editing:a.style.left="calc("+(this._previousState.x-l.x)+"px)";a.style.top="calc("+(this._previousState.y-l.y)+"px)";break;default:break;}if(this.getNodeRef()){this.setLeaderLine(b,a,i);}else{b.style.visibility="hidden";}if(this.getProperty("xCoordinate")||this.getProperty("xCoordinate")===0){this.setXCoordinate(this.getProperty("xCoordinate"));}if(this.getProperty("yCoordinate")||this.getProperty("yCoordinate")===0){this.setYCoordinate(this.getProperty("yCoordinate"));}}}}};f.prototype._handleViewportTouchMove=function(a,b,m,t,v,i){if(a._moving){a._textDiv.ontouchend=function(b){a._handleViewportStop(a,m,t,v,i);};a._currentX=b.targetTouches[0].clientX-a._initialX;a._currentY=b.targetTouches[0].clientY-a._initialY;this.fireAnnotationMoving({annotationId:this.getAnnotationId()});}s(a._currentX,a._currentY,a.getDomRef());};f.prototype._handleViewportMove=function(a,b){if(a._moving){a._currentX=b.clientX-a._initialX;a._currentY=b.clientY-a._initialY;}s(a._currentX,a._currentY,a.getDomRef());};f.prototype._handleViewportStop=function(a,m,t,v,b){this._moving=false;var i=this.getDomRef();var j=window.getComputedStyle(i);var k=i.style.transform;i.style.transform="";var x=parseFloat(k.substring(k.indexOf("(")+1,k.indexOf(",")));var y=parseFloat(k.substring(k.indexOf(",")+1,k.indexOf(")")));i.style.left=(parseFloat(j.left)+x)+"px";i.style.top=(parseFloat(j.top)+y)+"px";this._offsetTop=i.offsetTop;this._offsetLeft=i.offsetLeft;this.setXCoordinate(this.getXCoordinate());this.setYCoordinate(this.getYCoordinate());if(x||y){this.getAnnotationNode().position.set(this.getXCoordinate(),this.getYCoordinate(),0);this.firePositionChanged({nodeRef:this.getAnnotationNode(),x:this.getXCoordinate(),y:this.getYCoordinate()});}if(m&&t&&v&&b){v.detachBrowserEvent("touchmove",t);v.detachBrowserEvent("mousemove",m);v.detachBrowserEvent("mouseup",b);}};function s(x,y,a){a.style.transform="translate("+x+"px, "+y+"px)";}f.prototype.setLeaderLine=function(a,t,l){var o=(this.getEditable()&&this._offsetTop)?this._offsetTop:t.offsetTop;var b=(this.getEditable()&&this._offsetLeft)?this._offsetLeft:t.offsetLeft;var T=a.offsetTop+a.offsetHeight/2;var i=o+t.offsetHeight/2;var L=a.offsetLeft+a.offsetWidth/2;var j=b+t.offsetWidth/2;var k=Math.abs(i-T);var m=Math.abs(j-L);var n=Math.sqrt(k*k+m*m);var p=180/Math.PI*Math.acos(k/n);var q,r;if(i>T){q=(i-T)/2+T;}else{q=(T-i)/2+i;}if(j>L){r=(j-L)/2+L;}else{r=(L-j)/2+j;}if((T<i&&L<j)||(i<T&&j<L)||(T>i&&L>j)||(i>T&&j>L)){p*=-1;}q-=n/2;l.style.transform="rotate("+p+"deg)";l.style.top=q+"px";l.style.left=r+"px";l.style.height=n+"px";};f.prototype.getTransform=function(){var a=this.getAnnotationNode();a.updateMatrix();return sap.ui.vk.TransformationMatrix.convertTo4x3(a.matrix.elements);};f.getStyles=function(){var a=[{style:A.Default,src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABACAYAAAGSM0KYAAAACXBIWXMAAAsTAAALEwEAmpwYAAALC2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNi4wLWMwMDIgNzkuMTY0MzUyLCAyMDIwLzAxLzMwLTE1OjUwOjM4ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0RXZ0PSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VFdmVudCMiIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczpwaG90b3Nob3A9Imh0dHA6Ly9ucy5hZG9iZS5jb20vcGhvdG9zaG9wLzEuMC8iIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDIxLjEgKE1hY2ludG9zaCkiIHhtcDpDcmVhdGVEYXRlPSIyMDIwLTAzLTI2VDExOjEwOjAyKzEzOjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDIwLTAzLTI2VDE0OjM1OjIzKzEzOjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAyMC0wMy0yNlQxNDozNToyMysxMzowMCIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MmZhNTI3NDEtOGZkZi00NTM0LWE0N2UtMWRmZWMyOTc3NTliIiB4bXBNTTpEb2N1bWVudElEPSJhZG9iZTpkb2NpZDpwaG90b3Nob3A6MDRkNjFiNzktZDUxMC01MDQwLThjNjYtYjk4ZWIyZWMxOWI0IiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6ZWU1NTEwZjgtNmI2ZC00NDJhLTkwOTMtMzQ4NmNlNDA0ZDU0IiBwaG90b3Nob3A6Q29sb3JNb2RlPSIzIiBwaG90b3Nob3A6SUNDUHJvZmlsZT0ic1JHQiBJRUM2MTk2Ni0yLjEiPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmVlNTUxMGY4LTZiNmQtNDQyYS05MDkzLTM0ODZjZTQwNGQ1NCIgc3RFdnQ6d2hlbj0iMjAyMC0wMy0yNlQxMToxMDowMisxMzowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDIxLjEgKE1hY2ludG9zaCkiLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjEyYTg4Mjg4LWYzOWItNDU4My04M2FlLTk0NTExY2FjZGU5OCIgc3RFdnQ6d2hlbj0iMjAyMC0wMy0yNlQxNDoxNTozMisxMzowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDIxLjEgKE1hY2ludG9zaCkiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjcyOWFhOWVjLTE0ZmItNDdiZS1hNTNhLTAyYzgyOWEyMjlhOCIgc3RFdnQ6d2hlbj0iMjAyMC0wMy0yNlQxNDozNToyMysxMzowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDIxLjEgKE1hY2ludG9zaCkiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNvbnZlcnRlZCIgc3RFdnQ6cGFyYW1ldGVycz0iZnJvbSBhcHBsaWNhdGlvbi92bmQuYWRvYmUucGhvdG9zaG9wIHRvIGltYWdlL3BuZyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iZGVyaXZlZCIgc3RFdnQ6cGFyYW1ldGVycz0iY29udmVydGVkIGZyb20gYXBwbGljYXRpb24vdm5kLmFkb2JlLnBob3Rvc2hvcCB0byBpbWFnZS9wbmciLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjJmYTUyNzQxLThmZGYtNDUzNC1hNDdlLTFkZmVjMjk3NzU5YiIgc3RFdnQ6d2hlbj0iMjAyMC0wMy0yNlQxNDozNToyMysxMzowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDIxLjEgKE1hY2ludG9zaCkiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjcyOWFhOWVjLTE0ZmItNDdiZS1hNTNhLTAyYzgyOWEyMjlhOCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDplZTU1MTBmOC02YjZkLTQ0MmEtOTA5My0zNDg2Y2U0MDRkNTQiIHN0UmVmOm9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDplZTU1MTBmOC02YjZkLTQ0MmEtOTA5My0zNDg2Y2U0MDRkNTQiLz4gPHBob3Rvc2hvcDpUZXh0TGF5ZXJzPiA8cmRmOkJhZz4gPHJkZjpsaSBwaG90b3Nob3A6TGF5ZXJOYW1lPSJURVhUIiBwaG90b3Nob3A6TGF5ZXJUZXh0PSJURVhUIi8+IDxyZGY6bGkgcGhvdG9zaG9wOkxheWVyTmFtZT0iVGV4dCIgcGhvdG9zaG9wOkxheWVyVGV4dD0iVGV4dCIvPiA8cmRmOmxpIHBob3Rvc2hvcDpMYXllck5hbWU9IlRleHQiIHBob3Rvc2hvcDpMYXllclRleHQ9IlRleHQiLz4gPHJkZjpsaSBwaG90b3Nob3A6TGF5ZXJOYW1lPSJUZXh0IiBw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"},{style:A.Explode,src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABACAYAAAGSM0KYAAAACXBIWXMAAAsTAAALEwEAmpwYAAALC2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNi4wLWMwMDIgNzkuMTY0MzUyLCAyMDIwLzAxLzMwLTE1OjUwOjM4ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0RXZ0PSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VFdmVudCMiIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczpwaG90b3Nob3A9Imh0dHA6Ly9ucy5hZG9iZS5jb20vcGhvdG9zaG9wLzEuMC8iIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDIxLjEgKE1hY2ludG9zaCkiIHhtcDpDcmVhdGVEYXRlPSIyMDIwLTAzLTI2VDExOjEwOjAyKzEzOjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDIwLTAzLTI2VDE0OjM0OjQyKzEzOjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAyMC0wMy0yNlQxNDozNDo0MisxMzowMCIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MTkxNWVjMTctNGM5Mi00YzljLWE0MTUtMjA0NDFhMmQwNTFhIiB4bXBNTTpEb2N1bWVudElEPSJhZG9iZTpkb2NpZDpwaG90b3Nob3A6ZDNjNTE2ZDgtOTgxOC1hYzQwLWJiM2EtNmNiYjI5Nzg3NTcwIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6ZWU1NTEwZjgtNmI2ZC00NDJhLTkwOTMtMzQ4NmNlNDA0ZDU0IiBwaG90b3Nob3A6Q29sb3JNb2RlPSIzIiBwaG90b3Nob3A6SUNDUHJvZmlsZT0ic1JHQiBJRUM2MTk2Ni0yLjEiPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmVlNTUxMGY4LTZiNmQtNDQyYS05MDkzLTM0ODZjZTQwNGQ1NCIgc3RFdnQ6d2hlbj0iMjAyMC0wMy0yNlQxMToxMDowMisxMzowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDIxLjEgKE1hY2ludG9zaCkiLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjEyYTg4Mjg4LWYzOWItNDU4My04M2FlLTk0NTExY2FjZGU5OCIgc3RFdnQ6d2hlbj0iMjAyMC0wMy0yNlQxNDoxNTozMisxMzowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDIxLjEgKE1hY2ludG9zaCkiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjYzNzdjM2ExLTQ0OGQtNDVmOC05YmRjLTdlZmZmZjMxM2Y5OCIgc3RFdnQ6d2hlbj0iMjAyMC0wMy0yNlQxNDozNDo0MisxMzowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDIxLjEgKE1hY2ludG9zaCkiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNvbnZlcnRlZCIgc3RFdnQ6cGFyYW1ldGVycz0iZnJvbSBhcHBsaWNhdGlvbi92bmQuYWRvYmUucGhvdG9zaG9wIHRvIGltYWdlL3BuZyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iZGVyaXZlZCIgc3RFdnQ6cGFyYW1ldGVycz0iY29udmVydGVkIGZyb20gYXBwbGljYXRpb24vdm5kLmFkb2JlLnBob3Rvc2hvcCB0byBpbWFnZS9wbmciLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjE5MTVlYzE3LTRjOTItNGM5Yy1hNDE1LTIwNDQxYTJkMDUxYSIgc3RFdnQ6d2hlbj0iMjAyMC0wMy0yNlQxNDozNDo0MisxMzowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDIxLjEgKE1hY2ludG9zaCkiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjYzNzdjM2ExLTQ0OGQtNDVmOC05YmRjLTdlZmZmZjMxM2Y5OCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDplZTU1MTBmOC02YjZkLTQ0MmEtOTA5My0zNDg2Y2U0MDRkNTQiIHN0UmVmOm9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDplZTU1MTBmOC02YjZkLTQ0MmEtOTA5My0zNDg2Y2U0MDRkNTQiLz4gPHBob3Rvc2hvcDpUZXh0TGF5ZXJzPiA8cmRmOkJhZz4gPHJkZjpsaSBwaG90b3Nob3A6TGF5ZXJOYW1lPSJURVhUIiBwaG90b3Nob3A6TGF5ZXJUZXh0PSJURVhUIi8+IDxyZGY6bGkgcGhvdG9zaG9wOkxheWVyTmFtZT0iVGV4dCIgcGhvdG9zaG9wOkxheWVyVGV4dD0iVGV4dCIvPiA8cmRmOmxpIHBob3Rvc2hvcDpMYXllck5hbWU9IlRleHQiIHBob3Rvc2hvcDpMYXllclRleHQ9IlRleHQiLz4gPHJkZjpsaSBwaG90b3Nob3A6TGF5ZXJOYW1lPSJUZXh0IiBw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"},{style:A.Square,src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABACAYAAAGSM0KYAAAACXBIWXMAAAsTAAALEwEAmpwYAAALC2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNi4wLWMwMDIgNzkuMTY0MzUyLCAyMDIwLzAxLzMwLTE1OjUwOjM4ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0RXZ0PSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VFdmVudCMiIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczpwaG90b3Nob3A9Imh0dHA6Ly9ucy5hZG9iZS5jb20vcGhvdG9zaG9wLzEuMC8iIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDIxLjEgKE1hY2ludG9zaCkiIHhtcDpDcmVhdGVEYXRlPSIyMDIwLTAzLTI2VDExOjEwOjAyKzEzOjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDIwLTAzLTI2VDE0OjM1OjA4KzEzOjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAyMC0wMy0yNlQxNDozNTowOCsxMzowMCIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NTk0ZjlmZWYtYzE5MS00Nzc3LWFhZjgtZDEyYTdkNjhmZWJiIiB4bXBNTTpEb2N1bWVudElEPSJhZG9iZTpkb2NpZDpwaG90b3Nob3A6YmUxMTFiMDktOWRjOC03YjQ4LTllYzQtMTBmNDYxNjllZTY5IiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6ZWU1NTEwZjgtNmI2ZC00NDJhLTkwOTMtMzQ4NmNlNDA0ZDU0IiBwaG90b3Nob3A6Q29sb3JNb2RlPSIzIiBwaG90b3Nob3A6SUNDUHJvZmlsZT0ic1JHQiBJRUM2MTk2Ni0yLjEiPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmVlNTUxMGY4LTZiNmQtNDQyYS05MDkzLTM0ODZjZTQwNGQ1NCIgc3RFdnQ6d2hlbj0iMjAyMC0wMy0yNlQxMToxMDowMisxMzowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDIxLjEgKE1hY2ludG9zaCkiLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjEyYTg4Mjg4LWYzOWItNDU4My04M2FlLTk0NTExY2FjZGU5OCIgc3RFdnQ6d2hlbj0iMjAyMC0wMy0yNlQxNDoxNTozMisxMzowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDIxLjEgKE1hY2ludG9zaCkiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmJlMjcwOTQwLWZlNjctNGQyMS04ZTI5LWE5MzIzMzM1YjliZCIgc3RFdnQ6d2hlbj0iMjAyMC0wMy0yNlQxNDozNTowOCsxMzowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDIxLjEgKE1hY2ludG9zaCkiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNvbnZlcnRlZCIgc3RFdnQ6cGFyYW1ldGVycz0iZnJvbSBhcHBsaWNhdGlvbi92bmQuYWRvYmUucGhvdG9zaG9wIHRvIGltYWdlL3BuZyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iZGVyaXZlZCIgc3RFdnQ6cGFyYW1ldGVycz0iY29udmVydGVkIGZyb20gYXBwbGljYXRpb24vdm5kLmFkb2JlLnBob3Rvc2hvcCB0byBpbWFnZS9wbmciLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjU5NGY5ZmVmLWMxOTEtNDc3Ny1hYWY4LWQxMmE3ZDY4ZmViYiIgc3RFdnQ6d2hlbj0iMjAyMC0wMy0yNlQxNDozNTowOCsxMzowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDIxLjEgKE1hY2ludG9zaCkiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOmJlMjcwOTQwLWZlNjctNGQyMS04ZTI5LWE5MzIzMzM1YjliZCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDplZTU1MTBmOC02YjZkLTQ0MmEtOTA5My0zNDg2Y2U0MDRkNTQiIHN0UmVmOm9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDplZTU1MTBmOC02YjZkLTQ0MmEtOTA5My0zNDg2Y2U0MDRkNTQiLz4gPHBob3Rvc2hvcDpUZXh0TGF5ZXJzPiA8cmRmOkJhZz4gPHJkZjpsaSBwaG90b3Nob3A6TGF5ZXJOYW1lPSJURVhUIiBwaG90b3Nob3A6TGF5ZXJUZXh0PSJURVhUIi8+IDxyZGY6bGkgcGhvdG9zaG9wOkxheWVyTmFtZT0iVGV4dCIgcGhvdG9zaG9wOkxheWVyVGV4dD0iVGV4dCIvPiA8cmRmOmxpIHBob3Rvc2hvcDpMYXllck5hbWU9IlRleHQiIHBob3Rvc2hvcDpMYXllclRleHQ9IlRleHQiLz4gPHJkZjpsaSBwaG90b3Nob3A6TGF5ZXJOYW1lPSJUZXh0IiBw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"},{style:A.Random,src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABACAYAAAGSM0KYAAAACXBIWXMAAAsTAAALEwEAmpwYAAALC2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNi4wLWMwMDIgNzkuMTY0MzUyLCAyMDIwLzAxLzMwLTE1OjUwOjM4ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0RXZ0PSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VFdmVudCMiIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczpwaG90b3Nob3A9Imh0dHA6Ly9ucy5hZG9iZS5jb20vcGhvdG9zaG9wLzEuMC8iIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDIxLjEgKE1hY2ludG9zaCkiIHhtcDpDcmVhdGVEYXRlPSIyMDIwLTAzLTI2VDExOjEwOjAyKzEzOjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDIwLTAzLTI2VDE0OjM0OjU0KzEzOjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAyMC0wMy0yNlQxNDozNDo1NCsxMzowMCIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OWZkYTc5MGItNmU4NC00ZWY1LWE0ZjEtODRlYWIwYjA1YmM4IiB4bXBNTTpEb2N1bWVudElEPSJhZG9iZTpkb2NpZDpwaG90b3Nob3A6OGFkNDQ1MGUtN2ZmNS1iZTQyLTlmNTAtOGE0ZDBlYTU4MmFlIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6ZWU1NTEwZjgtNmI2ZC00NDJhLTkwOTMtMzQ4NmNlNDA0ZDU0IiBwaG90b3Nob3A6Q29sb3JNb2RlPSIzIiBwaG90b3Nob3A6SUNDUHJvZmlsZT0ic1JHQiBJRUM2MTk2Ni0yLjEiPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmVlNTUxMGY4LTZiNmQtNDQyYS05MDkzLTM0ODZjZTQwNGQ1NCIgc3RFdnQ6d2hlbj0iMjAyMC0wMy0yNlQxMToxMDowMisxMzowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDIxLjEgKE1hY2ludG9zaCkiLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjEyYTg4Mjg4LWYzOWItNDU4My04M2FlLTk0NTExY2FjZGU5OCIgc3RFdnQ6d2hlbj0iMjAyMC0wMy0yNlQxNDoxNTozMisxMzowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDIxLjEgKE1hY2ludG9zaCkiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmEwMDkzM2E5LTA4NzctNDRlYi04YThmLTZlZDYyZjA1ZDhlZCIgc3RFdnQ6d2hlbj0iMjAyMC0wMy0yNlQxNDozNDo1NCsxMzowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDIxLjEgKE1hY2ludG9zaCkiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNvbnZlcnRlZCIgc3RFdnQ6cGFyYW1ldGVycz0iZnJvbSBhcHBsaWNhdGlvbi92bmQuYWRvYmUucGhvdG9zaG9wIHRvIGltYWdlL3BuZyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iZGVyaXZlZCIgc3RFdnQ6cGFyYW1ldGVycz0iY29udmVydGVkIGZyb20gYXBwbGljYXRpb24vdm5kLmFkb2JlLnBob3Rvc2hvcCB0byBpbWFnZS9wbmciLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjlmZGE3OTBiLTZlODQtNGVmNS1hNGYxLTg0ZWFiMGIwNWJjOCIgc3RFdnQ6d2hlbj0iMjAyMC0wMy0yNlQxNDozNDo1NCsxMzowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDIxLjEgKE1hY2ludG9zaCkiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOmEwMDkzM2E5LTA4NzctNDRlYi04YThmLTZlZDYyZjA1ZDhlZCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDplZTU1MTBmOC02YjZkLTQ0MmEtOTA5My0zNDg2Y2U0MDRkNTQiIHN0UmVmOm9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDplZTU1MTBmOC02YjZkLTQ0MmEtOTA5My0zNDg2Y2U0MDRkNTQiLz4gPHBob3Rvc2hvcDpUZXh0TGF5ZXJzPiA8cmRmOkJhZz4gPHJkZjpsaSBwaG90b3Nob3A6TGF5ZXJOYW1lPSJURVhUIiBwaG90b3Nob3A6TGF5ZXJUZXh0PSJURVhUIi8+IDxyZGY6bGkgcGhvdG9zaG9wOkxheWVyTmFtZT0iVGV4dCIgcGhvdG9zaG9wOkxheWVyVGV4dD0iVGV4dCIvPiA8cmRmOmxpIHBob3Rvc2hvcDpMYXllck5hbWU9IlRleHQiIHBob3Rvc2hvcDpMYXllclRleHQ9IlRleHQiLz4gPHJkZjpsaSBwaG90b3Nob3A6TGF5ZXJOYW1lPSJUZXh0IiBw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"}];return a;};f.createAnnotation=function(a){var t="";if(a.annotation.type&&a.annotation.text){t=a.annotation.text.text?a.annotation.text.text:a.annotation.text.html;}else{t=a.annotation.text;}var l=a.annotation.link?"<span><a href="+a.annotation.link+">"+a.annotation.link+"</a></span>":"";var b=new f({annotationId:a.annotation.nodeId+"",annotationName:a.node.name,annotationType:a.annotation.type,nodeRef:a.targetNode,title:t+"<br>"+l,style:A.Random});b.options={backgroundColor:g(a.annotation),annotationNode:a.node,width:a.annotation.width,height:a.annotation.height};b._viewIds=a.viewIds;b.sourceData=a;return b;};f.createAnnotationNode=function(a,b,o){var n=b.getDefaultNodeHierarchy();var i=a.getNodeRef();var j=a.getAnnotationName()?a.getAnnotationName():"2D Text "+(i?i.parent.name:"");var k=n.createNode(o.parent,j,null,e.Annotation);b.setNodePersistentId(k,a.getAnnotationId());k.userData.nodeId=a.getAnnotationId();if(a.getXCoordinate()&&a.getYCoordinate()){k.position.set(a.getXCoordinate(),a.getYCoordinate(),0);}if(o.viewport){var v=o.viewport.getDomRef().getBoundingClientRect();k.scale.set(100/v.width,40/v.height,1);}b.getViews().forEach(function(l){var m=l.getNodeInfos();var p={target:k,visible:l.id===o.viewid};m.push(p);l.setNodeInfos(m);});return k;};f.removeAnnotationNode=function(a,b){var n=b.getDefaultNodeHierarchy();var i=b.getAnnotations();var j=i.get(a);if(j){var k=j.getAnnotationNode();j.setVisible(false);j.destroy();i.delete(a);n.removeNode(k);return k;}};function g(a){var b="#dddddd";if(a.backgroundColor){b=h(a.backgroundColor);}else if(a.backgroundColour||(a.label&&a.label.colour)){var i=a.backgroundColour||a.label.colour;b="rgba("+i[0]*255+", "+i[1]*255+", "+i[2]*255+", "+i[3]+")";}return b;}function h(a){var b=a.toString(16);if(a.length>=3){b=(((a[0]*255)<<16)|((a[1]*255)<<8)|(a[2]*255)).toString(16);}return"#"+"000000".substring(b.length)+b;}return f;});
