/*!
 * SAPUI5

		(c) Copyright 2009-2020 SAP SE. All rights reserved
	
*/
sap.ui.define(['sap/ui/model/FilterOperator','sap/ui/model/Filter','sap/ui/model/ValidateException','sap/base/Log','sap/base/util/merge','./Operator','./RangeOperator','sap/ui/mdc/util/BaseType','sap/ui/core/date/UniversalDateUtils'],function(M,F,V,L,m,O,R,B,U){"use strict";var a=function(){};a._mOperators={strictEqual:new O({name:"EEQ",showInSuggest:false,filterOperator:M.EQ,tokenParse:"^==([\\s\\S]*)$",tokenFormat:"$1 ($0)",valueTypes:[O.ValueType.Self,null],longText:"EEQ",displayFormats:{DescriptionValue:"$1 ($0)",ValueDescription:"$0 ($1)",Description:"$1",Value:"$0"},format:function(c,t,d){d=d||"DescriptionValue";var C=this.valueTypes.length;var T=this.displayFormats[d];var v=c.values;if(!v[1]){T=this.displayFormats["Value"];C=1;}for(var i=0;i<C;i++){var r,b=v[i];if(b===null||b===undefined){b="";}if(i==0&&t&&(typeof t.formatValue==="function")){r=t.formatValue(b,"string");}else{r=b;}T=r==null?null:T.replace(new RegExp("\\$"+i,"g"),r);}return T;},parse:function(t,T,d,D){d=d||"DescriptionValue";return O.prototype.parse.apply(this,[t,T,d,D]);},getValues:function(t,d,D){var b=t.match(this.tokenParseRegExp);var v;if(b||(D&&t)){var s;var T=this.displayFormats[d];var k=T.indexOf("$0");var i=T.indexOf("$1");var K;var c;if(b){s=b[1];}else if(D){s=t;}if(k>=0&&i>=0){if(s.lastIndexOf("(")>0&&(s.lastIndexOf(")")===s.length-1||s.lastIndexOf(")")===-1)){var e=s.length;if(s[e-1]===")"){e--;}var f=s.substring(0,s.lastIndexOf("("));if(f[f.length-1]===" "){f=f.substring(0,f.length-1);}var g=s.substring(s.lastIndexOf("(")+1,e);if(k<i){K=f;c=g;}else{K=g;c=f;}}else if(k<i){K=s;}else{c=s;}}else if(k>=0){K=s;}else{c=s;}v=[K,c];}return v;},isEmpty:function(c,t){var i=false;var v=c.values[0];if((v===null||v===undefined||v==="")&&!c.values[1]){i=true;}return i;},getCheckValue:function(c){return{value:c.values[0]};},checkInput:true}),equal:new O({name:"EQ",filterOperator:M.EQ,tokenParse:"^=([^=]*)$",tokenFormat:"=$0",valueTypes:[O.ValueType.Self]}),between:new O({name:"BT",filterOperator:M.BT,tokenParse:"^([^!].*)\\.\\.\\.(.+)$",tokenFormat:"$0...$1",valueTypes:[O.ValueType.Self,O.ValueType.Self],validate:function(v,t){if(v.length<2){throw new V("Between must have two values");}if(v[0]===v[1]){throw new V("Between must have two different values");}O.prototype.validate.apply(this,[v,t]);}}),betweenExclBoundaries:new O({name:"BTEX",filterOperator:M.BT,tokenParse:"^([^!].*)\\.\\.(.+)$",tokenFormat:"$0..$1",valueTypes:[O.ValueType.Self,O.ValueType.Self],getModelFilter:function(c,f,t){return new F({filters:[new F(f,M.GT,c.values[0]),new F(f,M.LT,c.values[1])],and:true});},validate:function(v,t){if(v.length<2){throw new V("Between must have two values");}if(v[0]===v[1]){throw new V("Between must have two different values");}O.prototype.validate.apply(this,[v,t]);}}),notBetween:new O({name:"NOTBT",filterOperator:M.NB,tokenParse:"^!(.+)\\.\\.\\.(.+)$",tokenFormat:"!($0...$1)",valueTypes:[O.ValueType.Self,O.ValueType.Self],exclude:true,validate:function(v,t){if(v.length<2){throw new V("NotBetween must have two values");}if(v[0]===v[1]){throw new V("NotBetween must have two different values");}O.prototype.validate.apply(this,[v,t]);}}),notBetweenExclBoundaries:new O({name:"NOTBTEX",filterOperator:M.NB,tokenParse:"^!(.+)\\.\\.(.+)$",tokenFormat:"!($0..$1)",valueTypes:[O.ValueType.Self,O.ValueType.Self],exclude:true,getModelFilter:function(c,f,t){return new F({filters:[new F(f,M.LE,c.values[0]),new F(f,M.GE,c.values[1])],and:false});},validate:function(v,t){if(v.length<2){throw new V("NotBetween must have two values");}if(v[0]===v[1]){throw new V("NotBetween must have two different values");}O.prototype.validate.apply(this,[v,t]);}}),lowerThan:new O({name:"LT",filterOperator:M.LT,tokenParse:"^<([^=].*)$",tokenFormat:"<$0",valueTypes:[O.ValueType.Self]}),notLowerThan:new O({name:"NOTLT",filterOperator:M.GE,tokenParse:"^!<([^=].*)$",tokenFormat:"!(<$0)",valueTypes:[O.ValueType.Self],exclude:true}),greaterThan:new O({name:"GT",filterOperator:M.GT,tokenParse:"^>([^=].*)$",tokenFormat:">$0",valueTypes:[O.ValueType.Self]}),notGreaterThan:new O({name:"NOTGT",filterOperator:M.LE,tokenParse:"^!>([^=].*)$",tokenFormat:"!(>$0)",valueTypes:[O.ValueType.Self],exclude:true}),lessEqual:new O({name:"LE",filterOperator:M.LE,tokenParse:"^<=(.+)$",tokenFormat:"<=$0",valueTypes:[O.ValueType.Self]}),notLessEqual:new O({name:"NOTLE",filterOperator:M.GT,tokenParse:"^!<=(.+)$",tokenFormat:"!(<=$0)",valueTypes:[O.ValueType.Self],exclude:true}),greaterEqual:new O({name:"GE",filterOperator:M.GE,tokenParse:"^>=(.+)$",tokenFormat:">=$0",valueTypes:[O.ValueType.Self]}),notGreaterEqual:new O({name:"NOTGE",filterOperator:M.LT,tokenParse:"^!>=(.+)$",tokenFormat:"!(>=$0)",valueTypes:[O.ValueType.Self],exclude:true}),startsWith:new O({name:"StartsWith",filterOperator:M.StartsWith,tokenParse:"^([^!\\*]+.*)\\*$",tokenFormat:"$0*",valueTypes:[O.ValueType.Self]}),notStartsWith:new O({name:"NotStartsWith",filterOperator:M.NotStartsWith,tokenParse:"^!([^\\*].*)\\*$",tokenFormat:"!($0*)",valueTypes:[O.ValueType.Self],exclude:true}),endsWith:new O({name:"EndsWith",filterOperator:M.EndsWith,tokenParse:"^\\*(.*[^\\*])$",tokenFormat:"*$0",valueTypes:[O.ValueType.Self]}),notEndsWith:new O({name:"NotEndsWith",filterOperator:M.NotEndsWith,tokenParse:"^!\\*(.*[^\\*])$",tokenFormat:"!(*$0)",valueTypes:[O.ValueType.Self],exclude:true}),contains:new O({name:"Contains",filterOperator:M.Contains,tokenParse:"^\\*(.*)\\*$",tokenFormat:"*$0*",valueTypes:[O.ValueType.Self]}),notContains:new O({name:"NotContains",filterOperator:M.NotContains,tokenParse:"^!\\*(.*)\\*$",tokenFormat:"!(*$0*)",valueTypes:[O.ValueType.Self],exclude:true}),notEqual:new O({name:"NE",filterOperator:M.NE,tokenParse:"^!=(.+)$",tokenFormat:"!(=$0)",valueTypes:[O.ValueType.Self],exclude:true}),empty:new O({name:"Empty",filterOperator:M.EQ,tokenParse:"^<#tokenText#>$",tokenFormat:"<#tokenText#>",valueTypes:[],getModelFilter:function(c,f,t){var o=a.getOperator(c.operator);return new F({path:f,operator:o.filterOperator,value1:""});}}),notEmpty:new O({name:"NotEmpty",filterOperator:M.NE,tokenParse:"^!<#tokenText#>$",tokenFormat:"!(<#tokenText#>)",valueTypes:[],exclude:true,getModelFilter:function(c,f,t){var o=a.getOperator(c.operator);return new F({path:f,operator:o.filterOperator,value1:""});}}),yesterday:new R({name:"YESTERDAY",valueTypes:[O.ValueType.Static],calcRange:function(){return U.ranges.yesterday();},formatRange:function(r,d){return d.formatValue(r[0],"string");}}),today:new R({name:"TODAY",valueTypes:[O.ValueType.Static],calcRange:function(){return U.ranges.today();},formatRange:function(r,d){return d.formatValue(r[0],"string");}}),tomorrow:new R({name:"TOMORROW",valueTypes:[O.ValueType.Static],calcRange:function(){return U.ranges.tomorrow();},formatRange:function(r,d){return d.formatValue(r[0],"string");}}),lastDays:new R({name:"LASTDAYS",valueTypes:[{name:"sap.ui.model.type.Integer",formatOptions:{emptyString:null}}],paramTypes:["(\\d+)"],additionalInfo:"",calcRange:function(d){return U.ranges.lastDays(d);}}),nextDays:new R({name:"NEXTDAYS",valueTypes:[{name:"sap.ui.model.type.Integer",formatOptions:{emptyString:null}}],paramTypes:["(\\d+)"],additionalInfo:"",calcRange:function(d){return U.ranges.nextDays(d);}}),lastWeek:new R({name:"LASTWEEK",valueTypes:[O.ValueType.Static],calcRange:function(){return U.ranges.lastWeek();}}),currentWeek:new R({name:"CURRENTWEEK",valueTypes:[O.ValueType.Static],calcRange:function(){return U.ranges.currentWeek();}}),nextWeek:new R({name:"NEXTWEEK",valueTypes:[O.ValueType.Static],calcRange:function(){return U.ranges.nextWeek();}}),lastWeeks:new R({name:"LASTWEEKS",valueTypes:[{name:"sap.ui.model.type.Integer",formatOptions:{emptyString:null}}],paramTypes:["(\\d+)"],additionalInfo:"",calcRange:function(d){return U.ranges.lastWeeks(d);}}),nextWeeks:new R({name:"NEXTWEEKS",valueTypes:[{name:"sap.ui.model.type.Integer",formatOptions:{emptyString:null}}],paramTypes:["(\\d+)"],additionalInfo:"",calcRange:function(d){return U.ranges.nextWeeks(d);}}),lastMonth:new R({name:"LASTMONTH",valueTypes:[O.ValueType.Static],calcRange:function(){return U.ranges.lastMonth();}}),currentMonth:new R({name:"CURRENTMONTH",valueTypes:[O.ValueType.Static],calcRange:function(){return U.ranges.currentMonth();}}),nextMonth:new R({name:"NEXTMONTH",valueTypes:[O.ValueType.Static],calcRange:function(){return U.ranges.nextMonth();}}),lastMonths:new R({name:"LASTMONTHS",valueTypes:[{name:"sap.ui.model.type.Integer",formatOptions:{emptyString:null}}],paramTypes:["(\\d+)"],additionalInfo:"",calcRange:function(d){return U.ranges.lastMonths(d);}}),nextMonths:new R({name:"NEXTMONTHS",valueTypes:[{name:"sap.ui.model.type.Integer",formatOptions:{emptyString:null}}],paramTypes:["(\\d+)"],additionalInfo:"",calcRange:function(d){return U.ranges.nextMonths(d);}}),lastQuarter:new R({name:"LASTQUARTER",valueTypes:[O.ValueType.Static],calcRange:function(){return U.ranges.lastQuarter();}}),currentQuarter:new R({name:"CURRENTQUARTER",valueTypes:[O.ValueType.Static],calcRange:function(){return U.ranges.currentQuarter();}}),nextQuarter:new R({name:"NEXTQUARTER",valueTypes:[O.ValueType.Static],calcRange:function(){return U.ranges.nextQuarter();}}),lastQuarters:new R({name:"LASTQUARTERS",valueTypes:[{name:"sap.ui.model.type.Integer",formatOptions:{emptyString:null}}],paramTypes:["(\\d+)"],additionalInfo:"",calcRange:function(d){return U.ranges.lastQuarters(d);}}),nextQuarters:new R({name:"NEXTQUARTERS",valueTypes:[{name:"sap.ui.model.type.Integer",formatOptions:{emptyString:null}}],paramTypes:["(\\d+)"],additionalInfo:"",calcRange:function(d){return U.ranges.nextQuarters(d);}}),firstQuarter:new R({name:"FIRSTQUARTER",valueTypes:[O.ValueType.Static],calcRange:function(){return U.ranges.quarter(1);}}),secondQuarter:new R({name:"SECONDQUARTER",valueTypes:[O.ValueType.Static],calcRange:function(){return U.ranges.quarter(2);}}),thirdQuarter:new R({name:"THIRDQUARTER",valueTypes:[O.ValueType.Static],calcRange:function(){return U.ranges.quarter(3);}}),fourthQuarter:new R({name:"FOURTHQUARTER",valueTypes:[O.ValueType.Static],calcRange:function(){return U.ranges.quarter(4);}}),lastYear:new R({name:"LASTYEAR",valueTypes:[O.ValueType.Static],calcRange:function(){return U.ranges.lastYear();}}),currentYear:new R({name:"CURRENTYEAR",valueTypes:[O.ValueType.Static],calcRange:function(){return U.ranges.currentYear();}}),nextYear:new R({name:"NEXTYEAR",valueTypes:[O.ValueType.Static],calcRange:function(){return U.ranges.nextYear();}}),lastYears:new R({name:"LASTYEARS",valueTypes:[{name:"sap.ui.model.type.Integer",formatOptions:{emptyString:null}}],paramTypes:["(\\d+)"],additionalInfo:"",calcRange:function(d){return U.ranges.lastYears(d);}}),nextYears:new R({name:"NEXTYEARS",valueTypes:[{name:"sap.ui.model.type.Integer",formatOptions:{emptyString:null}}],paramTypes:["(\\d+)"],additionalInfo:"",calcRange:function(d){return U.ranges.nextYears(d);}}),yearToDate:new R({name:"YEARTODATE",valueTypes:[O.ValueType.Static],calcRange:function(){return U.ranges.yearToDate();}})};a._mDefaultOpsForType={};a.addOperator=function(o){a._mOperators[o.name]=o;};a.setOperatorsForType=function(t,o,d){a._mDefaultOpsForType[t]={operators:o};if(d){a._mDefaultOpsForType[t].defaultOperator=d;}};a.setOperatorsForType(B.String,[a._mOperators.strictEqual,a._mOperators.contains,a._mOperators.equal,a._mOperators.between,a._mOperators.startsWith,a._mOperators.endsWith,a._mOperators.empty,a._mOperators.lessEqual,a._mOperators.lowerThan,a._mOperators.greaterEqual,a._mOperators.greaterThan,a._mOperators.notContains,a._mOperators.notEqual,a._mOperators.notBetween,a._mOperators.notStartsWith,a._mOperators.notEndsWith,a._mOperators.notEmpty,a._mOperators.notLessEqual,a._mOperators.notLowerThan,a._mOperators.notGreaterEqual,a._mOperators.notGreaterThan],a._mOperators.equal);a.setOperatorsForType(B.Date,[a._mOperators.strictEqual,a._mOperators.equal,a._mOperators.between,a._mOperators.lessEqual,a._mOperators.lowerThan,a._mOperators.greaterEqual,a._mOperators.greaterThan,a._mOperators.notEqual,a._mOperators.notBetween,a._mOperators.notLessEqual,a._mOperators.notLowerThan,a._mOperators.notGreaterEqual,a._mOperators.notGreaterThan,a._mOperators.lastDays,a._mOperators.yesterday,a._mOperators.today,a._mOperators.tomorrow,a._mOperators.nextDays,a._mOperators.lastWeeks,a._mOperators.lastWeek,a._mOperators.currentWeek,a._mOperators.nextWeek,a._mOperators.nextWeeks,a._mOperators.lastMonths,a._mOperators.lastMonth,a._mOperators.currentMonth,a._mOperators.nextMonth,a._mOperators.nextMonths,a._mOperators.lastQuarters,a._mOperators.lastQuarter,a._mOperators.currentQuarter,a._mOperators.nextQuarter,a._mOperators.nextQuarters,a._mOperators.firstQuarter,a._mOperators.secondQuarter,a._mOperators.thirdQuarter,a._mOperators.fourthQuarter,a._mOperators.lastYears,a._mOperators.lastYear,a._mOperators.currentYear,a._mOperators.nextYear,a._mOperators.nextYears,a._mOperators.yearToDate]);a.setOperatorsForType(B.DateTime,[a._mOperators.strictEqual,a._mOperators.equal,a._mOperators.between,a._mOperators.lessEqual,a._mOperators.lowerThan,a._mOperators.greaterEqual,a._mOperators.greaterThan,a._mOperators.notEqual,a._mOperators.notBetween,a._mOperators.notLessEqual,a._mOperators.notLowerThan,a._mOperators.notGreaterEqual,a._mOperators.notGreaterThan]);a.setOperatorsForType(B.Numeric,[a._mOperators.strictEqual,a._mOperators.equal,a._mOperators.between,a._mOperators.lessEqual,a._mOperators.lowerThan,a._mOperators.greaterEqual,a._mOperators.greaterThan,a._mOperators.notEqual,a._mOperators.notBetween,a._mOperators.notLessEqual,a._mOperators.notLowerThan,a._mOperators.notGreaterEqual,a._mOperators.notGreaterThan]);a.setOperatorsForType(B.Time,[a._mOperators.strictEqual,a._mOperators.equal,a._mOperators.between,a._mOperators.lessEqual,a._mOperators.lowerThan,a._mOperators.greaterEqual,a._mOperators.greaterThan,a._mOperators.notEqual,a._mOperators.notBetween,a._mOperators.notLessEqual,a._mOperators.notLowerThan,a._mOperators.notGreaterEqual,a._mOperators.notGreaterThan]);a.setOperatorsForType(B.Boolean,[a._mOperators.equal,a._mOperators.strictEqual,a._mOperators.notEqual]);a.getOperatorsForType=function(t){var o=[];for(var i=0;i<a._mDefaultOpsForType[t].operators.length;i++){o.push(a._mDefaultOpsForType[t].operators[i].name);}return o;};a.getDefaultOperator=function(t){return a._mDefaultOpsForType[t].defaultOperator||a._mOperators.equal;};a.getMatchingOperators=function(o,v){var b=[];for(var i=0;i<o.length;i++){var c=this.getOperator(o[i]);if(c){b.push(c);}}return _.call(this,b,v);};function _(o,v){var r=[];for(var i=0;i<o.length;i++){var b=o[i];if(b&&b.test&&b.test(v)){r.push(b);}}return r;}a.getOperator=function(o){for(var n in a._mOperators){var b=a._mOperators[n];if(b.name===o){return b;}}if(o==="EEQ"){return a._mOperators.equal;}if(o==="EQ"){return a._mOperators.strictEqual;}L.error("Operator "+o+" not in supported operators.","FilterOperatorUtil");return undefined;};a.getEEQOperator=function(){return a._mOperators.strictEqual;};a.onlyEEQ=function(o){if(o.length===1&&o[0]==="EEQ"){return true;}else{return false;}};a.checkConditionsEmpty=function(c){if(!Array.isArray(c)){c=[c];}c.forEach(function(C){var o=this.getOperator(C.operator);if(o){C.isEmpty=o.isEmpty(C);}}.bind(this));};a.updateConditionsValues=function(c){if(!Array.isArray(c)){c=[c];}for(var i=0;i<c.length;i++){this.updateConditionValues(c[i]);}};a.updateConditionValues=function(c){var o=this.getOperator(c.operator);if(o&&c.operator!=="EEQ"){if(o.valueTypes[0]==="static"){c.values=[];}else{while(c.values.length!=o.valueTypes.length){if(c.values.length<o.valueTypes.length){c.values.push(null);}if(c.values.length>o.valueTypes.length){c.values=c.values.slice(0,c.values.length-1);}}}}};a.indexOfCondition=function(c,C){var I=-1;for(var i=0;i<C.length;i++){if(this.compareConditions(c,C[i])){I=i;break;}}return I;};a.compareConditions=function(c,C){var e=false;if(c.operator===C.operator){var o=this.getOperator(c.operator);e=o.compareConditions(c,C);}return e;};a.compareConditionsArray=function(c,C){var e=false;if(c.length===C.length){e=true;for(var i=0;i<c.length;i++){if(!this.compareConditions(c[i],C[i])){e=false;break;}}}return e;};return a;},true);
