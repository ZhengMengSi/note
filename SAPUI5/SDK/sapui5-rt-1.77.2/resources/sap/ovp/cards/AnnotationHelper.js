sap.ui.define(["sap/ui/thirdparty/jquery","sap/ui/core/format/NumberFormat","sap/ui/core/format/DateFormat","sap/ovp/cards/CommonUtils","sap/ui/model/odata/AnnotationHelper","sap/ui/model/FilterOperator","sap/ui/Device","sap/ui/model/analytics/odata4analytics","sap/ui/generic/app/navigation/service/SelectionVariant","sap/ovp/app/resources","sap/base/strings/formatMessage","sap/base/Log","sap/base/util/isPlainObject","sap/base/util/each"],function(q,N,D,C,O,F,a,o,S,b,f,L,c,e){"use strict";var d={count:0};var g={};var h={};var l={};var m={StateValues:{None:"None",Negative:"Error",Critical:"Warning",Positive:"Success"},ColorValues:{None:"Neutral",Negative:"Error",Critical:"Critical",Positive:"Good"}};var A={TEXT:"com.sap.vocabularies.Common.v1.Text",TEXT_ARRANGEMENT:"com.sap.vocabularies.UI.v1.TextArrangement"};var T={TEXT_LAST:"com.sap.vocabularies.UI.v1.TextArrangementType/TextLast",TEXT_FIRST:"com.sap.vocabularies.UI.v1.TextArrangementType/TextFirst",TEXT_ONLY:"com.sap.vocabularies.UI.v1.TextArrangementType/TextOnly",TEXT_SEPARATE:"com.sap.vocabularies.UI.v1.TextArrangementType/TextSeparate"};var I={"List_condensed":{phone:5,tablet:5,desktop:5},"List_extended":{phone:3,tablet:3,desktop:3},"List_condensed_bar":{phone:5,tablet:5,desktop:5},"List_extended_bar":{phone:3,tablet:3,desktop:3},"Table":{phone:5,tablet:5,desktop:5},"Stack_simple":{phone:20,tablet:20,desktop:20},"Stack_complex":{phone:5,tablet:5,desktop:5}};function n(i,j){var k=i.getSetting('ovpCardProperties');var f3=k.getProperty('/showLabelText');if(f3==="true"){var g3=j.Address[0];if(typeof g3.country!=="undefined"){return"{path:'"+g3.country.Path+"'}";}else if(typeof g3.locality!=="undefined"){return"{path:'"+g3.locality.Path+"'}";}else if(typeof g3.street!=="undefined"){return"{path:'"+g3.street.Path+"'}";}else if(typeof g3.code!=="undefined"){return"{path:'"+g3.code.Path+"'}";}}else{return null;}}n.requiresIContext=true;function p(i,j){if(!j){return"";}if(j.Label){return j.Label.String;}var k=i.getSetting&&i.getSetting('ovpCardProperties');var f3=k&&k.getProperty("/metaModel");var g3=k&&k.getProperty("/entityType");if(!f3||!g3){return"";}var h3;if(j.Value){h3=j.Value.Path;}if(j.Target){var i3=J(g3.$path,j);var j3=i3&&f3.getProperty(i3);h3=j3&&j3.Value.Path;}if(!h3||!h3.length>0||h3===" "){return"";}var k3=f3.getODataProperty(g3,h3);if(!k3){return"";}var l3=k3["sap:label"]||(k3["com.sap.vocabularies.Common.v1.Label"]||"").String||"";return l3;}p.requiresIContext=true;function r(i,k){if(i.getSetting){var j=i.getSetting("_ovpCache");if(j){return j[k];}}return undefined;}function s(i,k,j){if(i.getSetting){var f3=i.getSetting("_ovpCache");if(f3){f3[k]=j;}}}function t(i,j){if(!d[j]){d[j]=0;}d[j]++;var k=j+d[j];d[k]=i;return"sap.ovp.cards.AnnotationHelper.formatFunctions."+k;}function u(i,j){var k;if(j){k=j.None;if(i&&i.EnumMember){var f3=i.EnumMember;if(w(f3,'Negative')){k=j.Negative;}else if(w(f3,'Critical')){k=j.Critical;}else if(w(f3,'Positive')){k=j.Positive;}}}return k;}function v(i){if(i=="Error"){i=1;}else if(i=="Warning"){i=2;}else if(i=="Success"){i=3;}else{i=0;}return i;}function w(i,j){return i&&i.indexOf(j,i.length-j.length)!==-1;}function x(i,j,k,f3,g3,h3,i3){var j3={};j3.EnumMember="None";var k3=Number.NEGATIVE_INFINITY;var l3=Number.POSITIVE_INFINITY;if((!g3&&g3!==0)&&(k||k===0)){g3=k;}if((!h3&&h3!==0)&&(f3||f3===0)){h3=f3;}if(!k&&k!==0){k=k3;}if(!f3&&f3!==0){f3=l3;}if(i!==undefined){i=Number(i);if(w(j,"Minimize")||w(j,"Minimizing")){if((h3||h3===0)&&(f3||f3===0)){if(i<=parseFloat(h3)){j3.EnumMember="Positive";}else if(i>parseFloat(f3)){j3.EnumMember="Negative";}else{j3.EnumMember="Critical";}}}else if(w(j,"Maximize")||w(j,"Maximizing")){if((g3||g3===0)&&(k||k===0)){if(i>=parseFloat(g3)){j3.EnumMember="Positive";}else if(i<parseFloat(k)){j3.EnumMember="Negative";}else{j3.EnumMember="Critical";}}}else if(w(j,"Target")){if((h3||h3===0)&&(f3||f3===0)&&(g3||g3===0)&&(k||k===0)){if(i>=parseFloat(g3)&&i<=parseFloat(h3)){j3.EnumMember="Positive";}else if(i<parseFloat(k)||i>parseFloat(f3)){j3.EnumMember="Negative";}else{j3.EnumMember="Critical";}}}}return u(j3,i3);}function y(i,j,k,f3){if(!i||!j){return;}i=Number(i);if(!f3&&(i-j>=0)){return"Up";}if(!k&&(i-j<=0)){return"Down";}if(j&&f3&&(i-j>=f3)){return"Up";}if(j&&k&&(i-j<=k)){return"Down";}}function z(i,j){var k=i.getPath(0)+"-DataFields-Sorted";var f3=r(i,k);if(!f3){var g3=B(i,j);var h3=g3.map(function(i3){return i3.Value.Path;});h3=h3.filter(function(i3){return!!i3;});f3=j.filter(function(i3){if(i3.RecordType==="com.sap.vocabularies.UI.v1.DataField"&&h3.indexOf(i3.Value.Path)===-1){return true;}return false;});f3=M(f3);s(i,k,f3);}return f3;}z.requiresIContext=true;function B(j,k,f3){var g3=j.getPath(0)+"-DataPoints-Sorted";var h3=r(j,g3);if(!h3){if(f3){h3=k.filter(G);}else{h3=k.filter(E);}h3=M(h3);var i3;for(var i=0;i<h3.length;i++){i3=j.getPath(0).substr(0,j.getPath(0).lastIndexOf("/")+1);h3[i]=j.getModel(0).getProperty(J(i3,h3[i]));i3="";}s(j,g3,h3);}return h3;}B.requiresIContext=true;function E(i){if(i.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&i.Target.AnnotationPath.match(/@com.sap.vocabularies.UI.v1.DataPoint.*/)){return true;}return false;}function G(i){if((i.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&i.Target.AnnotationPath.match(/@com.sap.vocabularies.UI.v1.DataPoint.*/))||(i.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&i.Target.AnnotationPath.match(/@com.sap.vocabularies.Communication.v1.Contact.*/))){return true;}return false;}function H(i){if(!i||!i.Criticality||!i.Criticality.Path){return;}return"{path:'"+i.Criticality.Path+"'}";}function J(i,j){if(i&&!w(i,'/')){i+='/';}return i+j.Target.AnnotationPath.slice(1);}function K(i){var j,k;if(i["com.sap.vocabularies.UI.v1.Importance"]){j=i["com.sap.vocabularies.UI.v1.Importance"].EnumMember;switch(j){case"com.sap.vocabularies.UI.v1.ImportanceType/High":k=1;break;case"com.sap.vocabularies.UI.v1.ImportanceType/Medium":k=2;break;case"com.sap.vocabularies.UI.v1.ImportanceType/Low":k=3;break;}}else{k=4;}return k;}function M(i){if(i.length<2){return i;}var j=parseInt(i.length/2,10);var k=i.slice(0,j);var f3=i.slice(j,i.length);return P(M(k),M(f3));}function P(i,j){var k=[];while(i.length&&j.length){var f3=K(i[0]),g3=K(j[0]);if(f3<=g3){k.push(i.shift());}else{k.push(j.shift());}}while(i.length){k.push(i.shift());}while(j.length){k.push(j.shift());}return k;}function Q(i,j,k){var f3=z(i,j)[k];if(f3){return Z(i,f3);}return"";}function R(i,j,k){var f3=z(i,j)[k];return p(i,f3);}function U(i,j,k){var f3=B(i,j)[k];if(f3&&f3.Title){return f3.Title.String;}return"";}function V(i,j,k){var f3=j.filter(E);f3=M(f3);if(!f3||!f3.length||!f3.length>0){return"";}return p(i,f3[0]);}function W(i,j,k,f3){var g3=B(i,j)[k];if(!g3){return"";}var h3=i.getSetting('ovpCardProperties');var i3=h3.getProperty("/entityType");var j3=h3.getProperty("/metaModel");return _(i,g3,i3,j3,f3);}function X(i,j,k){var f3=B(i,j)[k];if(f3&&f3.Criticality){return true;}}function Y(i,j,k){var f3=B(i,j)[k];var g3=f3.Criticality.Path;return"{path:'"+g3+"'}";}function _(i,j,k,f3,g3){if(!j||!j.Value){return"";}var h3=i.getSetting('ovpCardProperties');var i3=false;if(h3){var j3=h3.getProperty("/ignoreSapText");i3=j3==undefined?i3:j3;}var k3=f3.getODataProperty(k,j.Value.Path);var l3=false;if(i3==true){if(k3&&(k3["com.sap.vocabularies.Analytics.v1.Measure"]||k3["sap:aggregation-role"]=="measure")){l3=true;}}if(!l3&&k3){var m3;if(k3["com.sap.vocabularies.Common.v1.Text"]){m3=k3["com.sap.vocabularies.Common.v1.Text"].String?k3["com.sap.vocabularies.Common.v1.Text"].String:k3["com.sap.vocabularies.Common.v1.Text"].Path;}else if(k3["sap:text"]){m3=k3["sap:text"];}if(m3){k3=f3.getODataProperty(k,m3);j={Value:{Path:k3.name}};}}return Z(i,j,g3);}function Z(i,j,k,f3){if(j.Value.Apply){return O.format(i,j.Value);}var g3=i.getSetting('ovpCardProperties');var h3=g3.getProperty("/entityType");var i3=g3.getProperty("/metaModel");return a1(i,j,h3,i3,k,f3);}Z.requiresIContext=true;function $(i,j,k,f3){if((!k)||(typeof f3!=='string')){return f3;}var g3=k[A.TEXT];if(!g3){return f3;}var h3,i3;h3=k[A.TEXT_ARRANGEMENT];i3=h3&&h3.EnumMember;if(!i3){h3=g3&&g3[A.TEXT_ARRANGEMENT];i3=h3&&h3.EnumMember;}if(!i3){h3=j&&j[A.TEXT_ARRANGEMENT];i3=h3&&h3.EnumMember;}if(!i3){return f3;}var j3=O.format(i,g3);if(!j3||j3===" "){return f3;}var k3;switch(i3){case T.TEXT_FIRST:k3=j3+" ("+f3+")";break;case T.TEXT_LAST:k3=f3+" ("+j3+")";break;case T.TEXT_ONLY:k3=j3;break;case T.TEXT_SEPARATE:k3=f3+" ("+j3+")";break;default:k3=f3;break;}return k3;}function a1(j,k,f3,g3,h3,i3,j3){if(k.Value.Apply){return O.format(j,k.Value);}var k3=k.Value.Path?k.Value.Path:k.Value.String;var l3=g3.getODataProperty(f3,k3),m3="",n3;var o3=j.getSetting("ovpCardProperties");var p3=o3&&o3.getProperty("/contentFragment");if(!i3){if(k.Value.Path&&k.Value.Path.split("/").length>1){l3=h1(g3,f3,k.Value.Path);}if(!l3){return"";}if(l3["type"]==='Edm.DateTime'||l3["type"]==='Edm.DateTimeOffset'){var q3=o3&&o3.getProperty("/showDateInRelativeFormat");n3=e1("dateFormatFunction",q3,l3["type"]==='Edm.DateTime'?true:false);m3=b1([k.Value.Path?k.Value.Path:l3.name],n3);}else if((k.ValueFormat&&k.ValueFormat.NumberOfFractionalDigits)||l3["scale"]){var r3=(k.ValueFormat&&k.ValueFormat.NumberOfFractionalDigits)?k.ValueFormat.NumberOfFractionalDigits.Int:0,s3;var t3=(k.ValueFormat&&k.ValueFormat.ScaleFactor&&k.ValueFormat.ScaleFactor.Decimal);if(l3["Org.OData.Measures.V1.ISOCurrency"]){s3=l3["Org.OData.Measures.V1.ISOCurrency"].Path?l3["Org.OData.Measures.V1.ISOCurrency"].Path:l3["Org.OData.Measures.V1.ISOCurrency"].String;}else if(l3["Org.OData.Measures.V1.Unit"]){s3=l3["Org.OData.Measures.V1.Unit"].Path?l3["Org.OData.Measures.V1.Unit"].Path:l3["Org.OData.Measures.V1.Unit"].String;}else if(l3["sap:unit"]){s3=l3["sap:unit"];}var u3=s3?g3.getODataProperty(f3,s3):null,v3=[k.Value.Path?k.Value.Path:l3.name];if(r3>2){r3=2;}if(l3["Org.OData.Measures.V1.ISOCurrency"]){var w3=l3["Org.OData.Measures.V1.ISOCurrency"];if(w3.Path){n3=f1(r3,t3);v3.push(w3.Path);}else if(w3.String){n3=f1(r3,t3,w3.String);}}else if(u3&&(u3["Org.OData.Measures.V1.ISOCurrency"]||u3["sap:semantics"]==="currency-code")){n3=f1(r3,t3);v3.push(s3);}else{n3=c1(r3,t3);}m3=b1(v3,n3);}else{if(j3){m3=O.simplePath(j,k.Value);}else{var x3=O.format(j.getModel()?j:j.getInterface(0),k.Value);var y3=x3.split(",");var z3=[];if(y3.length>1){for(var i=0;i<y3.length;i++){if(y3[i].indexOf("path:")>=0||y3[i].indexOf("type:")>=0){z3.push(y3[i]);}}if(z3.length>0){m3=m3+z3.join(',');if(m3.substring(m3.length-1)!=="}"){m3=m3+"}";}}}else{m3=x3;}}}if(p3){m3=$(j,f3,l3,m3);}if(l3["Org.OData.Measures.V1.Unit"]){var A3=l3["Org.OData.Measures.V1.Unit"];if(A3.Path){m3+=(" "+b1([A3.Path]));}else if(A3.String){if(A3.String!=="%"){m3+=" ";}m3+=A3.String;}}}if(!h3){if(l3["Org.OData.Measures.V1.ISOCurrency"]){var w3=l3["Org.OData.Measures.V1.ISOCurrency"];if(w3.Path){m3+=(" "+b1([w3.Path]));}else if(w3.String){m3+=(" "+w3.String);}}}if(m3[0]===" "){m3=m3.substring(1);}return m3;}function b1(j,k){var f3="",g3=j.length;if(g3>1){f3="{parts:[";for(var i=0;i<g3;i++){f3+=("{path: '"+j[i]+"'}"+((i===g3-1)?"]":", "));}}else{f3="{path: '"+j[0]+"'";}f3+=(k?(", formatter: '"+k+"'"):"")+"}";return f3;}function c1(i,j){var k="formatNumberCalculation_"+(j?i+"_"+j:i);if(!g[k]){g[k]=d1(Number(i),j);}return"sap.ovp.cards.AnnotationHelper.NumberFormatFunctions."+k;}function d1(i,j){return function(k){var f3=N.getFloatInstance({style:'short',showMeasure:false,shortRefNumber:j,minFractionDigits:i,maxFractionDigits:i});return f3.format(Number(k));};}function e1(i,j,k){var f3={'relative':true,'relativeScale':'auto'};if(j!==undefined&&!j){f3={'style':'medium'};}if(!h[i]){h[i]=function(g3){var h3=D.getInstance(f3);if(!g3){g3="";return g3;}return h3.format(new Date(g3),k);};}return"sap.ovp.cards.AnnotationHelper.DateFormatFunctions."+i;}function f1(i,j,k){var f3=j?i+"_"+j:i;var g3="formatCurrencyCalculation_"+(k?k+"_"+f3:f3);if(!l[g3]){l[g3]=g1(i,j,k);}return"sap.ovp.cards.AnnotationHelper.CurrencyFormatFunctions."+g3;}function g1(i,j,k){return function(f3,g3){var h3="";var i3=N.getCurrencyInstance({style:'short',showMeasure:false,shortRefNumber:j,minFractionDigits:i,maxFractionDigits:i});if(g3){h3=i3.format(f3,g3);}else{h3=k?i3.format(f3,k):i3.format(f3);}return h3;};}function h1(j,k,f3){var g3=f3.split("/");if(g3.length>1){for(var i=0;i<(g3.length-1);i++){var h3=j.getODataAssociationEnd(k,g3[i]);if(h3){k=j.getODataEntityType(h3.type);}}return j.getODataProperty(k,g3[g3.length-1]);}}function i1(i,j,k){var f3=B(i,j);var g3=m.StateValues;var h3=f3[k];if(!h3){return g3.None;}if(h3.Criticality){return m1(i,h3,g3);}return o1(i,h3,g3);}function j1(i,j,k){var f3=B(i,j);if(f3&&f3.length){var g3=f3[0];if(g3&&(g3.Criticality||g3.CriticalityCalculation)){return true;}}return false;}function k1(i,j,k){if(j1(i,j,k)){return'';}return'#5cbae6';}k1.requiresIContext=true;function l1(i,j,k){var f3=B(i,j),g3=m.ColorValues;var h3=g3.None;if(f3.length>k){var i3=f3[k];if(i3&&i3.Criticality){h3=m1(i,i3,g3);}else{h3=o1(i,i3,g3);}}return h3;}function m1(i,j,k){var f3=k.None;var g3;var h3=j.Criticality;if(h3){g3="'{'= ({0} === ''com.sap.vocabularies.UI.v1.CriticalityType/Negative'') || ({0} === ''1'') || ({0} === 1) ? ''"+k.Negative+"'' : "+"({0} === ''com.sap.vocabularies.UI.v1.CriticalityType/Critical'') || ({0} === ''2'') || ({0} === 2) ? ''"+k.Critical+"'' : "+"({0} === ''com.sap.vocabularies.UI.v1.CriticalityType/Positive'') || ({0} === ''3'') || ({0} === 3) ? ''"+k.Positive+"'' : "+"''"+k.None+"'' '}'";if(h3.Path){var i3='$'+O.simplePath(i,h3);f3=f(g3,i3);}else if(h3.EnumMember){var j3="'"+h3.EnumMember+"'";f3=f(g3,j3);}else{L.warning("Case not supported, returning the default Neutral state");}}else{L.warning("Case not supported, returning the default Neutral state");}return f3;}function n1(i,j,k){var f3=B(i,j);var g3="None";if(f3.length>k){var h3=f3[k];if(h3&&h3.Criticality&&h3.Criticality.Path){g3=Y(i,j,k);}else{g3=o1(i,h3,m.StateValues);g3=v(g3);}}return g3;}function o1(i,j,k){var f3=k.None;if(j.Criticality){f3=u(j.Criticality,k);}else if(j.CriticalityCalculation&&j.Value&&j.Value&&j.Value.Path){f3=p1(i,j,k);}return f3;}function p1(i,j,k){var f3=G1(j.Value);var g3=j.CriticalityCalculation.ImprovementDirection.EnumMember;var h3=G1(j.CriticalityCalculation.DeviationRangeLowValue);var i3=G1(j.CriticalityCalculation.DeviationRangeHighValue);var j3=G1(j.CriticalityCalculation.ToleranceRangeLowValue);var k3=G1(j.CriticalityCalculation.ToleranceRangeHighValue);var l3=q1(h3);var m3=q1(i3);var n3=q1(j3);var o3=q1(k3);var p3="parts: ["+f3;p3+=l3?","+h3:"";p3+=m3?","+i3:"";p3+=n3?","+j3:"";p3+=o3?","+k3:"";p3+="]";var q3=function(){var s3=1;return x(arguments[0],g3,l3?arguments[s3++]:h3,m3?arguments[s3++]:i3,n3?arguments[s3++]:j3,o3?arguments[s3++]:k3,k);};var r3=t(q3,"formatCriticalityCalculation");return"{"+p3+", formatter: '"+r3+"'}";}function q1(i){return(typeof i==="string")&&i.charAt(0)==="{";}function r1(j,k,f3){var g3="";var h3=f3.split("/");if(h3.length>1){for(var i=0;i<(h3.length-1);i++){var i3=j.getODataAssociationEnd(k,h3[i]);if(i3){k=j.getODataEntityType(i3.type);if(g3){g3=g3+"/";}g3=g3+h3[i];}else{return g3;}}}return g3;}function s1(i){var j;if(i&&typeof i.getData==='function'){var k=i.getData();if(k.tabs){var f3=0;var g3=k.selectedKey;if(g3&&k.tabs.length>=g3){f3=g3-1;}j=k.tabs[f3].mFilterPreference;}else{j=k.mFilterPreference;}}return!!j;}function t1(j,k){var f3=j.getSetting('ovpCardProperties');var g3=f3.getProperty("/addODataSelect");var h3=f3.getProperty("/metaModel");var i3=h3.getODataEntityType(k.entityType);var j3=i3[f3.getProperty('/selectionAnnotationPath')];var k3=i3[f3.getProperty('/presentationAnnotationPath')];var l3="/"+k.name;var m3=Array.prototype.slice.call(arguments,2);var n3=j.getSetting('ovpCardProperties'),o3=n3.getProperty('/parameters');if(j3||!!o3){if((j3&&j3.Parameters&&j3.Parameters.length>0)||!!o3){l3=A2(j.getSetting('dataModel'),k,j3,o3);}}if(f3.getProperty("/cardLayout")&&f3.getProperty("/cardLayout/noOfItems")){var p3="{path: '"+l3+"', length: "+ +(f3.getProperty("/cardLayout/noOfItems"));}else{var p3="{path: '"+l3+"', length: "+H1(f3);}var q3=[];if(g3){q3=v1(j,h3,i3,m3);var r3=f3.getProperty("/template");if(r3!="sap.ovp.cards.charts.analytical"&&r3!="sap.ovp.cards.charts.smart.chart"){var s3=y1(k3);for(var i=0;i<s3.length;i++){if(q3.indexOf(s3[i])===-1){q3.push(s3[i]);}}}}var t3=u1(h3,i3,m3);var u3=s1(f3);if(u3||q3.length>0||t3.length>0){p3=p3+", parameters: {";}if(q3.length>0||t3.length>0){if(q3.length>0){p3=p3+"select: '"+q3.join(',')+"'";}if(t3.length>0){if(q3.length>0){p3=p3+", ";}p3=p3+"expand: '"+t3.join(',')+"'";}if(u3){p3=p3+", ";}}if(u3){p3=p3+"custom: {cardId: '"+f3.getProperty("/cardId")+"'}";}if(u3||q3.length>0||t3.length>0){p3=p3+"}";}var v3=x1(f3,k3);if(v3.length>0){p3=p3+", sorter:"+JSON.stringify(v3);}var w3=C1(f3,j3);if(w3.length>0){p3=p3+", filters:"+JSON.stringify(w3);}p3=p3+"}";return p3;}t1.requiresIContext=true;function u1(k,f3,g3){var h3=[];var i3,j3,k3,l3;for(var i=0;i<g3.length;i++){if(!g3[i]){continue;}i3=f3.$path+"/"+g3[i];j3=k.createBindingContext(i3);k3=j3.getObject();k3=k3?k3:[];for(var j=0;j<k3.length;j++){if(k3[j].Value&&k3[j].Value.Path){l3=r1(k,f3,k3[j].Value.Path);if(l3&&h3.indexOf(l3)===-1){h3.push(l3);}}}}return h3;}function v1(f3,g3,h3,i3){var j3=[];var k3,l3,m3;for(var i=0;i<i3.length;i++){if(!i3[i]){continue;}k3=h3.$path+"/"+i3[i];l3=g3.createBindingContext(k3);var n3={};if(f3&&f3.bDummyContext){q.extend(n3,f3,l3,true);}else{n3=f3;}m3=l3.getObject();if(!m3){m3=[];}else if(c(m3)){if(m3.Data){m3=m3.Data;}else{m3=[];}}var o3;var p3;var q3;var r3;for(var j=0;j<m3.length;j++){p3=[];o3=m3[j];q3="";r3=o3.RecordType;if(r3==="com.sap.vocabularies.UI.v1.DataField"){q3=a1(n3,o3,h3,g3,undefined,undefined,true);}else if(r3==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"){var s3=J(h3.$path,o3);q3=_(n3,g3.getProperty(s3),h3,g3);var t3=H(g3.getProperty(s3));if(t3&&t3.length>0){q3+=t3;}}else if(r3==="com.sap.vocabularies.UI.v1.DataFieldWithUrl"&&o3.Url){var u3;if(!o3.Url.UrlRef){u3=O.format(n3,o3.Url);}if(u3&&u3.substring(0,2)==="{="){q3=u3;}}if(q3){var v3=O.simplePath(n3,o3.Value);if(q3.indexOf("(")<0&&q3!==v3){q3=[].concat(v3,q3).join(" ");}p3=w1(q3);}if(p3&&p3.length>0){var w3;for(var k=0;k<p3.length;k++){w3=p3[k];if(!j3[w3]){j3[w3]=true;var x3=C.getUnitColumn(w3,h3);if(x3&&x3!==w3){j3[x3]=true;}var y3=_2(g3,h3,w3);if(y3&&y3!==w3){j3[y3]=true;}}}}}}return Object.keys(j3);}function w1(j){var i,k=0,f3=j.length,g3="",h3;for(i=0;i<f3;i++){h3=j.charAt(i);if(!h3){return;}switch(h3){case"{":k++;break;case"}":k--;break;default:if(k<=0){continue;}break;}g3+=h3;}j=g3;var i3=/\${([a-zA-Z0-9\_|\/]*)/g;var j3=/[^[{]*[a-zA-Z0-9\_]/g;var k3=/path *\: *\'([a-zA-Z0-9\_]+)*\'/g;var l3,m3,n3=[];if(j.indexOf("{parts:[")!==-1){j=j.replace("{parts:[","");}if(j.substring(0,2)==="{="){l3=i3;m3=1;}else if(j.indexOf("path")!==-1){var o3=j3.exec(j);while(o3){if(o3[0].indexOf("path")===-1&&o3[0].indexOf("@i18n")!==0){n3.push(o3[0]);}o3=j3.exec(j);}l3=k3;m3=1;}else{l3=j3;m3=0;}var p3=l3.exec(j);while(p3){if(p3[m3]&&p3[m3].indexOf("@i18n")!==0){n3.push(p3[m3]);}p3=l3.exec(j);}return n3;}function x1(j,k){var f3=[];var g3,h3;var i3=j.getProperty("/sortBy");if(i3){var j3=j.getProperty('/sortOrder');if(j3&&j3.toLowerCase()!=='descending'){h3=false;}else{h3=true;}g3={path:i3,descending:h3};f3.push(g3);}var k3=k&&k.SortOrder||undefined;var l3,i3;if(k3){for(var i=0;i<k3.length;i++){l3=k3[i];i3=l3.Property.PropertyPath;h3=D1(l3.Descending,true);g3={path:i3,descending:h3};f3.push(g3);}}return f3;}function y1(j){var k=[];var f3=j&&j.RequestAtLeast||undefined;if(f3){for(var i=0;i<f3.length;i++){if(f3[i].PropertyPath){k.push(f3[i].PropertyPath);}}}return k;}function z1(i){var j=i.getProperty('/entityType');var k=j[i.getProperty('/selectionAnnotationPath')];return{filters:C1(i,k),parameters:B1(k)};}function A1(j){if(!j){return;}var k=j.getProperty('/entityType');var f3=k[j.getProperty('/presentationAnnotationPath')];var g3=x1(j,f3);var h3=[];var i,i3=g3.length;for(i=0;i<i3;i++){if(!g3[i].path){continue;}h3.push({Property:g3[i].path,Descending:g3[i].descending});}if(h3.length>0){return{SortOrder:h3};}}function B1(j){var k,f3=[];if(!j||!j.Parameters){return f3;}var g3=j.Parameters.length;for(var i=0;i<g3;i++){k=j.Parameters[i];if(!k.PropertyName||!k.PropertyName.PropertyPath){continue;}if(!k.PropertyValue){L.error("Missing value for parameter "+k.PropertyName.PropertyPath);continue;}f3[f3.length]={path:k.PropertyName.PropertyPath,value:F1(k.PropertyValue)};}return f3;}function C1(k,f3){var g3=[];var h3;var i3=k.getProperty("/filters");if(i3){g3=g3.concat(i3);}if(f3&&f3.SelectOptions){h3=f3.SelectOptions;}else{h3=f3;}var j3,k3,l3;if(h3){for(var i=0;i<h3.length;i++){j3=h3[i];k3=j3.PropertyName.PropertyPath;for(var j=0;j<j3.Ranges.length;j++){l3=j3.Ranges[j];if(l3.Sign.EnumMember){var m3={path:k3,operator:l3.Option.EnumMember.split("/")[1],value1:F1(l3.Low),value2:F1(l3.High),sign:l3.Sign.EnumMember==="com.sap.vocabularies.UI.v1.SelectionRangeSignType/I"?"I":"E"};if(m3.sign==="E"&&m3.operator!==F.EQ){L.error("Exclude sign is supported only with EQ operator");continue;}if(m3.sign==="E"&&m3.operator===F.EQ){m3.operator=F.NE;m3.sign="I";}if(m3.operator==="CP"&&m3.sign==="I"){var n3=F.Contains;var o3=m3.value1;if(o3){var p3=o3.indexOf('*');var q3=o3.lastIndexOf('*');if(p3>-1){if((p3===0)&&(q3!==(o3.length-1))){n3=F.EndsWith;o3=o3.substring(1,o3.length);}else if((p3!==0)&&(q3===(o3.length-1))){n3=F.StartsWith;o3=o3.substring(0,o3.length-1);}else{o3=o3.substring(1,o3.length-1);}}}m3.operator=n3;m3.value1=o3;}g3.push(m3);}}}}return g3;}function D1(i,j){if(i&&i.Boolean){if(i.Boolean.toLowerCase()==="true"){return true;}else if(i.Boolean.toLowerCase()==="false"){return false;}}else if(i&&i.Bool){if(i.Bool.toLowerCase()==="true"){return true;}else if(i.Bool.toLowerCase()==="false"){return false;}}return j;}function E1(i){var j;if(i){if(i.String){j=Number(i.String);}else if(i.Int){j=Number(i.Int);}else if(i.Decimal){j=Number(i.Decimal);}else if(i.Double){j=Number(i.Double);}else if(i.Single){j=Number(i.Single);}}return j;}function F1(i){var j;if(i){if(i.String||i.String===""){j=i.String;}else if(i.Boolean||i.Bool){j=D1(i);}else if(i.DateTime){j=i.DateTime;}else if(i.DateTimeOffset){j=i.DateTimeOffset;}else{j=E1(i);}}return j;}function G1(i){if(i){if(i.Path){return"{path:'"+i.Path+"'}";}else{return F1(i);}}else{return"";}}function H1(i){var j=i.getProperty('/contentFragment');var k=i.getProperty('/listType');var f3=i.getProperty('/listFlavor');var g3;var h3="desktop";if(a.system.phone){h3="phone";}else if(a.system.tablet){h3="tablet";}if(j=="sap.ovp.cards.list.List"){if(k=="extended"){if(f3=="bar"){g3=I["List_extended_bar"];}else{g3=I["List_extended"];}}else if(f3=="bar"){g3=I["List_condensed_bar"];}else{g3=I["List_condensed"];}}else if(j=="sap.ovp.cards.table.Table"){g3=I["Table"];}else if(j=="sap.ovp.cards.stack.Stack"){if(i.getProperty('/objectStreamCardsNavigationProperty')){g3=I["Stack_complex"];}else{g3=I["Stack_simple"];}}if(g3){return g3[h3];}return 5;}function I1(i){var j=i.getObject();var k=B(i,j,true);var f3=k.map(function(g3){if(g3&&g3.Value&&g3.Value.Path){return g3.Value.Path;}else if(g3&&g3.fn&&g3.fn.Path){return g3.fn.Path;}});j.filter(function(g3,h3){if(g3.RecordType==="com.sap.vocabularies.UI.v1.DataField"&&f3.indexOf(g3.Value.Path)>-1){j.splice(h3,1);}});}I1.requiresIContext=true;function J1(i,j){if(j.charAt(0)==='/'||j.indexOf("http")===0){return j;}var k=i.getModel(0).getProperty("/baseUrl");if(k){return k+"/"+j;}return j;}J1.requiresIContext=true;function K1(i,j){var k=B(i,j);return k.length;}K1.requiresIContext=true;function L1(i,j){return N1(i,j,0);}L1.requiresIContext=true;function M1(i,j){return N1(i,j,1);}M1.requiresIContext=true;function N1(i,j,k){var f3=B(i,j),g3=f3[k];if(g3&&g3.Value&&g3.Value.Path){return g3.Value.Path;}return"";}function O1(i,j){return R(i,j,0);}O1.requiresIContext=true;function P1(i,j){return R(i,j,1);}P1.requiresIContext=true;function Q1(i,j){return R(i,j,2);}Q1.requiresIContext=true;function R1(i,j){return R(i,j,3);}R1.requiresIContext=true;function S1(i,j){return R(i,j,4);}S1.requiresIContext=true;function T1(i,j,k){return Q(i,j,k);}T1.requiresIContext=true;function U1(i,j,k){return W(i,j,k);}U1.requiresIContext=true;function V1(i,j,k,f3){var g3=K1(i,j);if(g3>0){return U1(i,j,k);}else{return T1(i,j,f3);}}V1.requiresIContext=true;function W1(i,j,k){return p2(i,j,k);}W1.requiresIContext=true;function X1(i,j){return U(i,j,0);}X1.requiresIContext=true;function Y1(i,j){return U(i,j,1);}Y1.requiresIContext=true;function Z1(i,j){return U(i,j,2);}Z1.requiresIContext=true;function $1(i,j){return V(i,j,0);}$1.requiresIContext=true;function _1(j,k){for(var i=0;i<k.length;i++){var f3=k[i];if(f3.RecordType==="com.sap.vocabularies.UI.v1.DataField"){if(f3.IconUrl&&f3.IconUrl.String){return f3.IconUrl.String;}if(f3.IconUrl&&f3.IconUrl.Path){return O.simplePath(j,f3.IconUrl);}}}}_1.requiresIContext=true;function a2(i,j,k){var f3="";var g3;if(Array.isArray(j)){g3=B(i,j)[k];}else{var h3=q.extend({},j);var i3=q.extend({},i);g3=n2(i3,h3);}if(!g3||!g3.Value){return f3;}var j3=i.getSetting('ovpCardProperties');var k3=j3&&j3.getProperty("/entityType");var l3=j3&&j3.getProperty("/metaModel");var m3=l3&&l3.getODataProperty(k3,g3.Value.Path);var n3=m3&&m3["Org.OData.Measures.V1.ISOCurrency"];if(n3&&n3.Path){f3+=(" "+b1([n3.Path]));}else if(n3&&n3.String){f3+=(" "+n3.String);}return f3;}a2.requiresIContext=true;function b2(i,j,k,f3){return W(i,j,k,f3);}b2.requiresIContext=true;function c2(i,j){return i1(i,j,0);}c2.requiresIContext=true;function d2(i,j){return l1(i,j,0);}d2.requiresIContext=true;function e2(i,j){return i1(i,j,1);}e2.requiresIContext=true;function f2(i,j){return i1(i,j,2);}f2.requiresIContext=true;function g2(i,j){return n1(i,j,0);}g2.requiresIContext=true;function h2(i){var j={};j.EnumMember="None";if(Number(i)===1){j.EnumMember="Negative";}else if(Number(i)===2){j.EnumMember="Critical";}else if(Number(i)===3){j.EnumMember="Positive";}return u(j,m.ColorValues);}function i2(i,j){if(j&&j.Criticality&&j.Criticality.Path){return"{parts: [{path:'"+j.Criticality.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.kpiValueCriticality'}";}else{return o1(i,j,m.ColorValues);}}i2.requiresIContext=true;function j2(i,j){return X(i,j,0);}j2.requiresIContext=true;function k2(i,j){var k=B(i,j)[0];if(k&&(k.Criticality||k.CriticalityCalculation)){return true;}return false;}k2.requiresIContext=true;function l2(i,j){return X(i,j,1);}l2.requiresIContext=true;function m2(i,j){return X(i,j,2);}m2.requiresIContext=true;function n2(i,j){var k=i.getPath(0);var f3=k.slice(0,k.lastIndexOf("/"));f3=f3.slice(0,f3.lastIndexOf("/"));var g3=J(f3,j);j=i.getModel(0).getProperty(g3);return j;}function o2(i,j){if(!j){return"";}return Z(i,j);}o2.requiresIContext=true;function p2(j,k,f3,g3){var h3;var i3=g3==undefined?f3:z(j,f3)[g3];var j3=j.getSetting('ovpCardProperties');var k3=j3.getProperty("/metaModel");var l3=k3.getODataEntityType(k.entityType);var m3=l3.property;if(m3){for(var i=0;i<m3.length;i++){if(i3.Value.Path===m3[i].name){h3=m3[i]["com.sap.vocabularies.Common.v1.SemanticObject"];if(h3){return O.format(j,h3);}else{return"";}}}}}function q2(i,j,k){var f3=k===undefined?j.Value.Path:j[k].Value.Path;var g3=(f3.indexOf("/")!=-1)?f3.split('/')[0]:"";return g3;}q2.requiresIContext=true;function r2(i,j){var k=i.getSetting('ovpCardProperties');var f3=k.getProperty("/metaModel");var g3=f3.getODataEntityType(j.entityType);if(g3["com.sap.vocabularies.Communication.v1.Contact"]){return true;}return false;}r2.requiresIContext=true;function s2(i,j,k){if(!j){return"";}var f3=i.getSetting('ovpCardProperties');var g3=f3.getProperty("/entityType");var h3=f3.getProperty("/metaModel");var i3=q.extend({},j);var j3=q.extend({},i);j=n2(j3,i3);return _(i,j,g3,h3,k);}s2.requiresIContext=true;function t2(i,j){var k=q.extend({},j);var f3=q.extend({},i);var g3="None",h3=m.StateValues;j=n2(f3,k);if(j&&j.Criticality){g3=m1(i,j,h3);}else{g3=o1(i,j,h3);}return g3;}t2.requiresIContext=true;function u2(i,j){var k=q.extend({},j);var f3=q.extend({},i);j=n2(f3,k);if(j&&j.Criticality){return true;}}u2.requiresIContext=true;function v2(i,j){var k=q.extend({},j);var f3=q.extend({},i);var g3=i.getSetting('ovpCardProperties');var h3=g3.getProperty("/entityType");var i3=g3.getProperty("/metaModel");j=n2(f3,k);if(!j){return;}var j3=i3.getODataProperty(h3,j.Value.Path);if(j&&j3&&j3.type=="Edm.String"&&(j.Criticality||j.CriticalityCalculation)){return'Center';}if(j3&&((j3.type=="Edm.DateTime")||(j3.type=="Edm.DateTimeOffset"))){return'Right';}}v2.requiresIContext=true;function w2(i,j){var k=q.extend({},j);var f3=q.extend({},i);j=n2(f3,k);var g3="None";if(j&&j.Criticality&&j.Criticality.Path){g3="{path:'"+j.Criticality.Path+"'}";}else{g3=o1(i,j,m.StateValues);g3=v(g3);}return g3;}w2.requiresIContext=true;function x2(j,k){var f3;for(var i=0;i<k.length;i++){f3=k[i];if(f3.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"||f3.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAction"||f3.RecordType==="com.sap.vocabularies.UI.v1.DataFieldWithUrl"){return 1;}}return 0;}x2.requiresIContext=true;function y2(i,j){var k=B(i,j)[0];if(k&&k.Value&&k.Value.Path){var f3=i.getPath(0).substr(0,i.getPath(0).lastIndexOf("/")+1);var g3=i.getModel(0);var h3=g3.getProperty(f3);var i3=g3.getODataProperty(h3,k.Value.Path);if(i3&&i3["Org.OData.Measures.V1.Unit"]){return i3["Org.OData.Measures.V1.Unit"].String==="%";}}return false;}y2.requiresIContext=true;function z2(i){var j=i.getObject();var k=i.getModel();var f3=k.getProperty("/metaModel");var g3=f3.getODataEntitySet(k.getProperty("/entitySet"));var h3=f3.getODataEntityType(g3.entityType);j=h3.$path+"/"+j;return f3.createBindingContext(j);}function A2(j,k,f3,g3,h3){var i3="";var j3=new o.Model(o.Model.ReferenceByModel(j));var k3=j3.findQueryResultByName(k.name);if(!k3){i3="/"+k.name;return i3;}var l3=new o.QueryResultRequest(k3);var m3=k3.getParameterization();if(!m3){i3="/"+k.name;return i3;}if(h3){var n3=h3.getAnalyticalParameters();}if(m3){var o3;l3.setParameterizationRequest(new o.ParameterizationRequest(m3));if(f3&&f3.Parameters){e(f3.Parameters,function(){if(this.RecordType==="com.sap.vocabularies.UI.v1.IntervalParameter"){o3=this.PropertyNameFrom.PropertyPath.split("/");l3.getParameterizationRequest().setParameterValue(o3[o3.length-1],this.PropertyValueFrom.String,this.PropertyValueTo.String);}else{o3=this.PropertyName.PropertyPath.split("/");l3.getParameterizationRequest().setParameterValue(o3[o3.length-1],this.PropertyValue.String);}});}else if(g3){e(g3,function(){l3.getParameterizationRequest().setParameterValue(this.path,this.value);});}else if(n3&&n3.length>0){var p3=h3&&h3.getUiState({allFilters:false});var q3=p3?JSON.stringify(p3.getSelectionVariant()):"{}";var f3=new S(q3);for(var r3 in m3.getAllParameters()){for(var i=0;i<n3.length;i++){if(n3[i]&&(n3[i].name==r3)){var s3=n3[i].name;var t3=f3.getParameter(s3);if(!t3){var u3=f3.getSelectOption(s3);t3=u3&&u3[0]&&u3[0].Low;}l3.getParameterizationRequest().setParameterValue(r3,t3);}}}}else{i3="/"+k.name;L.error("SelectionParameters","There are no parameters to resolve");return i3;}}try{i3=l3.getURIToQueryResultEntitySet();}catch(v3){k3=l3.getQueryResult();i3="/"+k3.getEntitySet().getQName();L.error("getEntitySetPathWithParameters","binding path with parameters failed - "+v3||v3.message);}return i3;}function B2(j,k,ns){var f3=j.getServiceMetadata().dataServices.schema[0].association;for(var i=0;i<f3.length;i++){if(ns+"."+f3[i].name===k){return f3[i];}}}function C2(i,j){var k=i.filter(function(g3){if(g3.RecordType==="com.sap.vocabularies.UI.v1.DataField"){return true;}return false;});var f3=M(k);if(f3){return f3[j];}return;}function D2(i,j,k){if(!k||!k.length||k.length===0){return false;}k=C2(k,0);return p2(i,j,k);}D2.requiresIContext=true;function E2(i,j,k){if(!k||!k.length||k.length===0){return false;}k=C2(k,1);return p2(i,j,k);}E2.requiresIContext=true;function F2(i,j){var k=i.filter(function(g3){if(g3.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&g3.Target.AnnotationPath.indexOf("@com.sap.vocabularies.Communication.v1.Contact")!==-1){return true;}return false;});var f3=M(k);if(f3){return f3[j];}return;}function G2(i){if(!i||!i.length||i.length===0){return false;}var j=F2(i,0);if(j){return true;}return false;}function H2(i,j,k,f3){var g3,h3,i3;if(k&&k.Value&&k.Value.Path){g3=k.Value.Path;}else if(k&&k.Description&&k.Description.Value&&k.Description.Value.Path){g3=k.Description.Value.Path;}if(k&&k.Description&&k.Description.Path){h3=k.Description.Path;}else if(k&&k.Title&&k.Title.Path){i3=k.Title.Path;}var j3="";var k3=f3&&f3.Parameters;var l3="";var m3=i.getSetting('ovpCardProperties'),n3=m3.getProperty('/parameters');k3=k3||!!n3;if(k3){var o3=i.getSetting("dataModel");var p3=A2(o3,j,f3,n3);j3+="{path: '"+p3+"'";}else{j3+="{path: '/"+j.name+"'";}j3+=", length: 1";var q3=i.getSetting('ovpCardProperties');var r3=q3.getProperty("/entityType");var s3=C.getUnitColumn(g3,r3);var t3=C1(q3,f3);if(t3.length>0){l3+=", filters: "+JSON.stringify(t3);}var u3=[];u3.push(g3);if(h3){u3.push(h3);}else if(i3){u3.push(i3);}if(k&&k.Criticality&&k.Criticality.Path){u3.push(k.Criticality.Path);}if(k&&k.CriticalityCalculation&&k.CriticalityCalculation.DeviationRangeLowValue&&k.CriticalityCalculation.DeviationRangeLowValue.Path){u3.push(k.CriticalityCalculation.DeviationRangeLowValue.Path);}if(k&&k.CriticalityCalculation&&k.CriticalityCalculation.ToleranceRangeLowValue&&k.CriticalityCalculation.ToleranceRangeLowValue.Path){u3.push(k.CriticalityCalculation.ToleranceRangeLowValue.Path);}if(k&&k.CriticalityCalculation&&k.CriticalityCalculation.DeviationRangeHighValue&&k.CriticalityCalculation.DeviationRangeHighValue.Path){u3.push(k.CriticalityCalculation.DeviationRangeHighValue.Path);}if(k&&k.CriticalityCalculation&&k.CriticalityCalculation.ToleranceRangeHighValue&&k.CriticalityCalculation.ToleranceRangeHighValue.Path){u3.push(k.CriticalityCalculation.ToleranceRangeHighValue.Path);}if(s3){u3.push(s3);}if(k&&k.TrendCalculation&&k.TrendCalculation.ReferenceValue&&k.TrendCalculation.ReferenceValue.Path){u3.push(k.TrendCalculation.ReferenceValue.Path);}var v3=s1(m3);var w3=v3?", custom: {cardId: '"+m3.getProperty("/cardId")+"'}":"";return j3+", parameters:{select:'"+u3.join(",")+"'"+w3+"}"+l3+"}";}H2.requiresIContext=true;function I2(k){if(isNaN(k)){return k;}var i,j,f3=false;if(this.oPropagatedProperties.oModels.ovpCardProperties.oData.NumberOfFractionalDigits){i=Number(this.oPropagatedProperties.oModels.ovpCardProperties.oData.NumberOfFractionalDigits);}if(this.oPropagatedProperties.oModels.ovpCardProperties.oData.percentageAvailable){f3=true;}if(!i||i<0){i=0;}else if(i>2){i=2;}j=k;if(k){var g3=N.getFloatInstance({minFractionDigits:i,maxFractionDigits:i,style:"short",showScale:true,shortRefNumber:j});if(f3){return g3.format(Number(k))+" %";}else{return g3.format(Number(k));}}}function J2(i){if(!i||!i.Value||!i.Value.Path){return"";}if(i&&i.ValueFormat&&i.ValueFormat.NumberOfFractionalDigits&&i.ValueFormat.NumberOfFractionalDigits.Int){this.getModel("ovpCardProperties").oData.NumberOfFractionalDigits=i.ValueFormat.NumberOfFractionalDigits.Int;}var j=this.getModel('ovpCardProperties');var k=j.getProperty("/entityType");var f3=j.getProperty("/metaModel");var g3=f3.getODataProperty(k,i.Value.Path);if(g3["Org.OData.Measures.V1.Unit"]){var h3=g3["Org.OData.Measures.V1.Unit"];if(h3.String=="%"){this.getModel("ovpCardProperties").oData.percentageAvailable=true;}}return"{parts: [{path:'"+i.Value.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.KpiValueFormatter'}";}function K2(i,j){if(!j||!j.Value||!j.Value.Path||!j.TrendCalculation){return"";}var k=G1(j.Value);var f3=G1(j.TrendCalculation.ReferenceValue);var g3=G1(j.TrendCalculation.DownDifference);var h3=G1(j.TrendCalculation.UpDifference);var i3=q1(f3);var j3=q1(g3);var k3=q1(h3);var l3="parts: ["+k;l3+=i3?","+f3:"";l3+=j3?","+g3:"";l3+=k3?","+h3:"";l3+="]";var m3=function(){var o3=1;return y(arguments[0],i3?arguments[o3++]:f3,j3?arguments[o3++]:g3,k3?arguments[o3++]:h3);};var n3=t(m3,"formatTrendDirection");return"{"+l3+", formatter: '"+n3+"'}";}K2.requiresIContext=true;function L2(i){if(!i||!i.TrendCalculation||!i.TrendCalculation.ReferenceValue){return"";}if(i&&i.ValueFormat&&i.ValueFormat.NumberOfFractionalDigits&&i.ValueFormat.NumberOfFractionalDigits.Int){this.getModel("ovpCardProperties").oData.NumberOfFractionalDigits=i.ValueFormat.NumberOfFractionalDigits.Int;}if(i.TrendCalculation.ReferenceValue.Path){return"{parts: [{path:'"+i.Value.Path+"'}, {path:'"+i.TrendCalculation.ReferenceValue.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.returnPercentageChange'}";}else{return"{parts: [{path:'"+i.Value.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.returnPercentageChange'}";}}function M2(k,i){var j,f3,g3,h3,i3=false;if(isNaN(+k)){return"";}if(k==0){h3=i;}else{h3=k;}f3=this.getModel('ovpCardProperties');if(f3.getProperty("/iNumberOfFractionalDigits")){g3=+(f3.getProperty("/iNumberOfFractionalDigits"));}if(f3.getProperty("/bPercentageAvailableForTarget")){i3=true;}if(i){j=i;}else{if(f3.getProperty("/sManifestTargetValue")){j=f3.getProperty("/sManifestTargetValue");}}if(!g3||g3<0){g3=0;}else if(g3>2){g3=2;}if(j){var j3=N.getFloatInstance({minFractionDigits:g3,maxFractionDigits:g3,style:"short",showScale:true,shortRefNumber:h3});if(i3){return j3.format(+(j))+" %";}else{return j3.format(+(j));}}}function N2(i){if(!i||!i.TrendCalculation||!i.TrendCalculation.ReferenceValue){return"";}if(!i||!i.Value||!i.Value.Path){return"";}var j=this.getModel('ovpCardProperties');var k=j.getProperty("/entityType");var f3=j.getProperty("/metaModel");if(i&&i.ValueFormat&&i.ValueFormat.NumberOfFractionalDigits&&i.ValueFormat.NumberOfFractionalDigits.Int){j.setProperty("/iNumberOfFractionalDigits",i.ValueFormat.NumberOfFractionalDigits.Int);}if(i.TrendCalculation.ReferenceValue){if(i.TrendCalculation.ReferenceValue.String){j.setProperty("/sManifestTargetValue",i.TrendCalculation.ReferenceValue.String);return"{parts: [{path:'"+i.Value.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.TargetValueFormatter'}";}if(i.TrendCalculation.ReferenceValue.Path){var g3=f3.getODataProperty(k,i.TrendCalculation.ReferenceValue.Path);if(g3["Org.OData.Measures.V1.Unit"]){var h3=g3["Org.OData.Measures.V1.Unit"];if(h3.String=="%"){j.setProperty("/bPercentageAvailableForTarget",true);}}return"{parts: [{path:'"+i.Value.Path+"'},{path:'"+i.TrendCalculation.ReferenceValue.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.TargetValueFormatter'}";}}}function O2(k,i){var j,f3,g3;if(isNaN(+k)){return"";}k=+(k);g3=this.getModel('ovpCardProperties');if(g3.getProperty("/iNumberOfFractionalDigits")){j=+(g3.getProperty("/iNumberOfFractionalDigits"));}if(i){f3=+(i);}else{if(g3.getProperty("/sManifestTargetValue")){f3=+(g3.getProperty("/sManifestTargetValue"));}}if(!j||j<0){j=0;}else if(j>2){j=2;}if(f3){var h3=((k-f3)/f3);var i3=N.getPercentInstance({style:'short',minFractionDigits:j,maxFractionDigits:j,showScale:true});return i3.format(h3);}}function P2(i){if(i&&i.GroupBy&&!(q.isEmptyObject(i.GroupBy))&&i.GroupBy[0].hasOwnProperty('PropertyPath')){return true;}else{return false;}}function Q2(j,k){var f3;for(var i=0;j&&i<j.length;i++){if(j[i].value==k){f3=j[i];break;}}return f3?f3.name:null;}function R2(i,k){return Q2(i,k);}function S2(i,k){var j=Q2(i,k);return j?j:b.getText("OVP_KEYUSER_LABEL_NO_NAVIGATION");}function T2(i){var j="";var k=i&&i.GroupBy;if(!k){return j;}var f3=this.getModel('ovpCardProperties').getProperty("/metaModel");var g3=this.getModel('ovpCardProperties').getProperty("/entityType");var h3;if(i.GroupBy.constructor===Array){h3=i.GroupBy;}else if(!i.GroupBy.Collection){return j;}else{h3=i.GroupBy.Collection;}var i3;e(h3,function(){i3=$2(f3,g3,this.PropertyPath);if(!i3){return;}j+=i3;j+=", ";});if(j[j.length-1]===" "&&j[j.length-2]===","){j=j.substring(0,j.length-2);}return j==""?"":b.getText("By",[j]);}function U2(i,j,k){var f3=true;var g3=k["SelectOptions"].length-1;if(j.PropertyName.PropertyPath===k["SelectOptions"][g3].PropertyName.PropertyPath){f3=false;}j=[j];var h3=i.getSetting('ovpCardProperties');var i3=h3.getProperty("/entityType");var j3=h3.getProperty("/metaModel");var k3=C1(h3,j);if(k3.length==0){return"";}var l3;var m3;l3=k3[0].path;m3=_2(j3,i3,l3);if(m3!==l3){return"";}var n3=j3.getODataProperty(i3,j[0].PropertyName.PropertyPath)["type"];var o3=Y2(k3,n3);if(f3===true){return o3+", ";}return o3;}U2.requiresIContext=true;function V2(i,j,k){var f3=!(j.index===(k.length-1));var g3=i.getSetting('ovpCardProperties');var h3=g3.getProperty("/metaModel");var i3=g3.getProperty("/entityType");var j3=h3.getODataProperty(i3,k[j.index].path)["type"];var k3=Y2([k[j.index]],j3);if(f3===true){return k3+", ";}return k3;}V2.requiresIContext=true;function W2(i){return i.id;}function X2(i){return i.id;}function Y2(j,k){var f3=[];for(var i=0;i<j.length;i++){f3.push(Z2(j[i],k));}return f3.join(', ');}function Z2(i,j){var k=false;var f3,g3=D.getInstance({'style':'medium'});if(j==='Edm.DateTime'){f3=g3.format(new Date(i.value1));}else if(j==='Edm.DateTimeOffset'){f3=g3.format(new Date(i.value1),true);}else{f3=i.value1;}if(i.operator[0]==="N"){k=true;}if(i.value2){if(j==='Edm.DateTime'){f3+=" - "+g3.format(new Date(i.value1));}else if(j==='Edm.DateTimeOffset'){f3+=" - "+g3.format(new Date(i.value1),true);}else{f3+=" - "+i.value1;}}if(k){f3=b.getText("kpiHeader_Filter_NotOperator",[f3]);}return f3;}function $2(i,j,k){return a3(i,j,k,"com.sap.vocabularies.Common.v1.Label");}function _2(i,j,k){return a3(i,j,k,"sap:text");}function a3(i,j,k,f3){var g3=i.getODataProperty(j,k);if(!g3){L.error("No Property Found for with Name '"+k+" For Entity-Type '"+j.name+"'");return;}var h3=g3[f3];if(h3){if(f3==="com.sap.vocabularies.Common.v1.Label"){return h3.String;}return h3;}return g3.name;}function b3(i){if(!i||!i.Value||!i.Value.Path){return"";}return"{parts: [{path:'"+i.Value.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.KpiValueFormatter'}";}function c3(i,j){if(j.hasOwnProperty(i)){return true;}return false;}function d3(i,j){if(j[i].customDateRangeImplementation){return j[i].customDateRangeImplementation;}else{var k={module:'sap.ui.comp.config.condition.DateRangeType',operations:{filter:[{path:'key',contains:j[i].selectedValues,exclude:j[i].exclude}]}};return JSON.stringify(k);}}function e3(i){if(i){return undefined;}return"_BASIC";}return{getGroupID:e3,getConditionTypeForDateProperties:d3,isDateRangeType:c3,NumberFormatFunctions:g,DateFormatFunctions:h,CurrencyFormatFunctions:l,formatFunctions:d,criticalityConstants:m,TextArrangementType:T,getLabelForDataItem:p,colorPaletteForComparisonMicroChart:k1,formatField:Z,checkFilterPreference:s1,formatItems:t1,getCardSelections:z1,getCardSorters:A1,getFilters:C1,getPrimitiveValue:F1,getAnnotationLabel:R2,getApplicationName:S2,removeDuplicateDataField:I1,formatUrl:J1,getDataPointsCount:K1,getFirstDataPointValue:L1,getFirstDataFieldName:O1,getSecondDataFieldName:P1,getRequestFields:y1,getThirdDataFieldName:Q1,formatDataFieldValueOnIndex:T1,formatDataPointValueOnIndex:U1,formatDataPointOrField:V1,formatsemanticObjectOfDataFieldGeneric:W1,getLabelForFirstDataPoint:$1,formatImageUrl:_1,formatUnit:a2,formatObjectNumber:b2,formatFirstDataPointState:c2,formatFirstDataPointColor:d2,formatSecondDataPointState:e2,formatThirdDataPointState:f2,formatFirstDataPointStateForSmartField:g2,formatKPIHeaderState:i2,isFirstDataPointCriticality:j2,isFirstDataPointCriticalityForTableStatus:k2,getSortedDataFields:z,getSortedDataPoints:B,formatDataFieldValueGeneric:o2,formatDataPointValue:s2,formatDataPointStateGeneric:t2,checkCriticalityGeneric:u2,checkCriticalityGenericForTableStatus:v2,formatDataPointStateForSmartFieldGeneric:w2,hasActions:x2,isFirstDataPointPercentageUnit:y2,resolveEntityTypePath:z2,resolveParameterizedEntitySet:A2,getAssociationObject:B2,semanticObjectOfFirstDataField:D2,semanticObjectOfSecondDataField:E2,isFirstContactAnnotation:G2,getAggregateNumber:H2,KpiValueFormatter:I2,kpiValueCriticality:h2,formThePathForAggregateNumber:J2,formThePathForTrendIcon:K2,formPathForPercentageChange:L2,TargetValueFormatter:M2,formPathForTargetValue:N2,returnPercentageChange:O2,isPresentationVarientPresent:P2,listGroupBy:T2,formTheFilterByString:U2,formTheFilterByStringNotFromSelVar:V2,formTheIdForFilter:W2,formTheIdForFilterNotFromSelVar:X2,_criticality2state:u,_calculateCriticalityState:x,_calculateTrendDirection:y,_getPropertiesFromBindingString:w1,sortCollectionByImportance:M,checkNavTargetForContactAnno:q2,checkForContactAnnotation:r2,getKPIHeaderAggregateNumber:b3};},true);
