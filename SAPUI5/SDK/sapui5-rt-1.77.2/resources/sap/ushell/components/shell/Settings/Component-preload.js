//@ui5-bundle sap/ushell/components/shell/Settings/Component-preload.js
// Copyright (c) 2009-2020 SAP SE, All Rights Reserved
sap.ui.predefine('sap/ushell/components/shell/Settings/Component',["sap/ui/core/mvc/XMLView","sap/ui/core/UIComponent","sap/ui/model/json/JSONModel","sap/ushell/Config","sap/ushell/EventHub","sap/ushell/resources","sap/ushell/components/shell/Settings/userAccount/UserAccountEntry","sap/ushell/components/shell/Settings/homepage/HomepageEntry"],function(X,U,J,C,E,r,a,H){"use strict";var d=[];return U.extend("sap.ushell.components.shell.Settings.Component",{metadata:{version:"1.77.2",library:"sap.ushell",dependencies:{libs:["sap.m","sap.ui.layout"]}},init:function(){U.prototype.init.apply(this,arguments);this._addStandardEntityToConfig();this._loadSearchProfiling();d.push(E.on("openUserSettings").do(this._openUserSettings.bind(this)));},_addStandardEntityToConfig:function(){var e=C.last("/core/userPreferences/entries");e.push(a.getEntry());if(C.last("/core/home/enableHomePageSettings")&&!C.last("/core/spaces/enabled")){e.push(H.getEntry());}e=sap.ushell.Container.getRenderer("fiori2").reorderUserPrefEntries(e);C.emit("/core/userPreferences/entries",e);},_openUserSettings:function(e){if(!this.oDialog){X.create({id:"settingsView",viewName:"sap.ushell.components.shell.Settings.UserSettings"}).then(function(s){this.oSettingsView=s;var m=C.createModel("/core/userPreferences",J);s.setModel(m);s.setModel(r.i18nModel,"i18n");this.oDialog=s.byId("userSettingsDialog");if(e.id){sap.ui.getCore().byId(e.id).addDependent(s);}this.oDialog.open();}.bind(this));}else{this.oDialog.open();}},_loadSearchProfiling:function(){function i(){return C.last("/core/shellHeader/headEndItems").indexOf("sf")!==-1;}if(i()){sap.ui.require(["sap/ushell/renderers/fiori2/search/userpref/SearchPrefs","sap/ushell/renderers/fiori2/search/SearchShellHelperAndModuleLoader"],function(S){var s=S.getEntry(),R=sap.ushell.Container.getRenderer("fiori2");s.isSearchPrefsActive().done(function(b){if(b&&R){R.addUserProfilingEntry(s);}});});}},exit:function(){for(var i=0;i<d.length;i++){d[i].off();}if(this.oSettingsView){this.oSettingsView.destroy();this.oSettingsView=null;this.oDialog=null;}}});});
sap.ui.predefine('sap/ushell/components/shell/Settings/UserSettings.controller',["sap/ui/core/mvc/Controller","sap/ui/core/Fragment","sap/ui/model/json/JSONModel","sap/ui/Device","sap/ushell/EventHub","sap/ushell/resources","sap/ushell/utils","sap/base/Log"],function(C,F,J,D,E,r,u,L){"use strict";return C.extend("sap.ushell.components.shell.Settings.UserSettings",{onInit:function(){this.getView().byId("userSettingEntryList").addEventDelegate({onAfterRendering:this._listAfterRendering.bind(this)});this.getView().byId("userSettingsDialog").addEventDelegate({onkeydown:this._keyDown.bind(this)});},_afterClose:function(){if(window.document.activeElement&&window.document.activeElement.tagName==="BODY"){window.document.getElementById("meAreaHeaderButton").focus();}},_keyDown:function(e){if(e.keyCode===27){this._handleCancelButtonPress();}},_listAfterRendering:function(){var m=this.getView().byId("userSettingEntryList");var e=m.getItems();for(var i=0;i<e.length;i++){var p=e[i].getBindingContextPath();this._setEntryValueResult(p);}if(!D.system.phone){var f=m.getItems()[0];if(f){m.setSelectedItem(f);this._toDetail(f);f.getDomRef().focus();}}},_setEntryValueResult:function(e){var m=this.getView().getModel(),v=m.getProperty(e+"/valueArgument"),V=m.getProperty(e+"/valueResult");if(typeof v==="function"){m.setProperty(e+"/valueResult",r.i18n.getText("genericLoading"));v().then(function(a){if(a&&a.value!==undefined){m.setProperty(e+"/visible",!!a.value);}var d;if(typeof(a)==="object"){d=a.displayText||"";}else{d=a||"";}m.setProperty(e+"/valueResult",d);},function(){m.setProperty(e+"/valueResult",r.i18n.getText("loadingErrorMessage"));});}else if(V===null||V===undefined){m.setProperty(e+"/valueResult",v||"");}},_navBackButtonPressHandler:function(){var s=this.getView().byId("settingsApp");s.backDetail();this._updateHeaderButtonVisibility(true);},_navToggleButtonPressHandler:function(){var s=this.getView().byId("settingsApp"),i=s.isMasterShown();if(i){s.hideMaster();}else{s.showMaster();}this._updateHeaderButtonVisibility(!i);},_updateHeaderButtonVisibility:function(i){var n;if(D.system.phone){n=this.getView().byId("userSettingsNavBackButton");n.setVisible(!i);}else if(D.system.tablet){n=this.getView().byId("userSettingsMenuButton");n.setVisible(true);n.setPressed(i);n.setTooltip(r.i18n.getText(i?"ToggleButtonHide":"ToggleButtonShow"));}},_itemPress:function(e){this._toDetail(e.getSource().getSelectedItem());},_toDetail:function(s){var m=this.getView().getModel(),e=s.getBindingContextPath(),d=m.getProperty(e+"/contentResult");if(D.system.phone){s.setSelected(false);}if(d){this._navToDetail(d,e);}else{var o=m.getProperty(e);this._createEntryContent(o).then(function(n){m.setProperty(e+"/contentResult",n);this._navToDetail(n,e);}.bind(this));}},_createEntryContent:function(e){var t=this;var c=this._addContentWrapper(e);if(typeof e.contentFunc==="function"){e.contentFunc().then(function(o){if(o instanceof sap.ui.core.Control){c.then(function(p){p.addContent(o);p.setBusy(false);});}else{c.then(t._addErrorContentToWrapper.bind(null,r.i18n.getText("loadingErrorMessage")));}},function(){c.then(t._addErrorContentToWrapper.bind(null,r.i18n.getText("loadingErrorMessage")));});}else{c.then(this._addErrorContentToWrapper.bind(null,r.i18n.getText("userSettings.noContent")));}return c.then(function(p){return p.getId();});},_addContentWrapper:function(e){var t=this;return F.load({name:"sap.ushell.components.shell.Settings.ContentWrapper"}).then(function(p){var m=new J({title:e.title,showHeader:!e.provideEmptyWrapper});p.setModel(m,"entryInfo");t.getView().byId("settingsApp").addDetailPage(p);return p;});},_addErrorContentToWrapper:function(m,p){F.load({name:"sap.ushell.components.shell.Settings.ErrorContent"}).then(function(e){p.setBusy(false);p.getModel("entryInfo").setProperty("/errorMessage",m);p.addContent(e);});},_navToDetail:function(i,e){var s=this.getView().byId("settingsApp");s.toDetail(i);if(s.getMode()==="ShowHideMode"){s.hideMaster();this._updateHeaderButtonVisibility(false);}this._emitEntryOpened(e);},_emitEntryOpened:function(e){var U=E.last("UserSettingsOpened")||{},o=this.getView().getModel().getProperty(e),i=o.id;if(!i){i=u._getUid();this.getView().getModel().setProperty(e+"/id",i);}U[i]=true;E.emit("UserSettingsOpened",U);},_refreshBrowser:function(){document.location=document.location.href.replace(location.hash,"");},_handleSaveButtonPress:function(){var t=this,d=this.getView().byId("userSettingsDialog"),e=this.getView().getModel().getProperty("/entries"),o=E.last("UserSettingsOpened")||{},s;if(Object.keys(o).length===0){this._handleSettingsDialogClose();this._showSuccessMessageToast();return;}d.setBusy(true);s=e.reduce(function(R,a){if(o[a.id]){R.push(this._executeEntrySave(a));}return R;}.bind(this),[]);Promise.all(s).then(function(R){var f=R.filter(function(g){return g.hasOwnProperty("error");});d.setBusy(false);if(f.length>0){var a=r.i18n.getText(f.length===1?"savingEntryError":"savingEntriesError")+"\n";var b="";f.forEach(function(g){a+=g.entry+"\n";b+="Entry: "+g.entry+" - Error message: "+g.error+"\n";});t._showErrorMessageBox(a);L.error("Failed to save the following entries",b);}else{t._handleSettingsDialogClose();t._showSuccessMessageToast();E.emit("UserSettingsOpened",null);var c=R.some(function(g){return g.refresh;});if(c){t._refreshBrowser();}}});},_executeEntrySave:function(e){var o=e.onSave(),R;function a(p){var c={};if(p&&p.refresh===true){c.refresh=true;}return c;}function b(s){return{entry:e.title,error:s};}if(o.promise){L.warning("jQuery.promise is used to save "+e.title+" settings entry.\n"+"The using of jQuery.promise for onSave is deprecated. Please use the native promise instead.");R=new Promise(function(c){o.done(function(p){c(a(p));}).fail(function(s){c(b(s));});});}else{R=o.then(a,b);}return R;},_showSuccessMessageToast:function(){sap.ui.require(["sap/m/MessageToast"],function(M){var m=r.i18n.getText("savedChanges");M.show(m,{width:"15em",my:"center bottom",at:"center bottom",of:window,offset:"0 -50",collision:"fit fit"});});},_showErrorMessageBox:function(e){sap.ui.require(["sap/m/MessageBox"],function(M){M.show(e,{icon:M.Icon.ERROR,title:r.i18n.getText("error"),actions:[M.Action.OK]});});},_handleCancelButtonPress:function(){var e=this.getView().getModel().getProperty("/entries");var i=E.last("UserSettingsOpened")||{};if(i){e.forEach(function(o){if(i[o.id]&&o.onCancel){o.onCancel();}});}E.emit("UserSettingsOpened",null);this._handleSettingsDialogClose();},_handleSettingsDialogClose:function(){sap.ushell.Container.getUser().resetChangedProperties();if(D.system.phone){this.getView().byId("settingsApp").toMaster("settingsView--userSettingMaster");}this.getView().byId("userSettingsDialog").close();}});});
sap.ui.predefine('sap/ushell/components/shell/Settings/homepage/HomepageEntry',["sap/base/Log","sap/ui/core/mvc/XMLView","sap/ui/model/json/JSONModel","sap/ushell/components/SharedComponentUtils","sap/ushell/Config","sap/ushell/resources"],function(L,X,J,S,C,r){"use strict";var d={"scroll":0,"tabs":1,getName:function(v){return Object.keys(this)[v];}};return{getEntry:function(){var v;return{id:"homepageEntry",entryHelpID:"homepageEntry",title:r.i18n.getText("FlpSettings_entry_title"),valueResult:null,contentResult:null,icon:"sap-icon://home",valueArgument:null,contentFunc:function(){var D=new jQuery.Deferred();S.getEffectiveHomepageSetting("/core/home/homePageGroupDisplay","/core/home/enableHomePageSettings").then(function(s){X.create({id:"UserSettingsHomepageSettingsView",viewName:"sap.ushell.components.shell.Settings.homepage.HomepageSetting"}).then(function(V){v=V;v.setModel(new J({displayMode:d[s]||d.scroll,personanlisationEnabled:C.last("/core/shell/enablePersonalization")}));v.setModel(r.getTranslationModel(),"i18n");D.resolve(v);});});return D;},onSave:function(){if(v){var c=v.getModel().getProperty("/displayMode"),D=d.getName(c),R=sap.ushell.Container.getRenderer("fiori2");return new Promise(function(a,b){S.getPersonalizer("homePageGroupDisplay",R).setPersData(D).done(function(){C.emit("/core/home/homePageGroupDisplay",D);a();}).fail(function(e){L.error("Failed to save the anchor bar mode in personalization",e,"sap.ushell.components.ushell.settings.homepage.HomepageEntry");b();});});}L.warning("Save operation for user account settings was not executed, because the userAccount view was not initialized");return Promise.resolve();},onCancel:function(){if(v){return;}L.warning("Cancel operation for user account settings was not executed, because the userAccount view was not initialized");},provideEmptyWrapper:true};}};});
sap.ui.predefine('sap/ushell/components/shell/Settings/userAccount/UserAccountEntry',["sap/ui/core/mvc/XMLView","sap/base/Log","sap/ushell/Config","sap/ushell/resources"],function(X,L,C,r){"use strict";function g(){var s=sap.ushell.Container.getRenderer("fiori2").getShellConfig(),u=s.enableUserImgConsent;var v=u?"userAccountSelector":"userAccountSetting";var c=u?"sap.ushell.components.shell.Settings.userAccount.UserAccountSelector":"sap.ushell.components.shell.Settings.userAccount.UserAccountSetting";var i=C.last("/core/shell/model/userImage/account")||"sap-icon://account";var V;var e={id:"userAccountEntry",entryHelpID:"userAccountEntry",title:r.i18n.getText("UserAccountFld"),valueResult:null,contentResult:null,icon:i,valueArgument:sap.ushell.Container.getUser().getFullName(),contentFunc:function(){return X.create({id:v,viewName:c}).then(function(o){V=o;return o;});},onSave:function(){if(V){return V.getController().onSave();}L.warning("Save operation for user account settings was not executed, because the userAccount view was not initialized");return Promise.resolve();},onCancel:function(){if(V){V.getController().onCancel();return;}L.warning("Cancel operation for user account settings was not executed, because the userAccount view was not initialized");},provideEmptyWrapper:true};return e;}return{getEntry:g};});
sap.ui.predefine('sap/ushell/components/shell/Settings/userAccount/UserAccountSelector.controller',["sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel","sap/base/Log","sap/ushell/Config","sap/ushell/resources"],function(C,J,L,a,r){"use strict";return C.extend("sap.ushell.components.shell.Settings.userAccount.UserAccountSelector",{onInit:function(){var s=sap.ushell.Container.getRenderer("fiori2").getShellConfig(),e=s.enableUserImgConsent;this.imgConsentEnabled=e||false;this.oUser=sap.ushell.Container.getUser();var R=r.getTranslationModel();var c=this.getConfigurationModel();this.getView().setModel(R,"i18n");this.getView().setModel(c,"config");this.oUser.attachOnSetImage(function(){var p=a.last("/core/shell/model/userImage/personPlaceHolder"),P="sap-icon://person-placeholder";c.setProperty("/icon",p||P);});},getConfigurationModel:function(){var m=new J({}),u=sap.ushell.Container.getUser(),i=u.getImage()?a.last("/core/shell/model/userImage/personPlaceHolder"):"sap-icon://person-placeholder";m.setData({icon:i,name:u.getFullName(),mail:u.getEmail(),server:window.location.host,imgConsentEnabled:this.imgConsentEnabled,isImageConsentForUser:u.getImageConsent()});return m;},onCancel:function(){if(this.imgConsentEnabled){this.getView().getModel("config").setProperty("/isImageConsentForUser",this.oUser.getImageConsent());}},onSave:function(){if(this.imgConsentEnabled){return this.onSaveUserImgConsent();}return Promise.resolve();},onSaveUserImgConsent:function(){var u=this.oUser,o=u.getImageConsent(),m=this.getView().getModel("config"),c=m.getProperty("/isImageConsentForUser"),U;if(o!==c){u.setImageConsent(c);return new Promise(function(b,d){U=sap.ushell.Container.getService("UserInfo").updateUserPreferences(u);U.done(function(){u.resetChangedProperty("isImageConsent");b();});U.fail(function(e){u.setImageConsent(o);u.resetChangedProperty("isImageConsent");m.setProperty("/isImageConsentForUser",o);L.error(e);d(e);});});}return Promise.resolve();},termsOfUserPress:function(){var t=this.getView().byId("termsOfUseTextFlexBox"),b=this.getView().byId("termsOfUseLink"),i=t.getVisible();t.setVisible(!i);b.setText(r.i18n.getText(i?"userImageConsentDialogShowTermsOfUse":"userImageConsentDialogHideTermsOfUse"));}});});
sap.ui.require.preload({
	"sap/ushell/components/shell/Settings/ContentWrapper.fragment.xml":'<core:FragmentDefinition xmlns="sap.m" xmlns:core="sap.ui.core"><Page class="sapUsheUserSettingDetaildPage" showHeader="false" busy="true"><content><ObjectHeader title="{entryInfo&gt;/title}" visible="{entryInfo&gt;/showHeader}" backgroundDesign="Solid" class="sapUshellUserSettingDetailHeader"/></content></Page></core:FragmentDefinition>',
	"sap/ushell/components/shell/Settings/ErrorContent.fragment.xml":'<core:FragmentDefinition xmlns="sap.m" xmlns:core="sap.ui.core"><FlexBox height="5rem" alignItems="Center" justifyContent="Center"><items><Text text="{entryInfo&gt;/errorMessage}"/></items></FlexBox></core:FragmentDefinition>',
	"sap/ushell/components/shell/Settings/UserSettings.view.xml":'<mvc:View controllerName="sap.ushell.components.shell.Settings.UserSettings" xmlns="sap.m" xmlns:mvc="sap.ui.core.mvc" xmlns:core="sap.ui.core"><Dialog id="userSettingsDialog" class="sapUshellUserSetting sapContrastPlus" showHeader="false" contentHeight="42rem" contentWidth="58rem" afterClose="._afterClose" stretch="{device&gt;/system/phone}"><buttons><Button id="userSettingSaveButton" text="{i18n&gt;saveBtn}" type="Emphasized" press="._handleSaveButtonPress"/><Button id="userSettingCancelButton" text="{i18n&gt;cancelBtn}" press="._handleCancelButtonPress"/></buttons><content><Page class="sapUshellSettingsPage" showHeader="true"><customHeader><Bar id="settingsBar"><contentLeft><Button id="userSettingsNavBackButton" icon="sap-icon://nav-back" press="._navBackButtonPressHandler" tooltip="{i18n&gt;ToggleButtonShow}" visible="false"/><ToggleButton id="userSettingsMenuButton" icon="sap-icon://menu2" press="._navToggleButtonPressHandler" tooltip="{i18n&gt;ToggleButtonShow}" visible="false"/></contentLeft><contentMiddle><Text text="{i18n&gt;userSettings}"/></contentMiddle></Bar></customHeader><content><SplitApp id="settingsApp" defaultTransitionNameDetail="show" mode="{= ${device&gt;/system/desktop} ? \'StretchCompressMode\' : \'ShowHideMode\'}"><masterPages><Page id="userSettingMaster" class="sapUshellUserSettingMaster" showHeader="false"><content><List id="userSettingEntryList" items="{/entries}" mode="SingleSelectMaster" selectionChange="._itemPress"><StandardListItem class="sapUshellUserSettingMasterListItem" title="{title}" description="{valueResult}" icon="{= !!${icon} ? ${icon} : \'sap-icon://action-settings\' }" visible="{visible}" type="{= ${device&gt;/system/phone} ? \'Navigation\' : \'Inactive\'}"><customData><core:CustomData key="help-id" value="{entryHelpID}" writeToDom="{= !!${entryHelpID}}"/></customData></StandardListItem></List></content></Page></masterPages></SplitApp></content></Page></content></Dialog></mvc:View>',
	"sap/ushell/components/shell/Settings/homepage/HomepageSetting.view.xml":'<mvc:View width="100%" xmlns="sap.m" xmlns:lf="sap.ui.layout.form" xmlns:mvc="sap.ui.core.mvc"><lf:SimpleForm><lf:content><Label id="anchorBarLabel" class="sapUshellFlpSettingsLabel" text="{i18n&gt;AnchorBarLabel}"/><VBox><items><RadioButtonGroup selectedIndex="{/displayMode}" ariaLabelledBy="anchorBarLabel" ariaDescribedBy="anchorBarDescription"><buttons><RadioButton id="anchorBarScrollModeRBtn" text="{i18n&gt;anchorBarScrollMode}"/><RadioButton id="anchorBarTabModeRBtn" text="{i18n&gt;anchorBarTabMode}"/></buttons></RadioButtonGroup><VBox class="sapUshellFlpSettingsDescriptionBorder"><items><Text id="anchorBarDescription" class="sapUshellFlpSettingsDescription" text="{i18n&gt;homePageGroupDisplayDescriptionText}"/><Text class="sapUshellFlpSettingsDescription" text="{i18n&gt;homePageGroupDisplayDescriptionText_secondParagraph}" visible="{/personanlisationEnabled}"/></items></VBox></items></VBox></lf:content></lf:SimpleForm></mvc:View>',
	"sap/ushell/components/shell/Settings/userAccount/UserAccountImgConsentSelector.fragment.xml":'<core:FragmentDefinition height="100%" width="100%" xmlns="sap.m" xmlns:core="sap.ui.core"><VBox><CheckBox id="imageConsentForUserCheckBox" selected="{config&gt;/isImageConsentForUser}" text="{i18n&gt;imgConsentMsg}"/><Panel expandable="true" headerText="{i18n&gt;userImageConsentDialogShowTermsOfUse}" width="auto"><content><Text text="{i18n&gt;userImageConsentDialogTermsOfUse}"/></content></Panel></VBox></core:FragmentDefinition>',
	"sap/ushell/components/shell/Settings/userAccount/UserAccountSelector.view.xml":'<mvc:View controllerName="sap.ushell.components.shell.Settings.userAccount.UserAccountSelector" xmlns="sap.m" xmlns:mvc="sap.ui.core.mvc" xmlns:core="sap.ui.core"><ObjectHeader icon="{config&gt;/icon}" title="{config&gt;/name}" backgroundDesign="Solid" class="sapUshellUserSettingDetailHeader"/><IconTabBar applyContentPadding="true" backgroundDesign="Transparent"><items><IconTabFilter text="{i18n&gt;UserAccountFld}" key="userAccountSetting"><core:Fragment fragmentName="sap.ushell.components.shell.Settings.userAccount.UserAccountSetting" type="XML"/></IconTabFilter><IconTabFilter visible="{config&gt;/imgConsentEnabled}" text="{i18n&gt;ProfileImgId}" key="userAccountImgConsentSelector"><core:Fragment fragmentName="sap.ushell.components.shell.Settings.userAccount.UserAccountImgConsentSelector" type="XML"/></IconTabFilter></items></IconTabBar></mvc:View>',
	"sap/ushell/components/shell/Settings/userAccount/UserAccountSetting.fragment.xml":'<core:FragmentDefinition height="100%" width="100%" xmlns="sap.m" xmlns:form="sap.ui.layout.form" xmlns:core="sap.ui.core"><VBox class="sapUiSmallMargin"><form:SimpleForm editable="false" layout="ResponsiveGridLayout" labelSpanS="5" columnsM="7"><Label text="{i18n&gt;UserAccountNameFld}" labelFor="userAccountuserName"/><Text text="{config&gt;/name}" id="userAccountuserName"/><Label text="{i18n&gt;UserAccountEmailFld}" labelFor="userAccountuserMail"/><Text text="{config&gt;/mail}" id="userAccountuserMail"/><Label text="{i18n&gt;UserAccountServerFld}" labelFor="userAccountuserServer"/><Text text="{config&gt;/server}" id="userAccountuserServer"/></form:SimpleForm></VBox></core:FragmentDefinition>',
	"sap/ushell/components/shell/Settings/userAccount/UserAccountSetting.view.xml":'<mvc:View controllerName="sap.ushell.components.shell.Settings.userAccount.UserAccountSelector" xmlns:core="sap.ui.core" xmlns:mvc="sap.ui.core.mvc" xmlns="sap.m"><ObjectHeader icon="{config&gt;/icon}" title="{config&gt;/name}" backgroundDesign="Solid" class="sapUshellUserSettingDetailHeader"/><core:Fragment fragmentName="sap.ushell.components.shell.Settings.userAccount.UserAccountSetting" type="XML"/></mvc:View>'
},"sap/ushell/components/shell/Settings/Component-preload"
);
//# sourceMappingURL=Component-preload.js.map