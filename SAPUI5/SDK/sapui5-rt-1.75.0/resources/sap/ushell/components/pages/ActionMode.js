//Copyright (c) 2009-2020 SAP SE, All Rights Reserved
sap.ui.define(["sap/ushell/resources","sap/ushell/EventHub","sap/base/Log"],function(r,E,L){"use strict";var A={};A.start=function(c){this.oController=c;c.getView().getModel("viewSettings").setProperty("/actionModeActive",true);E.emit("enableMenuBarNavigation",false);var a=sap.ui.getCore().byId("ActionModeBtn");var s=r.i18n.getText("PageRuntime.EditMode.Exit");a.setTooltip(s);a.setText(s);};A.cancel=function(){this._cleanup();};A.save=function(){L.info("store actions in pages service");this._cleanup();};A._cleanup=function(){this.oController.getView().getModel("viewSettings").setProperty("/actionModeActive",false);E.emit("enableMenuBarNavigation",true);var a=sap.ui.getCore().byId("ActionModeBtn");var s=r.i18n.getText("PageRuntime.EditMode.Activate");a.setTooltip(s);a.setText(s);};A.addVisualization=function(e,s,p){L.info("add visualization");};A.addSection=function(e,s,p){var S=p.index;var P=s.getBindingContext().getPath();var a=P.split("/");var i=parseInt(a[2],10);return this.oController._oPagesService.then(function(o){o.addSection(i,S);});};A.deleteSection=function(e,s,p){var S=s;var P=S.getBindingContext().getPath();var a=P.split("/");var i=parseInt(a[2],10);var b=parseInt(a[4],10);return this.oController._oPagesService.then(function(o){o.deleteSection(i,b);});};A.resetSection=function(e,s,p){var S=s;var P=S.getBindingContext().getPath();var a=P.split("/");var i=parseInt(a[2],10);var b=parseInt(a[4],10);return this.oController._oPagesService.then(function(o){o.resetSection(i,b);});};A.changeSectionTitle=function(e,s,p){var P=s.getBindingContext().getPath();var n=s.getProperty("title");var a=P.split("/");var i=parseInt(a[2],10);var S=parseInt(a[4],10);return this.oController._oPagesService.then(function(o){o.renameSection(i,S,n);});};A.moveSection=function(e,s,p){var S=p.draggedControl.getBindingContext().getPath();var t=p.droppedControl.getBindingContext().getPath();var d=p.dropPosition;var T=t.split("/");var a=S.split("/");var P=parseInt(a[2],10);var b=parseInt(a[4],10);var c=parseInt(T[4],10);if(b===c-1&&d==="Before"||b===c+1&&d==="After"){return Promise.resolve();}if(d==="After"){c=c+1;}var o=this.oController._getAncestorPage(p.droppedControl);var f=o.getSections();var i;if(b<c){for(i=b+1;i<c;i++){this.oController._setPromiseInSection(f[i],f[i-1]);}this.oController._setPromiseInSection(f[b],f[c-1]);}else{for(i=c;i<b;i++){this.oController._setPromiseInSection(f[i],f[i+1]);}this.oController._setPromiseInSection(f[b],f[c]);}return this.oController._oPagesService.then(function(g){g.moveSection(P,b,c);});};A.changeSectionVisibility=function(e,s,p){if(this.oController===undefined||p.visible===undefined){return Promise.resolve();}var P=s.getBindingContext().getPath();var v=p.visible;var a=P.split("/");var i=parseInt(a[2],10);var S=parseInt(a[4],10);return this.oController._oPagesService.then(function(o){o.setSectionVisibility(i,S,v);});};return A;});
