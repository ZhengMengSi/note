sap.ui.define(["sap/fe/test/Utils","./TemplatePage","sap/ui/test/Opa5","sap/ui/test/OpaBuilder","sap/fe/macros/filter/EditState","sap/fe/test/builder/FilterBarBuilder"],function(U,T,O,a,E,F){"use strict";function _(f,g,i,A){var o=a.Matchers.aggregationMatcher("items",function(c){var C=false;if(c.getItems){var b=c.getItems();if(b&&b.length===2){C=b[0].getProperty("text")===f;if(g!==undefined){if(!Array.isArray(g)){g=[g];}g=g.join(" > ");C=C&&b[1].getProperty("text")===g;}}}return C;});return a.create().hasType("sap.m.ColumnListItem").isDialogElement().hasProperties({selected:i}).hasAggregation("cells",A?[o,A]:o);}return{create:function(A,c,e){var V=A+"::"+c,b="fe::table::"+e+"::LineItem",d="fe::fb::"+e,f=d+"::FFVH::",g=b+"-settings",h=d+"-btnAdapt",r=sap.ui.getCore().getLibraryResourceBundle("sap.fe.core"),R=sap.ui.getCore().getLibraryResourceBundle("sap.fe.templates");return U.mergeObjects(T.create(V,e),{actions:{iSelectEditingStatusAll:function(s){return this.iFilter("UI::EditingStatus",E.ALL.display,s);},iSelectEditingStatusOwnDraft:function(s){return this.iFilter("UI::EditingStatus",E.OWN_DRAFT.display,s);},iSelectEditingStatusUnchanged:function(s){return this.iFilter("UI::EditingStatus",E.UNCHANGED.display,s);},iApplyFiltersToList:function(){return a.create(this).hasId(d+"-btnSearch").doPress().description("Pressing Go Button").execute();},iSearchFor:function(t,s){var o=a.create(this).hasId(d).doOnChildren(a.create(this).hasType("sap.m.SearchField").doEnterText(t,true)).description("Searching for '"+t+"'").execute();if(!s){o=this.iApplyFiltersToList();}return o;},iClearFilter:function(s,S){var o=a.create(this).hasId(d+"::FF::"+s).doEnterText("",true).doOnChildren(a.create(this).hasType("sap.ui.core.Icon").hasProperties({src:"sap-icon://decline"}).doPress()).description("Clearing filter '"+s+"'").execute();if(!S){o=this.iApplyFiltersToList();}return o;},iFilter:function(s,v,S){var o=a.create(this).hasId(d+"::FF::"+s).doEnterText(v,true).description("Filtering '"+s+"' for '"+v+"'").execute();if(!S){o=this.iApplyFiltersToList();}return o;},iSelectAll:function(){return a.create(this).hasId(b+"-innerTable-sa").doPress().description("Selecting all rows").execute();},iSelectRowWithCellValue:function(C,v){return this._iSelectRowWithCellValue(b,C,v);},iDeleteSelected:function(){return this._iDeleteSelected(b);},iOpenListReportItem:function(p){return a.create(this).hasType("sap.m.ColumnListItem").has(a.Matchers.bindingPath(p)).doPress().description("Open item with path '"+p+"'").execute();},iOpenListReportItemWithCellText:function(C,t){return this._iActOnRowWithCellValue(b,C,t);},iExecuteActionOnDialog:function(t){return a.create(this).hasType("sap.m.Button").hasProperties({text:t}).isDialogElement().doPress().description("Pressing dialog button '"+t+"'").execute();},iCreateNewItem:function(){return a.create(this).hasId(b+"::Create").doPress().description("Creating new item").execute();},iExecuteUnboundAction:function(s,i){return a.create(this).hasId(b+"::"+s+"::"+i).doPress().description("Executing unbound action '"+s+"."+i+"'").execute();},iOpenTableSettings:function(){return a.create(this).hasId(g).doPress().description("Accessing table settings").execute();},iAddColumnInTableSettings:function(s,G){return this._iAddColumnInTableSettings(s,G);},iRemoveColumnInTableSettings:function(s,G){return this._iModifyFilterInTableSettings(s,G,true,"Removing column");},iOpenFilterSettings:function(){return a.create(this).hasId(h).doPress().description("Accessing adapt filters").execute();},_iModifyFilterInFilterSettings:function(s,G,i,D){return _(s,G,i).doOnChildren(a.create(this).hasType("sap.m.CheckBox").doPress()).description(D+" '"+s+"' in '"+G+"' group").execute(this);},iAddFilterInFilterSettings:function(s,G){return this._iModifyFilterInFilterSettings(s,G,false,"Adding filter");},iRemoveFilterInFilterSettings:function(s,G){return this._iModifyFilterInFilterSettings(s,G,true,"Removing filter");},iOpenVHDialog:function(s){return a.create(this).hasId(d+"::FF::"+s+"-inner-vhi").doPress().description("Opening value help for dialog'"+s+"'").execute();},iSelectFromVHDTable:function(v){return a.create(this).hasType("sap.m.ColumnListItem").hasAggregationProperties("cells",{value:v}).checkNumberOfMatches(1).isDialogElement().doPress().description("Selecting row from dialog with value '"+v+"'").execute();},iConfirmVHDSelection:function(s,S){var o=a.create(this).hasId(f+s+"-ok").doPress().description("Confirming value help selection for '"+s+"'").execute();if(!S){o=this.iApplyFiltersToList();}return o;},iFilterWithVHDialog:function(s,v){var o=this.iOpenVHDialog(s).and.iSelectFromVHDTable(v).and.iConfirmVHDSelection(s);return o;},iExecuteBoundAction:function(s,i){return this._iExecuteBoundAction(b,s,i);},iPressKeyboardShortcutOnTable:function(s){return this._iPressKeyboardShortcut(b,s);},iPressKeyboardShortcutOnFilter:function(s){return this._iPressKeyboardShortcut(d,s);},iSortTableByColumn:function(C){return this._iSortTableByColumn(b,C);}},assertions:{iSeeRowsInList:function(n){return this._iSeeTableRows(b,n);},iSeeRowWithValueSetInList:function(v,o){return this._iSeeTableRowWithCellValues(b,v,o);},iSeeSelectedRowsInList:function(n){return this._iSeeSelectedTableRows(b,n);},iSeeColumnsInList:function(n){return a.create(this).hasId(b).hasAggregationLength("columns",n).description("Seeing table with "+n+" columns").execute();},iCanAccessTableSettings:function(){return a.create(this).hasId(g).description("Table settings available").execute();},iCanAccessColumnInTableSettings:function(s,G,S){return this._iCanAccessColumnInTableSettings(b,s,G,S);},iCanAccessColumnInFilterSettings:function(s,G,i){return a.create(this).hasId(h).do(_(s,G,i)).description("Property '"+s+"' is available in filter settings").execute();},iSeeHiddenFilterField:function(s,G){var i=a.Matchers.properties({src:"sap-icon://filter",visible:true});return _(s,G,false,a.Matchers.aggregationMatcher("items",i)).description("Seeing hidden filter '"+s+"' in '"+G+"' group").execute(this);},iSeeFilterBar:function(){return a.create(this).hasId(d).description("Seeing the filter bar").execute();},iSeeFilterApplyButton:function(){return a.create(this).hasId(d+"-btnSearch").description("Seeing the filter bar go button").execute();},iSeeListReportTable:function(){return a.create(this).hasId(b).description("Seeing the report table").execute();},iSeeTheMessageToast:function(t){return this._iSeeTheMessageToast(t);},iSeeValueSetInTable:function(i,s){return a.create(this).hasType("sap.m.ColumnListItem").has(function(j){var o=j.getCells()[i],v;if(o.getId().indexOf("vbox")>-1){v=o.getItems()[0].getValue();}else{v=o.getValue();}return v===s;}).description("The value is '"+s+"' for the field with index "+i).execute();},iCheckRatingIndicatorIsVisible:function(n){return a.create(this).hasType("sap.m.RatingIndicator").hasProperties({value:n}).description("Rating Indicator is visible").execute();},iCheckDataFieldWithTextIsVisible:function(t){return a.create(this).hasType("sap.m.ObjectStatus").hasProperties({text:t}).description("DataField with text '"+t+"' is visible").execute();},iCheckContactCardWithLinkTextIsVisible:function(t){return a.create(this).hasType("sap.m.Link").hasProperties({text:t}).description("Contact card with text '"+t+"' is visible").execute();},iCheckTableCellIsHidden:function(p,n,v){return a.create(this).hasType("sap.m.ColumnListItem").has(a.Matchers.bindingPath(p)).has(function(i){var j=i.getCells()[n];return j.getVisible()===false;}).description("The DataField within a table cell with "+v+" value is hidden").execute();},iSeeCreateButton:function(o){return this._iSeeElement(b+"::Create",o);},iSeeFilterFieldsInFilterBar:function(n){return a.create(this).hasId(d).hasAggregationLength("filterItems",n).description("Seeing Filter bar with "+n+" filter fields").execute();},iSeeEditingStatusFilter:function(s){return F.create(this).hasId(d).hasEditingStatus(null,s).description(U.formatMessage("Seeing Editing Status filter with state {0}",s)).execute();},iSeeFilterField:function(s){if(s.indexOf("/")===0){s=s.substring(1);}s=s.replace(/\//g,"::");return a.create(this).hasId(d+"::FF::"+s).description("Seeing filter input for '"+s+"'").execute();},iSeeFilterDefined:function(s,t){return a.create(this).hasId(d+"::FF::"+s+"-inner").hasAggregationProperties("tokens",{text:t}).description("Seeing filter for '"+s+"' set to '"+t+"'").execute();},iSeeVHDialog:function(s){return a.create(this).hasId(f+s+"-dialog").description("Seeing value help dialog for field '"+s+"'").execute();},iSeeVHDTable:function(s){return a.create(this).hasId(f+s+"::Table").has(function(t){return t.getItems().length!==0;}).description("Seeing table of value help dialog for field '"+s+"'").execute();},_checkVHDSearchFieldIsVisible:function(s,v){var S=V+"--"+f+s+"-VHP--SearchField";return a.create(this).hasId(S).hasProperties({visible:v}).mustBeVisible(false).description("Search field of value help dialog for field '"+s+"' is "+(v?"visible":"invisible")).execute();},iCheckVHDSearchFieldIsVisible:function(s,v){return this._checkVHDSearchFieldIsVisible(s,v===undefined?true:v);},iSeeVHDFilterBar:function(s){return a.create(this).hasId(f+s+"::FilterBar").description("Seeing value help filterbar for field '"+s+"'").execute();},iSeeFieldOfDCPOnVHDialog:function(s){return a.create(this).hasId(f+s+"-DCP").description("Definition Condition Panel is available in Value Help of field '"+s+"'").execute();},iSeeDeleteConfirmation:function(){return this._iSeeTheMessageToast(R.getText("OBJECT_PAGE_DELETE_TOAST_SINGULAR"));},iSeeEditingStatusDropdown:function(){return this.iSeeFilterField("UI::EditingStatus");},iSeePageTitle:function(t){return a.create(this).hasType("sap.f.DynamicPageTitle").hasAggregationProperties("heading",{text:t}).description("Seeing title '"+t+"'").execute();},iSeeVariantTitle:function(t){return a.create(this).hasType("sap.m.Title").hasId("fe::lr::vm-text").hasProperties({text:t}).description("Seeing variant title '"+t+"'").execute();},iSeeVariantModified:function(i){var l="fe::lr::vm-modified";i=i===undefined?true:i;if(i){return a.create(this).hasType("sap.m.Label").hasId(l).hasProperties({text:"*"}).description("Seeing variant state as 'modified'").execute();}else{return a.create(this).hasType("sap.m.Label").check(function(L){return!L.some(function(o){return o.getId()===l;});},true).description("Seeing variant state as 'not modified'").execute();}},iSeePageVM:function(){return a.create(this).hasType("sap.f.DynamicPageTitle").hasAggregation("heading",function(C){return C.getMetadata().getName()==="sap.ui.fl.variants.VariantManagement";}).description("Seeing page level VM").execute();},iSeeTableActionButtonIsEnabled:function(s,i,j,B){return this._checkTableActionButtonEnablement(b,s,i,j===undefined?true:j,B);},iSeeTableDeleteButtonIsEnabled:function(i){return this._checkTableActionButtonEnablement(b,"","Delete",i===undefined?true:i);},iSeeDraftIndicator:function(){return a.create(this).hasType("sap.m.Link").hasProperties({text:r.getText("DRAFTINFO_DRAFT_OBJECT")}).description("Draft indicator is visible").execute();},iSeeSortedColumn:function(C){return this._iSeeSortedColumn(b,C,"sortIndicator");},iSeeTableP13nMode:function(m){return this._iSeeTableP13nMode(b,m);}}});}};});
