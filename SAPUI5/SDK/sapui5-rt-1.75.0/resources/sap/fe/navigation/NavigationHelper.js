/*!
 * @copyright@
 */
sap.ui.define(["sap/base/Log","sap/fe/macros/CommonHelper","sap/fe/navigation/SelectionVariant","sap/fe/navigation/NavError"],function(L,C,S,N){"use strict";var a={removeSensitiveData:function(c,d){if(!c){L.error("Context is required");return;}var p=[],i,P,o=c.getObject(),m=c.getModel().getMetaModel(),e=C.getTargetCollection(c),I=function(s,b,D){var f;b=b||e;D=D||o;f=m.getObject(b+"/"+s+"@");if(f){if(f["@com.sap.vocabularies.PersonalData.v1.IsPotentiallySensitive"]||f["@com.sap.vocabularies.UI.v1.ExcludeFromNavigationContext"]||f["@com.sap.vocabularies.Analytics.v1.Measure"]){return true;}else if(f["@com.sap.vocabularies.Common.v1.FieldControl"]){var F=f["@com.sap.vocabularies.Common.v1.FieldControl"];if(F["$EnumMember"]&&F["$EnumMember"].split("/")[1]==="Inapplicable"){return true;}else if(F["$Path"]){var g=F["$Path"],h=g.split("/");if(h.length>1){return D[h[0]]&&D[h[0]][h[1]]&&D[h[0]][h[1]]===0;}else{return D[g]===0;}}}}return false;};if(d){P=d;if(d.getMetadata&&d.getMetadata().getName()==="sap.fe.navigation.SelectionVariant"){i=true;p=d.getPropertyNames()||[];}else if(d instanceof Object){p=Object.keys(d)||[];}else{L.error("Unsupported format - Sensitive data not removed. Pass a SelectionVariant or data map");}}else{p=Object.keys(o)||[];P=JSON.parse(JSON.stringify(o));}p.forEach(function(s){if(!(o[s]instanceof Object)){if(I(s)){if(i){P.removeSelectOption(s);}else{delete P[s];}}}else{var b="/"+m.getObject(e+"/$NavigationPropertyBinding/"+s),n=i?JSON.parse(d.getSelectOption(s)[0].Low):P[s],f=Object.keys(n),g=false;f.forEach(function(h){if(I(h,b,n)){g=true;delete n[h];}});if(g){if(i){P.removeSelectOption(s);P.addSelectOption(s,"I","EQ",JSON.stringify(n));}else{P[s]=n;}}}});return P;},mixAttributesAndSelectionVariant:function(s,b,c){var o=new S(b);var n=new S();if(o.getFilterContextUrl()){n.setFilterContextUrl(o.getFilterContextUrl());}if(o.getParameterContextUrl()){n.setParameterContextUrl(o.getParameterContextUrl());}for(var p in s){if(s.hasOwnProperty(p)){var v=s[p];if(jQuery.type(v)==="array"||jQuery.type(v)==="object"){v=JSON.stringify(v);}else if(jQuery.type(v)==="date"){v=v.toJSON();}else if(jQuery.type(v)==="number"||jQuery.type(v)==="boolean"){v=v.toString();}if(v===""){if(c&sap.fe.navigation.SuppressionBehavior.ignoreEmptyString){L.info("Semantic attribute "+p+" is an empty string and due to the chosen Suppression Behiavour is being ignored.");continue;}}if(v===null){if(c&sap.fe.navigation.SuppressionBehavior.raiseErrorOnNull){throw new N("NavigationHandler.INVALID_INPUT");}else{L.warning("Semantic attribute "+p+" is null and ignored for mix in to selection variant");continue;}}if(v===undefined){if(c&sap.fe.navigation.SuppressionBehavior.raiseErrorOnUndefined){throw new N("NavigationHandler.INVALID_INPUT");}else{L.warning("Semantic attribute "+p+" is undefined and ignored for mix in to selection variant");continue;}}if(jQuery.type(v)==="string"){n.addSelectOption(p,"I","EQ",v);}else{throw new N("NavigationHandler.INVALID_INPUT");}}}var P=o.getParameterNames();for(var i=0;i<P.length;i++){if(!n.getSelectOption(P[i])){n.addSelectOption(P[i],"I","EQ",o.getParameter(P[i]));}}var d=o.getSelectOptionsPropertyNames();for(i=0;i<d.length;i++){if(!n.getSelectOption(d[i])){var e=o.getSelectOption(d[i]);for(var j=0;j<e.length;j++){n.addSelectOption(d[i],e[j].Sign,e[j].Option,e[j].Low,e[j].High);}}}return n;},addConditionsToSelectionVariant:function(s,c){var f=function(o){var l=o.values[0],h=o.values[1],d={Sign:"I"};switch(o.operator){case"Contains":d.Option="CP";d.Low="*"+l+"*";break;case"StartsWith":d.Option="CP";d.Low=l+"*";break;case"EndsWith":d.Option="CP";d.Low="*"+l;break;case"Empty":d.Option="EQ";d.Low="";break;case"EEQ":case"EQ":case"BT":case"LE":case"GE":case"GT":case"LT":d.Option=o.operator==="EEQ"?"EQ":o.operator;d.Low=l;break;default:L.error("Opertation is not supported '"+o.operator+"'");return null;}if(o.operator==="BT"){d.High=h;}return d;};for(var p in c){if(c.hasOwnProperty(p)&&c[p].length){var b=c[p].map(f).filter(function(o){return!!o;});if(b.length){s.massAddSelectOption(p,b);}}}return s;}};return a;});
