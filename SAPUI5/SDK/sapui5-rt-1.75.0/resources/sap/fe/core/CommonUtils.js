/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
        (c) Copyright 2009-2017 SAP SE. All rights reserved
    
 */
sap.ui.define(["sap/ui/core/mvc/View","sap/ui/core/Component","sap/m/MessageBox","sap/base/Log","sap/fe/navigation/SelectionVariant"],function(V,C,M,L,S){"use strict";function g(c){while(c&&!(c instanceof V)){c=c.getParent();}return c;}function h(l){var H=false;l.getCurrentContexts().forEach(function(c){if(c&&c.isTransient()){H=true;}});return H;}function u(o){var U=sap.ushell&&sap.ushell.Container;var x=U&&U.getService("CrossApplicationNavigation");var c=U&&U.getService("URLParsing");var P=c&&c.parseShellHash(document.location.hash);var s=P.semanticObject;var d=P.action;var m=o.getModel().getMetaModel();var B=o.getBindingContext();var e=B&&B.getPath();var k=m.getMetaPath(e);var l=k+"/"+"@com.sap.vocabularies.Common.v1.SemanticKey";var q=m.getObject(l);var t=m.getObject(k+"/"+"@com.sap.vocabularies.Common.v1.SemanticObjectUnavailableActions");var E=B.getObject();var v={};if(E){if(q&&q.length>0){for(var j=0;j<q.length;j++){var w=q[j].$PropertyPath;if(!v[w]){v[w]=[];v[w].push(E[w]);}}}else{var T=m.getObject(k+"/$Type/$Key");for(var y in T){var O=T[y];if(!v[O]){v[O]=[];v[O].push(E[O]);}}}}var z=x.getLinks({semanticObject:s,params:v});z.done(function(A){A.sort(function(H,J){if(H.text<J.text){return-1;}if(H.text>J.text){return 1;}return 0;});if(A&&A.length>0){var I=[];for(var i=0;i<A.length;i++){var D=A[i];var F=D.intent;var G=F.split("-")[1].split("?")[0];if(G!==d&&(!t||(t&&t.indexOf(G)===-1))){I.push({text:D.text,targetSemObject:F.split("#")[1].split("-")[0],targetAction:G.split("~")[0],targetParams:v});}}o.getModel("relatedAppsModel").setProperty("/visibility",I.length>0);o.getModel("relatedAppsModel").setProperty("/items",I);}else{o.getModel("relatedAppsModel").setProperty("/visibility",false);}});}function f(B){var A=["sap.m.Button","sap.m.OverflowToolbarButton"];if(B&&A.indexOf(B.getMetadata().getName())!==-1&&B.getVisible()&&B.getEnabled()){B.firePress();}}function r(v){if(v==="true"||v===true){return true;}else{return false;}}function a(c){var o=C.getOwnerComponentFor(c);if(!o){return c;}else{return a(o);}}function p(P,c,d){var U=c&&c.getModel("ui")&&c.getModel("ui").getData(),e=U.createMode||U.editable==="Editable",R=sap.ui.getCore().getLibraryResourceBundle("sap.fe.templates"),w=R&&R.getText("NAVIGATION_AWAY_MSG"),s=R&&R.getText("NAVIGATION_AWAY_CONFIRM_BUTTON"),i=R&&R.getText("NAVIGATION_AWAY_CANCEL_BUTTON");if(d==="Sticky"&&e){return M.warning(w,{actions:[s,i],onClose:function(A){if(A===s){var l=c&&c.getModel("localUI");L.info("Navigation confirmed.");P();if(l){l.setProperty("/sessionOn",false);}else{L.warning("Local UIModel couldn't be found.");}}else{L.info("Navigation rejected.");}}});}return P();}function n(v,s,c,A,o){s=s?s:new S();var N=s.toJSONString();var d=b.getAppComponent(v);d.getService("navigation").then(function(e){e.navigate(c,A,N,undefined,o);});}var b={fireButtonPress:f,getParentViewOfControl:g,hasTransientContext:h,updateRelatedAppsDetails:u,resolveStringtoBoolean:r,getAppComponent:a,processDataLossConfirmation:p,navigateToExternalApp:n};return b;});
