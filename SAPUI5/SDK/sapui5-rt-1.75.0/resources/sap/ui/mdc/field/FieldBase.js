/*!
 * SAPUI5

		(c) Copyright 2009-2020 SAP SE. All rights reserved
	
 */
sap.ui.define(['sap/ui/thirdparty/jquery','sap/ui/Device','sap/ui/mdc/library','sap/ui/mdc/field/FieldBaseRenderer','sap/ui/mdc/condition/FilterOperatorUtil','sap/ui/mdc/condition/Condition','sap/ui/mdc/field/ConditionType','sap/ui/mdc/field/ConditionsType','sap/ui/mdc/util/BaseType','sap/ui/mdc/util/DateUtil','sap/ui/core/library','sap/ui/core/Control','sap/ui/core/message/MessageMixin','sap/base/util/ObjectPath','sap/base/util/deepEqual','sap/base/util/merge','sap/base/Log','sap/base/util/isEmptyObject','sap/ui/dom/containsOrEquals','sap/ui/model/Filter','sap/ui/model/base/ManagedObjectModel','sap/ui/base/ManagedObjectObserver',"sap/ui/base/SyncPromise",'sap/ui/events/KeyCodes'],function(q,D,l,F,a,C,b,c,B,d,e,f,M,O,g,m,L,h,k,n,o,p,S,K){"use strict";var E=l.EditMode;var r=l.FieldDisplay;var V=e.ValueState;var s=e.CalendarType;var t=f.extend("sap.ui.mdc.field.FieldBase",{metadata:{interfaces:["sap.ui.core.IFormContent"],library:"sap.ui.mdc",properties:{dataType:{type:"string",group:"Data",defaultValue:'sap.ui.model.type.String'},dataTypeConstraints:{type:"object",group:"Data",defaultValue:null},dataTypeFormatOptions:{type:"object",group:"Data",defaultValue:null},editMode:{type:"sap.ui.mdc.EditMode",group:"Data",defaultValue:E.Editable},required:{type:"boolean",group:"Data",defaultValue:false},display:{type:"sap.ui.mdc.FieldDisplay",defaultValue:r.Value},textAlign:{type:"sap.ui.core.TextAlign",group:"Appearance",defaultValue:sap.ui.core.TextAlign.Initial},textDirection:{type:"sap.ui.core.TextDirection",group:"Appearance",defaultValue:sap.ui.core.TextDirection.Inherit},placeholder:{type:"string",group:"Misc",defaultValue:""},valueState:{type:"sap.ui.core.ValueState",group:"Appearance",defaultValue:sap.ui.core.ValueState.None},valueStateText:{type:"string",group:"Misc",defaultValue:null},width:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:null},multipleLines:{type:"boolean",group:"Appearance",defaultValue:false},maxConditions:{type:"int",group:"Behavior",defaultValue:-1},conditions:{type:"object[]",group:"Data",defaultValue:[],byValue:true},label:{type:"string",group:"Misc",defaultValue:""},delegate:{type:"object",defaultValue:{name:"sap/ui/mdc/field/FieldBaseDelegate",payload:{}}},_fieldHelpEnabled:{type:"boolean",group:"Appearance",defaultValue:false,visibility:"hidden"}},aggregations:{content:{type:"sap.ui.core.Control",multiple:false},contentEdit:{type:"sap.ui.core.Control",multiple:false},contentDisplay:{type:"sap.ui.core.Control",multiple:false},_content:{type:"sap.ui.core.Control",multiple:true,visibility:"hidden"},fieldInfo:{type:"sap.ui.mdc.field.FieldInfoBase",multiple:false}},associations:{fieldHelp:{type:"sap.ui.mdc.field.FieldHelpBase",multiple:false},ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"}},events:{liveChange:{parameters:{value:{type:"string"},escPressed:{type:"boolean"},previousValue:{type:"string"}}},press:{}},publicMethods:[],defaultAggregation:"content"},_oManagedObjectModel:null});M.call(t.prototype);var u={Default:{edit:"sap/m/Input",editMulti:["sap/m/MultiInput","sap/m/Token"],editMultiLine:"sap/m/TextArea",display:"sap/m/Text",createEdit:h1,createEditMulti:j1,createEditMultiLine:k1,createDisplay:l1,useDefaultFieldHelp:{name:"defineConditions",oneOperator:false}},Search:{edit:"sap/m/SearchField",display:"sap/m/Text",createEdit:i1,createDisplay:l1,useDefaultFieldHelp:{name:"defineConditions",oneOperator:false}},Date:{edit:"sap/m/Input",editMulti:["sap/m/MultiInput","sap/m/Token"],display:"sap/m/Text",editOperator:{"EQ":{name:"sap/m/DatePicker",create:m1},"EEQ":{name:"sap/m/DatePicker",create:m1},"BT":{name:"sap/m/DateRangeSelection",create:n1}},createEdit:h1,createEditMulti:j1,createDisplay:l1,useDefaultFieldHelp:{name:"defineConditions",oneOperator:false}},Time:{edit:"sap/m/Input",editMulti:["sap/m/MultiInput","sap/m/Token"],display:"sap/m/Text",editOperator:{"EQ":{name:"sap/m/TimePicker",create:m1},"EEQ":{name:"sap/m/TimePicker",create:m1}},createEdit:h1,createEditMulti:j1,createDisplay:l1,useDefaultFieldHelp:{name:"defineConditions",oneOperator:false}},DateTime:{edit:"sap/m/Input",editMulti:["sap/m/MultiInput","sap/m/Token"],display:"sap/m/Text",editOperator:{"EQ":{name:"sap/m/DateTimePicker",create:m1},"EEQ":{name:"sap/m/DateTimePicker",create:m1}},createEdit:h1,createEditMulti:j1,createDisplay:l1,useDefaultFieldHelp:{name:"defineConditions",oneOperator:false}},Link:{edit:"sap/m/Input",editMulti:["sap/m/MultiInput","sap/m/Token"],editMultiLine:"sap/m/TextArea",display:"sap/m/Link",createEdit:h1,createEditMulti:j1,createEditMultiLine:k1,createDisplay:o1,useDefaultFieldHelp:false},Boolean:{edit:"sap/m/Input",display:"sap/m/Text",createEdit:p1,createDisplay:l1,useDefaultFieldHelp:{name:"bool",oneOperator:true}},Unit:{edit:"sap/m/Input",editMulti:["sap/m/MultiInput","sap/m/Input","sap/m/Token"],display:"sap/m/Text",createEdit:q1,createEditMulti:r1,createDisplay:l1,useDefaultFieldHelp:false}};var v;var w;t._init=function(){v={};if(w&&w.bool&&w.bool.control){w.bool.control.destroy();}if(w&&w.defineConditions&&w.defineConditions.control){w.defineConditions.control.destroy();}w={bool:{name:"sap/ui/mdc/field/BoolFieldHelp",id:"BoolDefaultHelp",properties:{},control:undefined},defineConditions:{name:"sap/ui/mdc/field/FieldValueHelp",id:"Field-DefineConditions-Help",properties:{showConditionPanel:true},control:undefined}};};t._init();t.prototype.init=function(){this._oManagedObjectModel=new o(this);this._oObserver=new p(this._observeChanges.bind(this));this._oObserver.observe(this,{properties:["display","editMode","dataType","dataTypeFormatOptions","dataTypeConstraints","multipleLines","maxConditions","conditions","delegate"],aggregations:["fieldInfo","content","contentEdit","contentDisplay"],associations:["fieldHelp","ariaLabelledBy"]});this._oDatePickerRequested={};this.attachEvent("modelContextChange",this._handleModelContextChange,this);this._oResourceBundle=sap.ui.getCore().getLibraryResourceBundle("sap.ui.mdc");this._aAsyncChanges=[];this._oDelegate=undefined;this._oDelegatePromise=new Promise(function(i,j){this._oDelegateResolve=i;this._oDelegateReject=j;}.bind(this));};t.prototype.exit=function(){var i=this.getFieldInfo();if(i){i.detachEvent("dataUpdate",S1,this);}var j=this.getContent();if(j){b1.call(this,j);}var b2=this.getContentEdit();if(b2){b1.call(this,b2);}var c2=this.getContentDisplay();if(c2){b1.call(this,c2);}this._oManagedObjectModel.destroy();delete this._oManagedObjectModel;this._oObserver.disconnect();this._oObserver=undefined;if(this._oConditionType&&this._oConditionType._bCreatedByField){this._oConditionType.destroy();this._oConditionType=undefined;}if(this._oConditionsType&&this._oConditionsType._bCreatedByField){this._oConditionsType.destroy();this._oConditionsType=undefined;}var d2=H1.call(this);if(d2){d2.detachEvent("dataUpdate",M1,this);if(this._bConnected){N1.call(this);d2.connect();}}if(this.iLiveChangeTimer){clearTimeout(this.iLiveChangeTimer);}};t.prototype.applySettings=function(){f.prototype.applySettings.apply(this,arguments);if(!this._oDelegate&&!this._oDelegateLoading){_1.call(this,this.getDelegate());}};t.prototype.onBeforeRendering=function(){if(!this._oDelegate){this._oDelegatePromise.then(function(){d1.call(this);}.bind(this));return;}d1.call(this);};t.prototype.onAfterRendering=function(){if(H1.call(this)&&this.getEditMode()!=E.Display){var j=this.getAggregation("_content",[]);for(var i=0;i<j.length;i++){var b2=j[i];var c2=b2.getFocusDomRef();q(c2).attr("autocomplete","off");}}};t.prototype.onfocusin=function(i){O1.call(this);};t.prototype.onsapup=function(i){var j=H1.call(this);var b2=i.srcControl;if(j&&(!this._bIsMeasure||b2.getShowValueHelp())){i.preventDefault();i.stopPropagation();j.navigate(-1);}};t.prototype.onsapdown=function(i){var j=H1.call(this);var b2=i.srcControl;if(j&&(!this._bIsMeasure||b2.getShowValueHelp())){i.preventDefault();i.stopPropagation();j.navigate(1);}};t.prototype.onsapenter=function(i){var j=H1.call(this);if(j&&j.isOpen(true)){j.close();}};t.prototype.clone=function(i,j){this.detachEvent("modelContextChange",this._handleModelContextChange,this);var b2=this.getContent();if(b2){b1.call(this,b2);}var c2=this.getContentEdit();if(c2){b1.call(this,c2);}var d2=this.getContentDisplay();if(d2){b1.call(this,d2);}var e2=this.getFieldInfo();if(e2){e2.detachEvent("dataUpdate",S1,this);}var f2=f.prototype.clone.apply(this,arguments);this.attachEvent("modelContextChange",this._handleModelContextChange,this);if(b2){a1.call(this,b2);}if(c2){a1.call(this,c2);}if(d2){a1.call(this,d2);}if(e2){e2.attachEvent("dataUpdate",S1,this);}return f2;};t.prototype.getFieldPath=function(){var i=this.getBindingPath("conditions");if(i&&i.startsWith("/conditions/")){return i.slice(12);}else{return"";}};function _(i,j,b2,c2){if(!c2){if(j){c2=Promise.resolve(this._getResultForPromise(i));}else{c2=Promise.reject(b2);}}this._fireChange(i,j,b2,c2);}t.prototype._fireChange=function(i,j,b2,c2){};function x(i){i=this._oDelegate.getDataTypeClass(this._oPayload,i);var j=y.call(this,i);if(j){return new j(I.call(this,i,this.getDataTypeFormatOptions(),this.getDataTypeConstraints()),this.getDataTypeConstraints());}}function y(i){var j=O.get(i||"");if(!j){throw new Error("DataType cannot be determined");}return j;}function z(){if(!this._oDataType){var i=this.getDataType();if(typeof i==="string"){this._oDataType=x.call(this,i);}}return this._oDataType;}t.prototype._initDataType=function(){if(this._oDataType){this._oDataType.destroy();this._oDataType=undefined;}if(this._oDateOriginalType){this._oDateOriginalType.destroy();this._oDateOriginalType=undefined;}if(this._oUnitOriginalType){this._oUnitOriginalType.destroy();this._oUnitOriginalType=undefined;}delete this._sDisplayFormat;delete this._sValueFormat;delete this._sCalendarType;};function A(){if(this._oDataType&&typeof this._oDataType==="object"){return this._oDataType.getMetadata().getName();}else if(this._oDelegate){return this._oDelegate.getDataTypeClass(this._oPayload,this.getDataType());}else{return this.getDataType();}}function G(){if(this._oDataType&&typeof this._oDataType==="object"&&this._oDataType.oConstraints){return this._oDataType.oConstraints;}else{return this.getDataTypeConstraints();}}function H(){if(this._oDataType&&typeof this._oDataType==="object"&&this._oDataType.oFormatOptions){return this._oDataType.oFormatOptions;}else{return this.getDataTypeFormatOptions();}}function I(i,j,b2){if(!this._bAdjustFormatOptions){return j;}var c2=this._oDelegate.getBaseType(this._oPayload,i,j,b2);switch(c2){case B.Date:this._sValueFormat="yyyy-MM-dd";break;case B.DateTime:this._sValueFormat="yyyy-MM-dd'T'HH:mm:ss";break;case B.Time:this._sValueFormat="HH:mm:ss";break;default:return j;}this._sDisplayFormat="medium";if(j){j=m({},j);if(j.style){this._sDisplayFormat=j.style;delete j.style;}else if(j.pattern){this._sDisplayFormat=j.pattern;}if(j.calendarType){this._sCalendarType=j.calendarType;}j.pattern=this._sValueFormat;j.calendarType=s.Gregorian;}else{j={pattern:this._sValueFormat,calendarType:s.Gregorian};}return j;}function J(){var i=z.call(this);var j=i.getMetadata().getName();var b2=i.oFormatOptions;var c2=i.oConstraints;if(!b2||b2.style||!b2.pattern||b2.pattern!==this._sValueFormat||!b2.calendarType||b2.calendarType!==s.Gregorian){this._oDateOriginalType=this._oDataType;I.call(this,j,b2,c2);this._oDataType=d.createInternalType(i,this._sValueFormat);T1.call(this);}}function N(){var i=z.call(this);var j=i.getMetadata().getName();var b2=i.oFormatOptions;var c2=h(i.oConstraints)?undefined:i.oConstraints;if(!b2||!b2.hasOwnProperty("showMeasure")||b2.showMeasure){b2=m({},b2);b2.showMeasure=false;b2.strictParsing=true;if(b2.customCurrencies){delete b2.customCurrencies;}if(b2.customUnits){delete b2.customUnits;}var d2=O.get(j);this._oUnitOriginalType=this._oDataType;this._oDataType=new d2(b2,c2);this._oDelegate.initializeInternalUnitType(this._oPayload,this._oDataType,this._oTypeInitialization);T1.call(this);}}function P(i,j){var b2=H1.call(this);if(b2&&this._bConnected){I1.call(this,i,b2);}}t.prototype._getContent=function(){var i=this.getContent();if(!i){if(this.getEditMode()===E.Display){i=this.getContentDisplay();}else{i=this.getContentEdit();}}if(i){return[i];}else{return this.getAggregation("_content",[]);}};function Q(i){if(i===E.Editable||i===E.EditableReadOnly||i===E.EditableDisplay){return true;}else{return false;}}function R(i){if(i===E.Editable){return true;}else{return false;}}function T(i){if(i&&i!==E.Disabled){return true;}else{return false;}}function U(i){if(i&&i!==E.Editable){return true;}else{return false;}}t.prototype._handleModelContextChange=function(i){};function W(i){this.setValueState(V.Error);this.setValueStateText(i);}function X(){this.setValueState(V.None);this.setValueStateText();}t.prototype._observeChanges=function(j){var b2=function(){if(this.getAggregation("_content",[]).length>0){if(!this._oDelegate){this._oDelegatePromise.then(function(){d1.call(this);}.bind(this));}else{d1.call(this);}}};if(j.name==="editMode"){b2.call(this);}if(j.name==="multipleLines"){b2.call(this);}if(j.name==="dataType"){if(this._oDataType){var c2=function(f2){var g2=y.call(this,this._oDelegate.getDataTypeClass(this._oPayload,j.current));if(!(this._oDataType instanceof g2)){this._initDataType();this.destroyAggregation("_content");T1.call(this);}};if(!this._oDelegate){this._oDelegatePromise.then(function(){c2.call(this,j.current);}.bind(this));return;}c2.call(this,j.current);}}if(j.name==="dataTypeFormatOptions"||j.name==="dataTypeConstraints"){if(this._oDataType){this._initDataType();this.destroyAggregation("_content");T1.call(this);}}if(j.name==="maxConditions"){b2.call(this);T1.call(this);}if(j.name==="conditions"){this._bParseError=false;P.call(this,j.current,j.old);var d2=false;var i=0;for(i=0;i<this._aAsyncChanges.length;i++){var e2=this._aAsyncChanges[i];if(e2.waitForUpdate&&g(e2.result,j.current)){B1.call(this,e2);d2=true;break;}}if(d2){this._aAsyncChanges.splice(i,1);}}if(j.name==="display"){e1.call(this);T1.call(this);}if(j.name==="fieldHelp"&&j.ids){G1.call(this,j.ids,j.mutation);T1.call(this);}if(j.name==="fieldInfo"&&j.child){R1.call(this,j.child,j.mutation);}if(j.name==="content"&&j.child){$.call(this,j.child,j.mutation,j.name);}if(j.name==="contentEdit"&&j.child){$.call(this,j.child,j.mutation,j.name);}if(j.name==="contentDisplay"&&j.child){$.call(this,j.child,j.mutation,j.name);}if(j.name==="delegate"){_1.call(this,j.current);}if(j.name==="ariaLabelledBy"&&j.ids){Y.call(this,j.ids,j.mutation);}};t.prototype.getFocusDomRef=function(){var i=this._getContent();if(i.length>0){return i[0].getFocusDomRef();}else{return this.getDomRef();}};t.prototype.getIdForLabel=function(){var i;var j=this._getContent();if(j.length>0){i=j[0].getIdForLabel();}else{i=this.getId();}return i;};t.prototype.getControlForSuggestion=function(){var i=this._getContent();if(i.length>0){if(this._bIsMeasure){return i[1];}else{return i[0];}}else{return this;}};t.prototype.getMaxConditionsForHelp=function(){if(this._bIsMeasure){return 1;}else{return this.getMaxConditions();}};t.prototype.enhanceAccessibilityState=function(i,j){var b2=this.getParent();if(b2&&b2.enhanceAccessibilityState){b2.enhanceAccessibilityState(this,j);}return j;};t.prototype.getAccessibilityInfo=function(){var i=this._getContent();if(i.length>0&&i[0].getAccessibilityInfo){return i[0].getAccessibilityInfo();}else{return{};}};function Y(j,b2){var c2=this.getAggregation("_content",[]);var d2=this.getContent();if(d2){c2.push(d2);}d2=this.getContentDisplay();if(d2){c2.push(d2);}d2=this.getContentEdit();if(d2){c2.push(d2);}for(var i=0;i<c2.length;i++){d2=c2[i];if(d2.getMetadata().getAllAssociations().ariaLabelledBy){if(b2==="remove"){d2.removeAriaLabelledBy(j);}else if(b2==="insert"){d2.addAriaLabelledBy(j);}}}}function Z(j){var b2=this.getAriaLabelledBy();for(var i=0;i<b2.length;i++){var c2=b2[i];j.addAriaLabelledBy(c2);}}t.prototype.connectLabel=function(i){g1.call(this,i);i.bindProperty("text",{path:"$field>/label"});i.setLabelFor(this);return this;};function $(i,j,b2){if(j==="remove"){b1.call(this,i);u1.call(this,i);if(this._oContentConditionTypes){delete this._oContentConditionTypes[b2];}i.setModel(null,"$field");}else if(j==="insert"){t1.call(this,i);a1.call(this,i);if(this.getAggregation("_content",[]).length>0){e1.call(this);}if(!this._oContentConditionTypes){this._oContentConditionTypes={};}if(!this._oContentConditionTypes[b2]){this._oContentConditionTypes[b2]={};}var c2;var d2;for(d2 in i.getMetadata().getAllProperties()){if(i.getBindingPath(d2)==="/conditions"){c2=i.getBindingInfo(d2);if(c2&&c2.type&&c2.type instanceof c){this._oContentConditionTypes[b2].oConditionsType=c2.type;}this._sBoundProperty=d2;}if(d2==="editable"&&!i.getBindingPath(d2)&&i.isPropertyInitial(d2)){i.bindProperty(d2,{path:"$field>/editMode",formatter:Q});}if(d2==="enabled"&&!i.getBindingPath(d2)&&i.isPropertyInitial(d2)){i.bindProperty(d2,{path:"$field>/editMode",formatter:T});}if(d2==="displayOnly"&&!i.getBindingPath(d2)&&i.isPropertyInitial(d2)){i.bindProperty(d2,{path:"$field>/editMode",formatter:U});}if(d2==="required"&&!i.getBindingPath(d2)&&i.isPropertyInitial(d2)){i.bindProperty(d2,{path:"$field>/required"});}if(d2==="textAlign"&&!i.getBindingPath(d2)&&i.isPropertyInitial(d2)){i.bindProperty(d2,{path:"$field>/textAlign"});}if(d2==="textDirection"&&!i.getBindingPath(d2)&&i.isPropertyInitial(d2)){i.bindProperty(d2,{path:"$field>/textDirection"});}if(d2==="valueState"&&!i.getBindingPath(d2)&&i.isPropertyInitial(d2)){i.bindProperty(d2,{path:"$field>/valueState"});}if(d2==="valueStateText"&&!i.getBindingPath(d2)&&i.isPropertyInitial(d2)){i.bindProperty(d2,{path:"$field>/valueStateText"});}if(d2==="placeholder"&&!i.getBindingPath(d2)&&i.isPropertyInitial(d2)){i.bindProperty(d2,{path:"$field>/placeholder"});}if(d2==="tooltip"&&!i.getBindingPath(d2)&&i.isPropertyInitial(d2)){i.bindProperty(d2,{path:"$field>/tooltip"});}}for(var e2 in i.getMetadata().getAllAggregations()){if(i.getBindingPath(e2)==="/conditions"){c2=i.getBindingInfo(e2);if(c2&&c2.template){for(d2 in c2.template.getMetadata().getAllProperties()){var f2=c2.template.getBindingInfo(d2);if(f2&&f2.type&&f2.type instanceof b){this._oContentConditionTypes[b2].oConditionType=f2.type;break;}}}break;}}}Z.call(this,i);}function a1(i){if(i.getMetadata().getEvents().change){i.attachEvent("change",A1,this);}if(i.getMetadata().getEvents().liveChange){i.attachEvent("liveChange",D1,this);}if(i.getMetadata().getEvents().press){i.attachEvent("press",E1,this);}}function b1(i){if(i.getMetadata().getEvents().change){i.detachEvent("change",A1,this);}if(i.getMetadata().getEvents().liveChange){i.detachEvent("liveChange",D1,this);}if(i.getMetadata().getEvents().press){i.detachEvent("press",E1,this);}}function c1(){if(this._oConditionType&&!this._oConditionType._bCreatedByField){this._oConditionType=undefined;}if(this._oConditionsType&&!this._oConditionsType._bCreatedByField){this._oConditionsType=undefined;}var i=this.getEditMode();var j;var b2;if(this.getContent()){if(this._oContentConditionTypes.content){j=this._oContentConditionTypes.content.oConditionType;b2=this._oContentConditionTypes.content.oConditionsType;}}else if(i===E.Display&&this.getContentDisplay()){if(this._oContentConditionTypes.contentDisplay){j=this._oContentConditionTypes.contentDisplay.oConditionType;b2=this._oContentConditionTypes.contentDisplay.oConditionsType;}}else if(i!==E.Display&&this.getContentEdit()){if(this._oContentConditionTypes.contentEdit){j=this._oContentConditionTypes.contentEdit.oConditionType;b2=this._oContentConditionTypes.contentEdit.oConditionsType;}}if(j){if(this._oConditionType&&this._oConditionType._bCreatedByField){this._oConditionType.destroy();}this._oConditionType=j;}if(b2){if(this._oConditionsType&&this._oConditionsType._bCreatedByField){this._oConditionsType.destroy();}this._oConditionsType=b2;}T1.call(this);}function d1(){c1.call(this);var j=this.getEditMode();if(this.getContent()||this._bIsBeingDestroyed||(j===E.Display&&this.getContentDisplay())||(j!==E.Display&&this.getContentEdit())){e1.call(this);var b2=this._getContent();if(b2.length===1){g1.call(this,b2[0]);}return;}var c2=A.call(this);var d2=G.call(this);var e2=H.call(this);var f2=this._oDelegate.getBaseType(this._oPayload,c2,e2,d2);var g2=this.getMaxConditions();var h2=this._getOperators();var i2;var j2;var k2;var l2=this.getAggregation("_content",[]);var m2;var n2;if(l2.length>0){m2=l2[0];n2=m2.getMetadata().getName().replace(/\./g,"/");}i2=u[f2];if(!i2){if(this.getFieldInfo()&&this._bTriggerable){i2=u.Link;}else{var o2=new RegExp("^\\*(.*)\\*|\\$search$");if(o2.test(this.getFieldPath())&&this.getMaxConditions()===1){i2=u.Search;}else{i2=u.Default;}}}if(j===E.Display){j2=i2.display;k2=i2.createDisplay;}else if(g2!==1){j2=i2.editMulti;k2=i2.createEditMulti;}else if(this.getMultipleLines()){j2=i2.editMultiLine;k2=i2.createEditMultiLine;}else if(h2.length===1&&i2.editOperator&&i2.editOperator[h2[0]]){j2=i2.editOperator[h2[0]].name;k2=i2.editOperator[h2[0]].create;}else{j2=i2.edit;k2=i2.createEdit;}if(!j2){throw new Error("No control defined for type "+c2+" in "+this);}var p2;if(Array.isArray(j2)){p2=j2;j2=p2[0];}else{p2=[j2];}if(j2!==n2){this._bHideOperator=false;this._bAdjustFormatOptions=false;if(m2){e1.call(this);if(m2.isA("sap.m.DateTimeField")){this._initDataType();}T1.call(this);}var q2;var i=0;for(i=0;i<p2.length;i++){var r2=p2[i];if(!v[r2]){v[r2]={};}if(!v[r2].control){v[r2].control=sap.ui.require(r2);if(!v[r2].control){q2=undefined;}}if(i===0){q2=v[r2].control;}}if(!q2){if(v[j2].promise){v[j2].promise.then(d1.bind(this));return;}else{v[j2].promise=new Promise(function(v2){v[j2].resolve=v2;sap.ui.require(p2,f1.bind(this));}.bind(this)).then(d1.bind(this));return;}}if(x1.call(this,i2,h2,j)){v1.call(this,i2.useDefaultFieldHelp.name);}var s2=this.getId()+"-inner";var t2=k2.call(this,q2,s2);for(i=0;i<t2.length;i++){var u2=t2[i];u2.attachEvent("parseError",y1,this);u2.attachEvent("validationError",z1,this);t1.call(this,u2);g1.call(this,u2);if(this._bConnected&&((i===0&&!this._bIsMeasure)||(i===1&&this._bIsMeasure))){P1.call(this,u2);}this.addAggregation("_content",u2);}}}function e1(){this.destroyAggregation("_content");if(this._oDateOriginalType){this._oDataType=this._oDateOriginalType;this._oDateOriginalType=undefined;}else if(this._oUnitOriginalType){this._oDataType=this._oUnitOriginalType;this._oUnitOriginalType=undefined;}}function f1(){for(var i=0;i<arguments.length;i++){var j=arguments[i];var b2=j.getMetadata().getName();b2=b2.replace(/\./g,"/");v[b2].control=j;if(v[b2].resolve){v[b2].resolve();delete v[b2].resolve;}}}function g1(i){i.setModel(this._oManagedObjectModel,"$field");}function h1(i,j){var b2=V1.call(this);var c2=new i(j,{value:{path:"$field>/conditions",type:b2},placeholder:"{$field>/placeholder}",textAlign:"{$field>/textAlign}",textDirection:"{$field>/textDirection}",required:"{$field>/required}",editable:{path:"$field>/editMode",formatter:Q},enabled:{path:"$field>/editMode",formatter:T},valueState:"{$field>/valueState}",valueStateText:"{$field>/valueStateText}",showValueHelp:"{$field>/_fieldHelpEnabled}",width:"100%",tooltip:"{$field>/tooltip}",change:A1.bind(this),liveChange:D1.bind(this),valueHelpRequest:J1.bind(this),showSuggestion:true});c2._setPreferUserInteraction(true);Q1.call(this,c2);Z.call(this,c2);this._sBoundProperty="value";return[c2];}function i1(i,j){this._bHideOperator=true;var b2=U1.call(this);T1.call(this);var c2=new i(j,{value:{path:"$field>/conditions/0",type:b2,mode:"OneWay"},placeholder:"{$field>/placeholder}",width:"100%",tooltip:"{$field>/tooltip}",search:A1.bind(this)});Z.call(this,c2);return[c2];}function j1(i,j){var b2=sap.ui.require("sap/m/Token");var c2=U1.call(this);var d2=new b2(j+"-token",{text:{path:'$field>',type:c2}});var e2=new i(j,{placeholder:"{$field>/placeholder}",textAlign:"{$field>/textAlign}",textDirection:"{$field>/textDirection}",required:"{$field>/required}",editable:{path:"$field>/editMode",formatter:Q},enabled:{path:"$field>/editMode",formatter:T},valueState:"{$field>/valueState}",valueStateText:"{$field>/valueStateText}",showValueHelp:"{$field>/_fieldHelpEnabled}",width:"100%",tooltip:"{$field>/tooltip}",tokens:{path:"$field>/conditions",template:d2},dependents:[d2],change:A1.bind(this),liveChange:D1.bind(this),tokenUpdate:F1.bind(this),valueHelpRequest:J1.bind(this)});e2._setPreferUserInteraction(true);Q1.call(this,e2);Z.call(this,e2);return[e2];}function k1(i,j){var b2=V1.call(this);var c2=new i(j,{value:{path:"$field>/conditions",type:b2},placeholder:"{$field>/placeholder}",textAlign:"{$field>/textAlign}",textDirection:"{$field>/textDirection}",required:"{$field>/required}",editable:{path:"$field>/editMode",formatter:Q},enabled:{path:"$field>/editMode",formatter:T},valueState:"{$field>/valueState}",valueStateText:"{$field>/valueStateText}",width:"100%",tooltip:"{$field>/tooltip}",change:A1.bind(this),liveChange:D1.bind(this)});c2._setPreferUserInteraction(true);Z.call(this,c2);this._sBoundProperty="value";return[c2];}function l1(i,j){var b2=V1.call(this);var c2=new i(j,{text:{path:"$field>/conditions",type:b2},textAlign:"{$field>/textAlign}",textDirection:"{$field>/textDirection}",wrapping:"{$field>/multipleLines}",width:"100%",tooltip:"{$field>/tooltip}"});this._sBoundProperty="text";return[c2];}function m1(i,j){this._bHideOperator=true;this._bAdjustFormatOptions=true;var b2=V1.call(this);J.call(this);var c2=new i(j,{value:{path:"$field>/conditions",type:b2},displayFormat:this._sDisplayFormat,valueFormat:this._sValueFormat,placeholder:"{$field>/placeholder}",textAlign:"{$field>/textAlign}",textDirection:"{$field>/textDirection}",required:"{$field>/required}",editable:{path:"$field>/editMode",formatter:Q},enabled:{path:"$field>/editMode",formatter:T},valueState:"{$field>/valueState}",valueStateText:"{$field>/valueStateText}",width:"100%",tooltip:"{$field>/tooltip}",change:A1.bind(this)});if(c2.setDisplayFormatType){c2.setDisplayFormatType(this._sCalendarType);}c2._setPreferUserInteraction(true);Z.call(this,c2);this._sBoundProperty="value";return[c2];}function n1(i,j){this._bAdjustFormatOptions=true;var b2=V1.call(this);J.call(this);var c2=new i(j,{value:{path:"$field>/conditions",type:b2},displayFormat:this._sDisplayFormat,valueFormat:this._sValueFormat,delimiter:"...",displayFormatType:this._sCalendarType,placeholder:"{$field>/placeholder}",textAlign:"{$field>/textAlign}",textDirection:"{$field>/textDirection}",required:"{$field>/required}",editable:{path:"$field>/editMode",formatter:Q},enabled:{path:"$field>/editMode",formatter:T},valueState:"{$field>/valueState}",valueStateText:"{$field>/valueStateText}",width:"100%",tooltip:"{$field>/tooltip}",change:A1.bind(this)});c2._setPreferUserInteraction(true);Z.call(this,c2);this._sBoundProperty="value";return[c2];}function o1(i,j){var b2=this.getFieldInfo();var c2=V1.call(this);var d2=new i(j,{text:{path:"$field>/conditions",type:c2},textAlign:"{$field>/textAlign}",textDirection:"{$field>/textDirection}",tooltip:"{$field>/tooltip}",press:E1.bind(this),wrapping:true});if(b2&&b2.getMetadata().getName()==="sap.ui.mdc.field.FieldInfo"){b2.getDirectLinkHrefAndTarget().then(function(e2){if(e2){d2.setHref(e2.href);d2.setTarget(e2.target);}});}Z.call(this,d2);this._sBoundProperty="text";return[d2];}function p1(i,j){return h1.call(this,i,j);}function q1(i,j){N.call(this);this._bIsMeasure=true;var b2=V1.call(this);var c2=[];var d2=new i(j,{value:{path:"$field>/conditions",type:b2},placeholder:"{$field>/placeholder}",textAlign:"{$field>/textAlign}",textDirection:"{$field>/textDirection}",required:"{$field>/required}",editable:{path:"$field>/editMode",formatter:Q},enabled:{path:"$field>/editMode",formatter:T},valueState:"{$field>/valueState}",valueStateText:"{$field>/valueStateText}",showValueHelp:false,width:"70%",tooltip:"{$field>/tooltip}",change:A1.bind(this),liveChange:D1.bind(this)});d2._setPreferUserInteraction(true);Z.call(this,d2);c2.push(d2);c2=s1.call(this,c2,j,i);this._sBoundProperty="value";return c2;}function r1(i,j){N.call(this);this._bIsMeasure=true;var b2=sap.ui.require("sap/m/Token");var c2=sap.ui.require("sap/m/Input");var d2=U1.call(this);var e2=[];var f2=new b2(j+"-token",{text:{path:'$field>',type:d2}});var g2=new n({path:"values",test:function(i2){if(!Array.isArray(i2[0])||i2[0][0]){return true;}else{return false;}}});var h2=new i(j,{placeholder:"{$field>/placeholder}",textAlign:"{$field>/textAlign}",textDirection:"{$field>/textDirection}",required:"{$field>/required}",editable:{path:"$field>/editMode",formatter:Q},enabled:{path:"$field>/editMode",formatter:T},valueState:"{$field>/valueState}",valueStateText:"{$field>/valueStateText}",showValueHelp:false,width:"70%",tooltip:"{$field>/tooltip}",tokens:{path:"$field>/conditions",template:f2,filters:[g2]},dependents:[f2],change:A1.bind(this),liveChange:D1.bind(this),tokenUpdate:F1.bind(this)});h2._setPreferUserInteraction(true);Z.call(this,h2);e2.push(h2);e2=s1.call(this,e2,j,c2);this._sBoundProperty="value";return e2;}function s1(i,j,b2){var c2=W1.call(this);if(this.getEditMode()===E.EditableDisplay){i[0].bindProperty("description",{path:"$field>/conditions",type:c2});i[0].setWidth("100%");i[0].setFieldWidth("70%");}else{var d2=new b2(j+"-unit",{value:{path:"$field>/conditions",type:c2},placeholder:"{$field>/placeholder}",textAlign:"{$field>/textAlign}",textDirection:"{$field>/textDirection}",required:"{$field>/required}",editable:{path:"$field>/editMode",formatter:R},enabled:{path:"$field>/editMode",formatter:T},valueState:"{$field>/valueState}",valueStateText:"{$field>/valueStateText}",showValueHelp:"{$field>/_fieldHelpEnabled}",width:"30%",tooltip:"{$field>/tooltip}",change:A1.bind(this),liveChange:D1.bind(this),valueHelpRequest:J1.bind(this)});d2._setPreferUserInteraction(true);Q1.call(this,d2);Z.call(this,d2);i.push(d2);}return i;}function t1(i){if(i.onsapprevious){i._origOnsapprevious=i.onsapprevious;i.onsapprevious=function(j){var b2=H1.call(this);if(j.keyCode!==K.ARROW_UP&&(!b2||!b2.isOpen())){var i=this._getContent()[0];i._origOnsapprevious(j);}}.bind(this);}if(i.onsapnext){i._origOnsapnext=i.onsapnext;i.onsapnext=function(j){var b2=H1.call(this);if(j.keyCode!==K.ARROW_DOWN&&(!b2||!b2.isOpen())){var i=this._getContent()[0];i._origOnsapnext(j);}}.bind(this);}if(i.onsapup){i._origOnsapup=i.onsapup;i.onsapup=function(j){var b2=H1.call(this);if(!b2||!b2.isOpen()){var i=this._getContent()[0];i._origOnsapup(j);}}.bind(this);}if(i.onsapdown){i._origOnsapdown=i.onsapdown;i.onsapdown=function(j){var b2=H1.call(this);if(!b2||!b2.isOpen()){var i=this._getContent()[0];i._origOnsapdown(j);}}.bind(this);}if(i.onsapbackspace){i._origOnsapbackspace=i.onsapbackspace;i.onsapbackspace=function(j){var b2=H1.call(this);if(!b2||!b2.isOpen()){var i=this._getContent()[0];i._origOnsapbackspace(j);}}.bind(this);}}function u1(i){if(i._origOnsapprevious){i.onsapprevious=i._origOnsapprevious;delete i._origOnsapprevious;}if(i._origOnsapnext){i.onsapnext=i._origOnsapnext;delete i._origOnsapnext;}if(i._origOnsapup){i.onsapup=i._origOnsapup;delete i._origOnsapup;}if(i._origOnsapdown){i.onsapdown=i._origOnsapdown;delete i._origOnsapdown;}if(i._origOnsapbackspace){i.onsapbackspace=i._origOnsapbackspace;delete i._origOnsapbackspace;}}function v1(i){this.setProperty("_fieldHelpEnabled",true,true);this._sDefaultFieldHelp=w[i].id;var j=w[i].control;if(j&&j.bIsDestroyed){w[i].control=undefined;j=undefined;}if(!j){if(w[i].promise){w[i].promise.then(w1.bind(this));}var b2=sap.ui.require(w[i].name);if(!b2&&!w[i].promise){w[i].promise=new Promise(function(c2){w[i].resolve=c2;sap.ui.require([w[i].name],function(d2){v1.call(this,i);}.bind(this));}.bind(this)).then(w1.bind(this));}if(b2){j=new b2(w[i].id,w[i].properties);w[i].control=j;j.connect(this);if(w[i].resolve){w[i].resolve();delete w[i].resolve;}if(!w[i].promise){w1.call(this);}}}else{w1.call(this);}}function w1(){G1.call(this,"BoolDefaultHelp","insert");Q1.call(this,this.getAggregation("_content",[])[0]);}function x1(i,j,b2){if(i.useDefaultFieldHelp&&!this.getFieldHelp()&&b2!==E.Display){if(j.length===1){var c2=a.getOperator(j[0]);var d2=!c2||c2.isSingleValue();if(!(i.editOperator&&i.editOperator[j[0]])&&(i.useDefaultFieldHelp.oneOperator||!d2)){return true;}}else{return true;}}return false;}function y1(i){this._bParseError=true;}function z1(b2){this._bParseError=true;var c2=b2.getParameter("newValue");var d2=false;var i=0;for(i=0;i<this._aAsyncChanges.length;i++){var e2=this._aAsyncChanges[i];if(e2.waitForUpdate&&Array.isArray(e2.result)){for(var j=0;j<e2.result.length;j++){var f2=e2.result[j];if(g(f2.values[0],c2)||(f2.operator==="BT"&&g(f2.values[1],c2))){e2.reject(b2.getParameter("exception"));d2=true;break;}}if(d2){break;}}}if(d2){this._aAsyncChanges.splice(i,1);}}function A1(i){var j={parameters:m({},i.getParameters()),source:i.getSource()};var b2=this._aAsyncChanges.length;if(b2>0&&!this._aAsyncChanges[b2-1].changeFired){this._aAsyncChanges[b2-1].changeFired=true;this._aAsyncChanges[b2-1].changeEvent=j;_.call(this,undefined,undefined,undefined,this._aAsyncChanges[b2-1].promise);return;}var c2={changeEvent:j};B1.call(this,c2);}function B1(i){var j=this.getConditions();var b2;var c2=true;var d2;var e2;var f2=i.changeEvent.source;var g2=false;if(i.changeEvent.parameters.hasOwnProperty("valid")){c2=i.changeEvent.parameters["valid"];if(!c2&&i.changeEvent.parameters.hasOwnProperty("value")){d2=i.changeEvent.parameters["value"];}}var h2=false;var i2=this._sBoundProperty&&f2.getBindingInfo(this._sBoundProperty);if(i2&&i2.binding&&i2.binding.sPath==="/conditions"&&c2){e2=j[0];b2=j[0]&&j[0].values[0];}else if(i.changeEvent.parameters.hasOwnProperty("value")){b2=i.changeEvent.parameters["value"];if(c2){h2=true;}}else if(i.changeEvent.parameters.hasOwnProperty("query")){b2=i.changeEvent.parameters["query"];h2=true;}else{e2=j[0];b2=j[0]&&j[0].values[0];}if(h2){X.call(this);var j2;var k2;e2=S.resolve().then(function(){if(this._oNavigateCondition){c2=true;return this._oNavigateCondition;}else{j2=U1.call(this);var m2=j2.parseValue(b2);var n2=this._aAsyncChanges.length;if(n2>0&&!this._aAsyncChanges[n2-1].changeFired){k2=this._aAsyncChanges[n2-1];k2.changeFired=true;k2.changeEvent=i.changeEvent;_.call(this,undefined,undefined,undefined,k2.promise);}return m2;}}.bind(this)).then(function(e2){C1.call(this,e2,j,j2,c2,b2,f2,k2||i);return e2;}.bind(this)).catch(function(m2){c2=false;d2=b2;W.call(this,m2.message);if(k2&&k2.reject){if($1.call(this,k2)){k2.reject(m2);}}else if(g2){_.call(this,j,c2,d2);}}.bind(this)).unwrap();if(e2 instanceof Promise){g2=true;}}else if(!i.changeEvent.parameters.hasOwnProperty("valid")&&this._bParseError){d2=i.changeEvent.parameters["value"];c2=false;}var l2=H1.call(this);if(l2&&this._bConnected){if(sap.ui.getCore().getCurrentFocusedControlId()===f2.getId()){l2.close();}l2.setFilterValue("");if(!g2&&c2){I1.call(this,j,l2);l2.onFieldChange();}if(this.iLiveChangeTimer){clearTimeout(this.iLiveChangeTimer);}}if(this._oNavigateCondition){this._oNavigateCondition=undefined;T1.call(this);}if(i.resolve){Z1.call(this,i);}else if(!g2){_.call(this,j,c2,d2);}}function C1(i,j,b2,c2,d2,e2,f2){if(b2){b2.validateValue(i);}var g2=this.getMaxConditions();if(c2){if(i){if(this._bIsMeasure&&j.length===1&&j[0].values[0][0]===undefined){j=[];}if(g2!==1&&C.indexOfCondition(i,j)>=0){throw new Error(this._oResourceBundle.getText("field.CONDITION_ALREADY_EXIST",[d2]));}else{if(g2>0&&g2<=j.length){j.splice(0,j.length-g2+1);}j.push(i);}}else if(g2===1){j=[];}if(!g(j,this.getConditions())){this.setProperty("conditions",j,true);}if(g2!==1){e2.setValue("");}}if(f2.resolve){var h2=H1.call(this);if(h2&&this._bConnected){I1.call(this,j,h2);h2.onFieldChange();}f2.result=j;Z1.call(this,f2);$1.call(this,f2);}}function D1(i){var j;var b2;var c2=false;var d2=i.getSource();this._oNavigateCondition=undefined;T1.call(this);if("value"in i.getParameters()){j=i.getParameter("value");}if("escPressed"in i.getParameters()){c2=i.getParameter("escPressed");}if("previousValue"in i.getParameters()){b2=i.getParameter("previousValue");}else{var e2=this.getConditions();b2=e2[0]&&e2[0].values[0];}var f2=H1.call(this);if(f2&&f2.openByTyping()&&(!this._bIsMeasure||d2.getShowValueHelp())){var g2;if(j[0]==="="&&j[1]==="="){g2=j.slice(2);}else if(j[0]==="="){g2=j.slice(1);}else{g2=j;}var h2=this.getDisplay();if(h2!==r.Value){var i2=a.getEEQOperator();var j2=i2.splitText(g2,h2);g2="";if(j2[0]){g2=j2[0];if(j2[1]){g2=g2+" ";}}if(j2[1]){g2=g2+j2[1];}}if(this.iLiveChangeTimer){clearTimeout(this.iLiveChangeTimer);delete this.iLiveChangeTimer;}this.iLiveChangeTimer=setTimeout(function(){if(this._bConnected&&this._getContent()[0]&&(sap.ui.getCore().getCurrentFocusedControlId()===this._getContent()[0].getId()||(this._getContent()[1]&&sap.ui.getCore().getCurrentFocusedControlId()===this._getContent()[1].getId()))){f2.setFilterValue(g2);if(f2.getConditions().length>0){f2.setConditions([]);}f2.open(true);}}.bind(this),300);}this.fireLiveChange({value:j,escPressed:c2,previousValue:b2});}function E1(i){var j=this.getFieldInfo();if(j){j.getTriggerHref().then(function(b2){if(!b2){j.open(this._getContent()[0]);}}.bind(this));}this.firePress();}function F1(j){if(j.getParameter("type")==="removed"){var b2=j.getParameter("removedTokens");var c2=this.getConditions();var d2;var i;for(i=0;i<b2.length;i++){var e2=b2[i];var f2=e2.getBindingContext("$field").sPath;var g2=parseInt(f2.slice(f2.lastIndexOf("/")+1));c2[g2].delete=true;}for(i=c2.length-1;i>=0;i--){if(c2[i].delete){if(this._bIsMeasure){d2=c2[i].values[0][1];}c2.splice(i,1);}}if(this._bIsMeasure&&d2&&c2.length===0){c2=[C.createItemCondition([undefined,d2],undefined)];}this.setProperty("conditions",c2,true);_.call(this,c2,true);j.preventDefault(true);}}function G1(i,j){var b2=sap.ui.getCore().byId(i);if(j==="remove"){if(b2){b2.detachEvent("select",K1,this);b2.detachEvent("navigate",L1,this);b2.detachEvent("dataUpdate",M1,this);b2.detachEvent("disconnect",N1,this);}this.setProperty("_fieldHelpEnabled",false,true);}else if(j==="insert"){if(b2){b2.attachEvent("dataUpdate",M1,this);this.setProperty("_fieldHelpEnabled",true,true);}}P.call(this,this.getConditions());}function H1(){var i=this.getFieldHelp();var j;if(!i&&this._sDefaultFieldHelp){i=this._sDefaultFieldHelp;}if(i){j=sap.ui.getCore().byId(i);}return j;}function I1(j,b2){if(!b2){b2=H1.call(this);}if(this._bIsMeasure){var c2=[];for(var i=0;i<j.length;i++){var d2=j[i];if(d2.values[0]&&d2.values[0][1]){var e2=C.createItemCondition(d2.values[0][1],undefined,d2.inParameters,d2.outParameters);c2.push(e2);}}b2.setConditions(c2);}else{b2.setConditions(j);}}function J1(i){var j=H1.call(this);if(j){j.setFilterValue("");var b2=this.getConditions();I1.call(this,b2,j);j.toggleOpen(false);if(!j.isFocusInHelp()){var c2=i.getSource();if(c2.bValueHelpRequested){c2.bValueHelpRequested=false;}}}}function K1(j){var b2=this.getConditions();var c2=j.getParameter("conditions");var d2=j.getParameter("add");var e2=j.oSource;var f2=this.getMaxConditions();var g2;var h2=this.getControlForSuggestion();var i2;var i=0;if(this._bIsMeasure){if(c2.length>1){throw new Error("Only one item must be selected! "+this);}if(c2[0].operator!=="EEQ"){throw new Error("Only EEQ allowed! "+this);}if(b2.length>0){for(i=0;i<b2.length;i++){b2[i].values[0][1]=c2[0].values[0];if(b2[i].operator==="BT"){b2[i].values[1][1]=c2[0].values[0];}if(c2[0].inParameters){b2[i].inParameters=c2[0].inParameters;}if(c2[0].outParameters){b2[i].outParameters=c2[0].outParameters;}}}else{g2=m({},c2[0]);g2.values[0]=[undefined,g2.values[0]];g2.values[1]=undefined;b2.push(g2);if(this._oConditionType){i2=this._oConditionType.formatValue(g2);}else if(this._oConditionsType){i2=this._oConditionsType.formatValue(b2);}}}else{if(!d2){b2=[];}for(i=0;i<c2.length;i++){g2=c2[i];if(!a2.call(this,g2.operator)){continue;}if(!d2||C.indexOfCondition(g2,b2)===-1){b2.push(g2);}}}if(f2>0&&f2<b2.length){b2.splice(0,b2.length-f2);}if(h2&&h2.setDOMValue){if(this.getMaxConditionsForHelp()===1&&b2.length>0){if(this._bIsMeasure&&this._oUnitConditionsType){i2=this._oUnitConditionsType.formatValue(b2);}else if(this._oConditionType){i2=this._oConditionType.formatValue(b2[0]);}else if(this._oConditionsType){i2=this._oConditionsType.formatValue(b2);}h2.setDOMValue(i2);}else{h2.setDOMValue("");}}if(!g(b2,this.getConditions())){this._oNavigateCondition=undefined;T1.call(this);this.setProperty("conditions",b2,true);e2.onFieldChange();_.call(this,b2,true);}}function L1(i){var j=i.getParameter("value");var b2=i.getParameter("key");var c2=i.getParameter("condition");var d2;var e2;var f2=this.getControlForSuggestion();if(c2){this._oNavigateCondition=m({},c2);b2=c2.values[0];j=c2.values[1];}else{this._oNavigateCondition=C.createItemCondition(b2,j);}if(this._bIsMeasure){var g2=this.getConditions();if(g2.length>0){this._oNavigateCondition.operator=g2[0].operator;this._oNavigateCondition.values[0]=[g2[0].values[0][0],this._oNavigateCondition.values[0]];if(g2[0].operator==="BT"){this._oNavigateCondition.values[1]=[g2[0].values[1][0],this._oNavigateCondition.values[0][1]];}else{this._oNavigateCondition.values[1]=undefined;}}else{this._oNavigateCondition.values=[[undefined,this._oNavigateCondition.values[0]],undefined];}}T1.call(this);if(this.getDisplay()!==r.Value){d2=b2;}else if(j){d2=j;}else{d2=b2;}if(f2&&f2.setDOMValue){if(!e2){if(this._bIsMeasure&&this._oUnitConditionsType&&this._oNavigateCondition){e2=this._oUnitConditionsType.formatValue([this._oNavigateCondition]);}else if(this._oConditionType&&this._oNavigateCondition){e2=this._oConditionType.formatValue(this._oNavigateCondition);}else if(this._oConditionsType&&this._oNavigateCondition){e2=this._oConditionsType.formatValue([this._oNavigateCondition]);}else{e2=j||b2;}}f2.setDOMValue(e2);f2._doSelect();}this.fireLiveChange({value:d2});}function M1(i){var j=this.getEditMode()===E.Editable&&this._getContent().length>0&&sap.ui.getCore().getCurrentFocusedControlId()===this._getContent()[0].getId();if(!j&&this.getConditions().length>0&&(this.getMaxConditions()!==1||(this.getDisplay()!==r.Value&&!this._bParseError))){this._oManagedObjectModel.checkUpdate(true);}}function N1(i){var j=H1.call(this);j.detachEvent("select",K1,this);j.detachEvent("navigate",L1,this);j.detachEvent("disconnect",N1,this);this._bConnected=false;}function O1(){var i=H1.call(this);if(i&&!this._bConnected){i.connect(this);this._bConnected=true;i.attachEvent("select",K1,this);i.attachEvent("navigate",L1,this);i.attachEvent("disconnect",N1,this);var j=this.getConditions();I1.call(this,j,i);var b2=this.getControlForSuggestion();P1.call(this,b2);}}function P1(i){if(i&&!i.orgOnsapfocusleave&&i.onsapfocusleave){i.orgOnsapfocusleave=i.onsapfocusleave;i.onsapfocusleave=function(j){var b2=H1.call(this.getParent());if(b2){var c2=sap.ui.getCore().byId(j.relatedControlId);if(c2){if(k(b2.getDomRef(),c2.getFocusDomRef())){j.stopPropagation();return;}else{b2.skipOpening();}}}this.orgOnsapfocusleave(j);};}}function Q1(i){var j=H1.call(this);if(j&&i&&i.addEndIcon){var b2=j.getIcon();var c2=i.getAggregation("_endIcon",[])[0];if(c2){c2.setSrc(b2);}else{i.addEndIcon({id:i.getId()+"-vhi",src:b2,useIconTooltip:false,noTabStop:true,press:function(d2){if(!this.getValueHelpOnly()){var e2;if(D.support.touch){e2=this.$('inner');e2.attr('readonly','readonly');this.focus();e2.removeAttr('readonly');}else{this.focus();}this.bValueHelpRequested=true;this.fireValueHelpRequest({fromSuggestions:false});}}.bind(i)});}}}function R1(i,j){if(j==="remove"){i.detachEvent("dataUpdate",S1,this);}else if(j==="insert"){i.attachEvent("dataUpdate",S1,this);S1.call(this);}}function S1(){var i=this.getFieldInfo();var j=this;i.isTriggerable().then(function(b2){j._bTriggerable=b2;if(j.getAggregation("_content",[]).length>0&&j.getEditMode()===E.Display){d1.call(j);i.getDirectLinkHrefAndTarget().then(function(c2){if(c2){j.getAggregation("_content")[0].setHref(c2.href);j.getAggregation("_content")[0].setTarget(c2.target);}});}});}t.prototype._getFormatOptions=function(){if(!this._asyncParsingCall){this._asyncParsingCall=Y1.bind(this);}return{valueType:z.call(this),originalDateType:this._oDateOriginalType||this._oUnitOriginalType,display:this._bIsMeasure?r.Value:this.getDisplay(),fieldHelpID:this._bIsMeasure?undefined:this.getFieldHelp()||this._sDefaultFieldHelp,operators:this._getOperators(),hideOperator:this._bHideOperator,maxConditions:this.getMaxConditions(),bindingContext:this.getBindingContext(),asyncParsing:this._asyncParsingCall,navigateCondition:this._oNavigateCondition,delegate:this._oDelegate,delegateName:this.getDelegate()&&this.getDelegate().name,payload:this._oPayload};};function T1(){if(this._oConditionType||this._oConditionsType){var i=this._getFormatOptions();if(this._oConditionType){this._oConditionType.setFormatOptions(i);}if(this._oConditionsType){this._oConditionsType.setFormatOptions(i);}if(this._oUnitConditionsType){i=X1.call(this);this._oUnitConditionsType.setFormatOptions(i);}}}function U1(){if(!this._oConditionType){var i=this._getFormatOptions();this._oConditionType=new b(i);this._oConditionType._bCreatedByField=true;}return this._oConditionType;}function V1(){if(!this._oConditionsType){var i=this._getFormatOptions();this._oConditionsType=new c(i);this._oConditionsType._bCreatedByField=true;}return this._oConditionsType;}t.prototype._checkValueInitial=function(i){if(i===null||i===undefined){return true;}if(i===""){var j=z.call(this);var b2=j.parseValue(i,"string");if(b2===i){return true;}else{try{j.validateValue(b2);}catch(c2){return true;}}}else{var d2=A.call(this);if(this._oDelegate.getBaseType(this._oPayload,d2)===B.Unit&&Array.isArray(i)&&i.length>1&&(i[0]===undefined||i[0]===null)&&!i[1]){return true;}}return false;};function W1(){if(!this._oUnitConditionsType){var i=X1.call(this);this._oUnitConditionsType=new c(i);this._oUnitConditionsType._bCreatedByField=true;}return this._oUnitConditionsType;}function X1(){if(!this._asyncParsingCall){this._asyncParsingCall=Y1.bind(this);}return{valueType:undefined,originalDateType:z.call(this),display:this.getDisplay(),fieldHelpID:this.getFieldHelp()||this._sDefaultFieldHelp,operators:["EEQ"],hideOperator:true,maxConditions:1,bindingContext:this.getBindingContext(),asyncParsing:this._asyncParsingCall,navigateCondition:this._oNavigateCondition,delegate:this._oDelegate,payload:this._oPayload,isUnit:true,getConditions:this.getConditions.bind(this)};}function Y1(i){var j=H1.call(this);if(j&&j.isOpen()){var b2=document.activeElement;if(b2&&(k(this.getDomRef(),b2)||k(j.getDomRef(),b2))){j.close();}}var c2={};var d2=new Promise(function(e2,f2){c2.resolve=e2;c2.reject=f2;i.then(function(g2){c2.result=g2;var h2=this.getConditions();if(g(g2,h2)){Z1.call(this,c2);$1.call(this,c2);}else{c2.waitForUpdate=true;}}.bind(this)).catch(function(g2){this._bParseError=true;f2(g2);$1.call(this,c2);}.bind(this));}.bind(this));c2.promise=d2;this._aAsyncChanges.push(c2);}t.prototype._getResultForPromise=function(i){return i;};function Z1(i){i.resolve(this._getResultForPromise(i.result));}function $1(j){var b2=false;var i=0;for(i=0;i<this._aAsyncChanges.length;i++){if(j===this._aAsyncChanges[i]){b2=true;break;}}if(b2){this._aAsyncChanges.splice(i,1);}return b2;}function _1(i){if(this._oDelegate||this._oDelegateLoading){throw new Error("Delegate can only be set once");}this._oDelegate=sap.ui.require(i.name);this._oPayload=i.payload||{};if(this._oDelegate){this._oDelegateResolve();delete this._oDelegateResolve;delete this._oDelegateReject;}else{this._oDelegateLoading=true;sap.ui.require([i.name],function(j){this._oDelegate=j;this._oDelegateResolve();delete this._oDelegateResolve;delete this._oDelegateReject;delete this._oDelegateLoading;}.bind(this),function(){this._oDelegateReject("Failed to load delegate");delete this._oDelegateResolve;delete this._oDelegateReject;delete this._oDelegateLoading;}.bind(this));}}t.prototype._getOperators=function(){var i=A.call(this);var j=G.call(this);var b2=H.call(this);var c2=this._oDelegate.getBaseType(this._oPayload,i,b2,j);if(c2===B.Unit){c2=B.Numeric;}return a.getOperatorsForType(c2);};function a2(j){var b2=this._getOperators();for(var i=0;i<b2.length;i++){if(j===b2[i]){return true;}if(j==="EQ"&&b2[i]==="EEQ"){return true;}if(j==="EEQ"&&b2[i]==="EQ"){return true;}}return false;}return t;});
