/*
 * ! SAPUI5

		(c) Copyright 2009-2020 SAP SE. All rights reserved
	
 */
sap.ui.define(['sap/ui/mdc/library','sap/ui/mdc/field/FieldHelpBase','sap/ui/mdc/condition/Condition','sap/ui/base/ManagedObjectObserver','sap/base/util/ObjectPath','sap/base/util/deepEqual','sap/base/util/merge','sap/ui/model/resource/ResourceModel'],function(l,F,C,M,O,d,m,R){"use strict";var a=l.OutParameterMode;var D;var B;var V;var b;var c;var e;var f;var g=F.extend("sap.ui.mdc.field.FieldValueHelp",{metadata:{library:"sap.ui.mdc",properties:{filterFields:{type:"string",defaultValue:"$search"},keyPath:{type:"string",defaultValue:""},descriptionPath:{type:"string",defaultValue:""},showConditionPanel:{type:"boolean",defaultValue:false},title:{type:"string",group:"Appearance",defaultValue:""},noDialog:{type:"boolean",group:"Appearance",defaultValue:false}},aggregations:{content:{type:"sap.ui.mdc.field.FieldValueHelpContentWrapperBase",multiple:false},filterBar:{type:"sap.ui.mdc.FilterBar",multiple:false},inParameters:{type:"sap.ui.mdc.field.InParameter",group:"Data",multiple:true},outParameters:{type:"sap.ui.mdc.field.OutParameter",group:"Data",multiple:true},_dialog:{type:"sap.m.Dialog",multiple:false,visibility:"hidden"}},defaultAggregation:"content",events:{dataRequested:{}}}});g._init=function(){F._init.apply(this,arguments);D=undefined;B=undefined;V=undefined;b=undefined;c=undefined;e=undefined;f=undefined;};g.prototype.init=function(){F.prototype.init.apply(this,arguments);this._oObserver=new M(h.bind(this));this._oObserver.observe(this,{properties:["filterValue","conditions","showConditionPanel","title","filterFields"],aggregations:["content","filterBar","inParameters"]});};g.prototype.exit=function(){F.prototype.exit.apply(this,arguments);if(this._oManagedObjectModel){this._oManagedObjectModel.destroy();delete this._oManagedObjectModel;}if(this._oFilterConditionModel){this._oFilterConditionModel.destroy();delete this._oFilterConditionModel;}this._oObserver.disconnect();this._oObserver=undefined;};g.prototype.invalidate=function(i){if(i){var j=this.getAggregation("_dialog");var h1=this.getFilterBar();if((j&&i===j)||(h1&&i===h1)){if(i.bOutput&&!this._bIsBeingDestroyed){var i1=this.getParent();if(i1){i1.invalidate(this);}}return;}}F.prototype.invalidate.apply(this,arguments);};g.prototype.connect=function(i){F.prototype.connect.apply(this,arguments);f1.call(this);a1.call(this,this.getShowConditionPanel());return this;};g.prototype.getIcon=function(){if(this.getNoDialog()){return"sap-icon://slim-arrow-down";}else{return"sap-icon://value-help";}};g.prototype._createPopover=function(){var i=F.prototype._createPopover.apply(this,arguments);if(i){var j=this.getContent();if(j){j.initialize(true);}i._getAllContent=function(){var h1=this.getParent();var i1=[];if(h1){var j1=e1.call(h1);if(j1){i1.push(j1);}}return i1;};if(this._bNavigate){this._bNavigate=false;this.navigate(this._iStep);this._iStep=null;}}return i;};g.prototype._handleAfterOpen=function(i){F.prototype._handleAfterOpen.apply(this,arguments);var j=this.getContent();if(j){j.fieldHelpOpen(true);}};g.prototype.open=function(i){if(this.getNoDialog()&&!i){i=true;}this._bUseFilterBar=!i;f1.call(this);var j=this.getContent();if(j&&j.getFilterEnabled()&&!this._bNavigateRunning){if(!j.isSuspended()){this._bApplyFilter=true;}if(!this._oFilterConditionModel){L.call(this);}else{y.call(this);}}if(this._bUpdateFilterAfterClose){this._bUpdateFilterAfterClose=false;s.call(this,this.getFilterValue());}var h1=this.getAggregation("_popover");if(i){this._bApplyFilter=true;d1.call(this);if(!j){this._bOpenIfContent=true;this.fireOpen({suggestion:i});}else{j.fieldHelpOpen(i);if(this._oFilterConditionModel&&!this.getFilterValue()&&!this._bNavigateRunning){this._oFilterConditionModel.checkUpdate(true,true);}F.prototype.open.apply(this,[i]);}}else{c1.call(this);if(h1){if(h1.isOpen()){this.close();}h1.$().remove();}var i1=W.call(this);if(i1){var j1=i1.getContent()[0];j1.setShowTokenizer(this.getMaxConditions()!==1&&!!j);j1.setFormatOptions(this._getFormatOptions());j1.bindProperty("conditions",{path:"$help>/conditions"});var k1=this.getFilterFields();if(k1){j1.bindProperty("filterConditions",{path:"filter>/conditions/"+k1});}this.fireOpen({suggestion:i});if(j){j.fieldHelpOpen(false);r.call(this);}this._aOldConditions=this.getConditions();i1.open();}else{this._bOpen=true;}}return;};g.prototype.toggleOpen=function(i){if(this.getNoDialog()&&!i){i=true;}if(i){F.prototype.toggleOpen.apply(this,[i]);}else{var j=W.call(this);if(j){if(j.isOpen()){var h1=j.oPopup.getOpenState();if(h1!=="CLOSED"&&h1!=="CLOSING"){this.close();}else{this._bReopen=true;}}else{this.open(i);}}else{this._bOpen=!this._bOpen;}}};g.prototype.close=function(){if(!this._bDialogOpen){F.prototype.close.apply(this,arguments);}else{this._bUseFilterBar=false;var i=this.getAggregation("_dialog");if(i){this._bClosing=true;i.close();var j=i.getContent()[0];j.unbindProperty("conditions",true);j.unbindProperty("filterConditions",true);}this._bReopen=false;}};g.prototype.isOpen=function(i){var j=F.prototype.isOpen.apply(this,arguments);if(!j&&(!i||!this._bClosing)){var h1=this.getAggregation("_dialog");if(h1){j=h1.isOpen();}}return j;};function _(){if(!this._oFilterConditionModel){return;}var i=this._oFilterConditionModel.getAllConditions();var j=false;for(var h1 in i){if(i[h1].length>0){j=true;break;}}if(j){this._oFilterConditionModel.removeAllConditions();}}g.prototype._handleAfterClose=function(i){F.prototype._handleAfterClose.apply(this,arguments);var j=this.getContent();if(j){if(!j.getAsyncKeyText()){_.call(this);}j.fieldHelpClose();}this._bApplyFilter=false;};function h(i){if(i.object==this){var j;if(i.name==="content"){U.call(this,i.mutation,i.child);}if(i.name==="filterBar"){b1.call(this,i.mutation,i.child);}if(i.name==="conditions"){q.call(this,i.current);}if(i.name==="filterValue"){if(this._bClosing){this._bUpdateFilterAfterClose=true;}else{s.call(this,i.current);}}if(i.name==="showConditionPanel"){a1.call(this,i.current);}if(i.name==="title"){j=this.getAggregation("_dialog");if(j){j.setTitle(i.current);}}if(i.name==="filterFields"){j=this.getAggregation("_dialog");if(j){var h1=j.getContent()[0];h1.setSearchEnabled(!!i.current);if(j.isOpen()){if(i.current){h1.bindProperty("filterConditions",{path:"filter>/conditions/"+i.current});}else{h1.unbindProperty("filterConditions",true);}}}}if(i.name==="inParameters"){t.call(this,i.child,i.mutation);}}else if(i.object.isA("sap.ui.mdc.field.InParameter")){if(i.name==="value"){w.call(this,i.object.getHelpPath(),i.current,i.old,i.object.getUseConditions());}if(i.name==="helpPath"){x.call(this,i.current,i.old,i.object.getValue(),i.object.getUseConditions());}}}g.prototype.openByTyping=function(){return!!this.getFilterFields();};g.prototype.isFocusInHelp=function(){if(!this.getNoDialog()){var i=this.getAggregation("_dialog");if((i&&i.isOpen())||(this._bDialogRequested&&this._bOpen)){return true;}}return false;};g.prototype.navigate=function(i){var j=this.getContent();var h1;f1.call(this);if(j){h1=this._getPopover();this._bApplyFilter=true;this._bNavigateRunning=true;if(!this._oFilterConditionModel){L.call(this);}else{y.call(this);}this._oFilterConditionModel.checkUpdate(true,true);}if(!h1){this._bNavigate=true;this._iStep=i;if(!j){this.fireOpen({suggestion:true});}return;}else if(!h1.isOpen()){this.fireOpen({suggestion:true});}if(j){j.navigate(i);}};function k(i){var j=this._getPopover();var h1=i.getParameter("key");var i1=i.getParameter("description");var j1=i.getParameter("inParameters");var k1=i.getParameter("outParameters");var l1;if(!j.isOpen()){this.open(true);}this._bNavigateRunning=false;l1=C.createItemCondition(h1,i1);if(j1){l1.inParameters=z.call(this,j1);}if(k1){l1.outParameters=A.call(this,k1);}this.setProperty("conditions",[l1],true);this.fireNavigate({value:i1,key:h1,condition:l1});}g.prototype.getTextForKey=function(i,j,h1,i1){var j1="";var k1=this.getContent();if(k1){var l1=k1.getListBinding();if(!l1){this.fireDataRequested();}var m1=this.getBindingContext();var n1=false;if(!this.isOpen()&&i1&&m1!==i1&&((!j&&this.getInParameters().length>0)||(!h1&&this.getOutParameters().length>0))){n1=true;this._bNoInOutFilterUpdate=true;this.setBindingContext(i1);}j1=k1.getTextForKey(i,G.call(this,j),H.call(this,h1,true));if(j1 instanceof Promise){var o1=j1;j1=new Promise(function(q1,r1){o1.then(function(j1){q1(n.call(this,j1));}.bind(this)).catch(function(s1){r1(s1);});}.bind(this));}else{j1=n.call(this,j1);}if(n1){var p1=this._getField();if(p1){this.setBindingContext(p1.getBindingContext());}this._bNoInOutFilterUpdate=false;}}return j1;};g.prototype.getKeyForText=function(i,j){var h1;var i1=this.getContent();if(i1){var j1=i1.getListBinding();if(!j1){this.fireDataRequested();}var k1=this.getBindingContext();var l1=false;if(!this.isOpen()&&j&&k1!==j&&this.getInParameters().length>0){l1=true;this._bNoInOutFilterUpdate=true;this.setBindingContext(j);}h1=i1.getKeyForText(i,G.call(this));if(h1 instanceof Promise){var m1=h1;h1=new Promise(function(o1,p1){m1.then(function(h1){o1(n.call(this,h1));}.bind(this)).catch(function(q1){p1(q1);});}.bind(this));}else{h1=n.call(this,h1);}if(l1){var n1=this._getField();if(n1){this.setBindingContext(n1.getBindingContext());}this._bNoInOutFilterUpdate=false;}}return h1;};function n(i){if(i&&typeof i==="object"){i=m({},i);if(i.inParameters){i.inParameters=z.call(this,i.inParameters);}if(i.outParameters){i.outParameters=A.call(this,i.outParameters);}}return i;}g.prototype.isUsableForValidation=function(){var i=this.getContent();return!!i;};function o(h1){var i1=h1.getParameter("selectedItems");var j1;var k1=this.getConditions();var l1;var i=0;var j=0;var m1=false;var n1=this.getMaxConditions();for(i=k1.length-1;i>=0;i--){l1=k1[i];l1.inParameters=G.call(this,l1.inParameters);l1.outParameters=H.call(this,l1.outParameters);if(l1.operator==="EEQ"){m1=false;for(j=0;j<i1.length;j++){j1=i1[j];if(l1.values[0]===j1.key&&(!l1.inParameters||!j1.inParameters||d(l1.inParameters,j1.inParameters))&&(!l1.outParameters||!j1.outParameters||d(l1.outParameters,j1.outParameters))){m1=true;break;}}if(!m1){k1.splice(i,1);}}}for(i=0;i<i1.length;i++){j1=i1[i];m1=false;for(j=0;j<k1.length;j++){l1=k1[j];if(l1.operator==="EEQ"&&l1.values[0]===j1.key&&(!l1.inParameters||d(l1.inParameters,j1.inParameters))&&(!l1.outParameters||d(l1.outParameters,j1.outParameters))){m1=true;l1.inParameters=j1.inParameters;l1.outParameters=j1.outParameters;break;}}if(!m1){l1=C.createItemCondition(j1.key,j1.description,j1.inParameters,j1.outParameters);k1.push(l1);}}if(n1>0&&k1.length>n1){k1.splice(0,k1.length-n1);}for(i=0;i<k1.length;i++){l1=k1[i];if(l1.inParameters){l1.inParameters=z.call(this,l1.inParameters);}else{delete l1.inParameters;}if(l1.outParameters){l1.outParameters=A.call(this,l1.outParameters);}else{delete l1.outParameters;}}if(this._bDialogOpen){this.setProperty("conditions",k1,true);}else{this.close();this.setProperty("conditions",k1,true);this.fireSelect({conditions:k1,add:true});}}function p(i){var j=i.getParameter("contentChange");var h1=this.getContent();var i1=h1.getAsyncKeyText();if(j){var j1=this.getAggregation("_popover");var k1=this.getAggregation("_dialog");if(h1){if(h1.getFilterEnabled()&&!this._oFilterConditionModel&&((j1&&this._bOpenIfContent)||k1)){L.call(this);}if(j1&&this._bOpenIfContent){var l1=this._getField();if(l1){h1.fieldHelpOpen(true);j1.openBy(this._getControlForSuggestion());J.call(this);}this._bOpenIfContent=false;}else if(k1){var m1=k1.getContent()[0];T.call(this,m1,h1.getDialogContent());}}}if(!i1){this.fireDataUpdate();}}function q(i){r.call(this);}function r(){if(!this._oField){return;}var j=this.getContent();if(j){var h1=this.getConditions();var i1=[];for(var i=0;i<h1.length;i++){var j1=h1[i];if(j1.operator==="EEQ"){i1.push({key:j1.values[0],description:j1.values[1],inParameters:G.call(this,j1.inParameters),outParameters:H.call(this,j1.outParameters)});}}if(!d(i1,j.getSelectedItems())){j.setSelectedItems(i1);}}}function s(i){if(!this._oFilterConditionModel){return;}var j=this.getFilterFields();if(!j){return;}if(i){this._bOwnFilterChange=true;}this._oFilterConditionModel.removeAllConditions(j);i=i.trim();if(i){this._bOwnFilterChange=false;var h1=C.createCondition("StartsWith",[i]);this._oFilterConditionModel.addCondition(j,h1);}}function t(i,j){var h1=i.getHelpPath();var i1=false;if(j==="remove"){this._oObserver.unobserve(i);if(this._getField()&&this.isOpen()){i1=v.call(this,h1);}}else{this._oObserver.observe(i,{properties:true});if(this._getField()&&this.isOpen()){var j1=i.getValue();var k1=i.getUseConditions();i1=v.call(this,h1);i1=u.call(this,h1,j1,k1)||i1;r.call(this);}}}function u(j,h1,i1){var j1;var k1;var l1;var m1=false;if(this._oFilterConditionModel&&j&&h1){j1=this.getFilterBar();if(this._bUseFilterBar&&j1){k1=j1.getConditions();if(!k1[j]){k1[j]=[];}}if(i1){if(Array.isArray(h1)){for(var i=0;i<h1.length;i++){l1=m({},h1[i]);if(l1.inParameters){l1.inParameters=G.call(this,l1.inParameters);}if(l1.outParameters){l1.outParameters=H.call(this,l1.outParameters);}this._oFilterConditionModel.addCondition(j,l1);if(this._bUseFilterBar&&j1){k1[j].push(h1[i]);}m1=true;}}}else{l1=C.createItemCondition(h1);this._oFilterConditionModel.addCondition(j,l1);if(this._bUseFilterBar&&j1){k1[j].push(l1);}m1=true;}}if(m1&&this._bUseFilterBar&&j1){j1.setConditions(k1);}return m1;}function v(i){var j=false;if(this._oFilterConditionModel&&i&&this._oFilterConditionModel.getConditions(i).length>0){this._oFilterConditionModel.removeAllConditions(i);j=true;}var h1=this.getFilterBar();if(this._bUseFilterBar&&h1){var i1=h1.getConditions();if(i1[i]&&i1[i].length>0){i1[i]=[];h1.setConditions(i1);j=true;}}return j;}function w(i,j,h1,i1){if(this._bNoInOutFilterUpdate){return;}if(!this.sUpdateTimer){this.sUpdateTimer=setTimeout(function(){this.sUpdateTimer=undefined;this.fireDataUpdate();}.bind(this),0);}if(!this._getField()||!this.isOpen()){return;}var j1=false;j1=v.call(this,i);j1=u.call(this,i,j,i1)||j1;}function x(i,j,h1,i1){if(!this._getField()||!this.isOpen()){return;}var j1=false;j1=v.call(this,j);j1=u.call(this,i,h1,i1)||j1;}function y(){var j=this.getInParameters();var h1=false;for(var i=0;i<j.length;i++){var i1=j[i];var j1=i1.getHelpPath();var k1=i1.getValue();var l1=i1.getUseConditions();h1=v.call(this,j1)||h1;h1=u.call(this,j1,k1,l1)||h1;}}g.prototype.onFieldChange=function(){var h1=this.getOutParameters();var i1=this.getConditions();f1.call(this);for(var i=0;i<i1.length;i++){var j1=i1[i];if(j1.outParameters){for(var k1 in j1.outParameters){for(var j=0;j<h1.length;j++){var l1=h1[j];var m1=l1.getValue();var n1=l1.getUseConditions();var o1=true;if(l1.getMode()===a.WhenEmpty){if(n1){o1=!m1||(Array.isArray(m1)&&m1.length===0);}else{o1=!m1;}}if(o1){if(n1){var p1;if(!l1.getHelpPath()){p1=C.createCondition("EEQ",[l1.getFixedValue()]);}else if(l1.getFieldPath()===k1){p1=C.createCondition("EEQ",[j1.outParameters[k1]]);}else{continue;}if(!m1){m1=[];}if(!Array.isArray(m1)){throw new Error("Value on OutParameter must be an array "+l1);}if(C.indexOfCondition(p1,m1)<0){m1.push(p1);l1.setValue(m1);}}else{if(!l1.getHelpPath()){l1.setValue(l1.getFixedValue());}else if(l1.getFieldPath()===k1){l1.setValue(j1.outParameters[k1]);}}}}}}}};function z(i){return E.call(this,i,this.getInParameters());}function A(i){return E.call(this,i,this.getOutParameters());}function E(j,h1){if(!j||h1.length===0){return null;}var i1={};for(var i=0;i<h1.length;i++){var j1=h1[i];var k1=j1.getHelpPath();var l1=j1.getFieldPath();if(k1&&l1){for(var m1 in j){if(k1===m1){i1[l1]=j[m1];break;}}}else if(!k1&&l1&&j1.getFixedValue){i1[l1]=j1.getFixedValue();}}return i1;}function G(i){return I.call(this,i,this.getInParameters());}function H(i,j){return I.call(this,i,this.getOutParameters(),j);}function I(j,h1,i1){var j1;var k1;var l1;var m1;var i=0;if(h1.length>0){if(!j){if(!i1){for(i=0;i<h1.length;i++){k1=h1[i];l1=k1.getHelpPath();var n1=k1.getValue();if(l1&&n1){if(!j1){j1={};}if(k1.getUseConditions()){if(n1.length>0){j1[l1]=n1[0]&&n1[0].values[0];}}else{j1[l1]=n1;}}}}}else{for(var o1 in j){for(i=0;i<h1.length;i++){k1=h1[i];l1=k1.getHelpPath();m1=k1.getFieldPath();if(m1&&m1===o1&&l1){if(!j1){j1={};}j1[l1]=j[o1];}}}}}return j1;}function J(){if(!this._oFilterConditionModel||(!this.isOpen()&&!this._bNavigateRunning&&!this._bOpen)||!this._bApplyFilter){return;}var i=this.getContent();if(i){var j=this._oFilterConditionModel.getFilters();var h1=[];var i1=this._oFilterConditionModel.getConditions("$search");var j1;if(j){h1.push(j);}if(i1.length>0){j1=i1[0].values[0];}i.applyFilters(h1,j1);}}function K(i){if(this._bOwnFilterChange){return;}J.call(this);}function L(){if(!c&&!this._bFilterConditionModelRequested){c=sap.ui.require("sap/ui/mdc/condition/ConditionModel");if(!c){sap.ui.require(["sap/ui/mdc/condition/ConditionModel"],N.bind(this));this._bFilterConditionModelRequested=true;}}if(c){var i=this.getFilterValue();this._oFilterConditionModel=new c();if(i){s.call(this,i);}y.call(this);var j=this._oFilterConditionModel.bindProperty("/conditions",this._oFilterConditionModel.getContext("/conditions"));j.attachChange(K.bind(this));this.setModel(this._oFilterConditionModel,"filter");}}function N(i){c=i;this._bFilterConditionModelRequested=false;if(!this._bIsBeingDestroyed){L.call(this);}}g.prototype.getMaxConditions=function(){if(this._oField&&this._oField.getMaxConditionsForHelp){return this._oField.getMaxConditionsForHelp();}else if(this._oField&&this._oField.getMaxConditions){return this._oField.getMaxConditions();}else{return 1;}};g.prototype.getDisplay=function(){if(this._oField&&this._oField.getDisplay){return this._oField.getDisplay();}};g.prototype.getRequired=function(){if(this._oField&&this._oField.getRequired){return this._oField.getRequired();}else{return false;}};g.prototype.getDataType=function(){if(this._oField.getDataType){return this._oField.getDataType();}else{return"sap.ui.model.type.String";}};g.prototype._getFormatOptions=function(){if(this._oField&&this._oField._getFormatOptions){return this._oField._getFormatOptions();}else{return{};}};g.prototype._getKeyPath=function(){var i=this.getKeyPath();if(!i&&this._oField&&this._oField.getFieldPath&&this._oField.getFieldPath()){i=this._oField.getFieldPath();}return i;};g.prototype.clone=function(i,j){var h1=this.getContent();var i1=this.getFilterBar();if(h1){h1.detachEvent("navigate",k,this);h1.detachEvent("selectionChange",o,this);h1.detachEvent("dataUpdate",p,this);}if(i1){i1.detachEvent("search",c1,this);}var j1=F.prototype.clone.apply(this,arguments);if(h1){h1.attachEvent("navigate",k,this);h1.attachEvent("selectionChange",o,this);h1.attachEvent("dataUpdate",p,this);}if(i1){i1.attachEvent("search",c1,this);}return j1;};function P(){var i;if((!D||!B||!V||!b)&&!this._bDialogRequested){D=sap.ui.require("sap/m/Dialog");B=sap.ui.require("sap/m/Button");V=sap.ui.require("sap/ui/mdc/field/ValueHelpPanel");b=sap.ui.require("sap/ui/mdc/field/DefineConditionPanel");e=sap.ui.require("sap/ui/model/base/ManagedObjectModel");f=sap.ui.require("sap/ui/mdc/condition/FilterOperatorUtil");if(!D||!B||!V||!b||!e||!f){sap.ui.require(["sap/m/Dialog","sap/m/Button","sap/ui/mdc/field/ValueHelpPanel","sap/ui/mdc/field/DefineConditionPanel","sap/ui/model/base/ManagedObjectModel","sap/ui/mdc/condition/FilterOperatorUtil"],Q.bind(this));this._bDialogRequested=true;}}if(D&&B&&V&&b&&e&&!this._bDialogRequested){if(!this._oResourceBundle){this._oResourceBundle=sap.ui.getCore().getLibraryResourceBundle("sap.ui.mdc");}var j=new B(this.getId()+"-ok",{text:this._oResourceBundle.getText("valuehelp.OK"),press:X.bind(this)});var h1=new B(this.getId()+"-cancel",{text:this._oResourceBundle.getText("valuehelp.CANCEL"),press:Y.bind(this)});this._oManagedObjectModel=new e(this);var i1=S.call(this);i=new D(this.getId()+"-dialog",{contentHeight:"600px",contentWidth:"1000px",horizontalScrolling:false,verticalScrolling:false,title:this.getTitle(),resizable:true,draggable:true,content:[i1],afterOpen:Z.bind(this),afterClose:$.bind(this),buttons:[j,h1]});this.setAggregation("_dialog",i,true);i.setModel(new R({bundleName:"sap/ui/mdc/messagebundle",async:false}),"$i18n");a1.call(this,this.getShowConditionPanel());}return i;}function Q(i,j,h1,i1,j1,k1){D=i;B=j;V=h1;b=i1;e=j1;f=k1;this._bDialogRequested=false;if(!this._bIsBeingDestroyed){P.call(this);if(this._bOpen){this.open();delete this._bOpen;}}}function S(){var i=this.getContent();var j=this.getFilterBar();var h1=new V(this.getId()+"-VHP",{height:"100%",showFilterbar:!!j,searchEnabled:!!this.getFilterFields(),formatOptions:this._getFormatOptions(),search:g1.bind(this)});h1.setModel(this._oManagedObjectModel,"$help");if(i){i.initialize(false);T.call(this,h1,i.getDialogContent());}if(j){h1.setFilterbar(j);}return h1;}function T(i,j){i.setTable(j);}function U(i,j){var h1=this.getAggregation("_popover");var i1=this.getAggregation("_dialog");if(i==="remove"){j.detachEvent("navigate",k,this);j.detachEvent("selectionChange",o,this);j.detachEvent("dataUpdate",p,this);j=undefined;}else{j.attachEvent("navigate",k,this);j.attachEvent("selectionChange",o,this);j.attachEvent("dataUpdate",p,this);r.call(this);}this.fireDataUpdate();if(this._bNavigate){this._bNavigate=false;this.navigate(this._iStep);this._iStep=null;}else if(h1){h1.invalidate();var j1=this.getFilterValue();if(j1){s.call(this,j1);}y.call(this);if(j&&j.getFilterEnabled()&&!this._oFilterConditionModel){L.call(this);}if(j&&this._bOpenIfContent){j.initialize(true);var k1=this._getField();if(k1){j.fieldHelpOpen(true);h1.openBy(this._getControlForSuggestion());}this._bOpenIfContent=false;}}else if(j&&this._bOpenIfContent){this._bOpenIfContent=false;this.open(true);}if(i1){if(j){j.initialize(false);if(j.getFilterEnabled()&&!this._oFilterConditionModel){L.call(this);}var l1=i1.getContent()[0];l1.setShowTokenizer(this.getMaxConditions()!==1);T.call(this,l1,j.getDialogContent());if(i1.isOpen()||this._bOpen){j.fieldHelpOpen(false);}}}}function W(){var i=this.getAggregation("_dialog");if(!i){i=P.call(this);}return i;}function X(i){this.close();var j=this.getConditions();j=C._removeEmptyConditions(j);f.updateConditionsValues(j,this._getFormatOptions().operators);this._bNoConditionModelUpdate=true;this.setProperty("conditions",j,true);this.fireSelect({conditions:j,add:false});}function Y(i){this.close();this.setProperty("conditions",this._aOldConditions,true);}function Z(i){this._bDialogOpen=true;}function $(i){this._bDialogOpen=false;this._aOldConditions=undefined;this._bUseFilterBar=false;this._bApplyFilter=false;var j=this.getContent();if(j){j.fieldHelpClose();if(!j.getAsyncKeyText()){_.call(this);}}this._handleAfterClose(i);}function a1(i){var j=this.getAggregation("_dialog");if(j&&this._oField){var h1=j.getContent()[0];var i1=this._getFormatOptions().operators;if(i&&!f.onlyEEQ(i1)){if(!h1._oDefineConditionPanel){var j1=new b(this.getId()+"-DCP");h1.setDefineConditions(j1);}}else{h1.setDefineConditions();}}}function b1(i,j){if(i==="remove"){j.detachEvent("search",c1,this);j=undefined;}else{j.attachEvent("search",c1,this);}var h1=this.getAggregation("_dialog");if(h1){var i1=h1.getContent()[0];i1.setFilterbar(j);i1.setShowFilterbar(!!j);y.call(this);c1.call(this);}}function c1(j){if(!this._oFilterConditionModel||!this._bUseFilterBar){return;}var h1=this.getFilterBar();if(h1){var i1=this._oFilterConditionModel.getAllConditions();var j1=h1.getConditions();var k1=this.getFilterFields();var i=0;var l1;var m1;for(l1 in i1){if(l1!==k1){for(i=0;i<i1[l1].length;i++){m1=m({},i1[l1][i]);if(m1.inParameters){m1.inParameters=z.call(this,m1.inParameters);}if(m1.outParameters){m1.outParameters=A.call(this,m1.outParameters);}if(!j1[l1]||C.indexOfCondition(m1,j1[l1])<0){this._oFilterConditionModel.removeCondition(l1,m1);}}}}for(l1 in j1){for(i=0;i<j1[l1].length;i++){m1=m({},j1[l1][i]);if(m1.inParameters){m1.inParameters=G.call(this,m1.inParameters);}if(m1.outParameters){m1.outParameters=H.call(this,m1.outParameters);}if(!i1[l1]||C.indexOfCondition(m1,i1[l1])<0){this._oFilterConditionModel.addCondition(l1,m1);}}}if(!this._bApplyFilter&&(j||h1.getLiveMode())){this._bApplyFilter=true;this._oFilterConditionModel.checkUpdate(true,true);}}}function d1(){if(!this._oFilterConditionModel){return;}var i=this.getFilterBar();if(!i){return;}var j=this._oFilterConditionModel.getAllConditions();var h1=this.getFilterFields();var i1;for(i1 in j){if(i1!==h1){this._oFilterConditionModel.removeAllConditions(i1);}}y.call(this);}function e1(){var i=this.getContent();if(i){return i.getSuggestionContent();}}function f1(){var i=this._getField();var j=i&&i.getBindingContext();if(this.getBindingContext()!==j){this.setBindingContext(j);}}function g1(i){this._bApplyFilter=true;this._oFilterConditionModel.checkUpdate(true,true);}g.prototype.getScrollDelegate=function(){var i=this.getAggregation("_dialog");if(i&&(i.isOpen()||i.oPopup.getOpenState()==="Opening")){var j=this.getContent();var h1=j&&j.getDialogContent();if(h1&&h1.getScrollDelegate){return h1.getScrollDelegate();}else{return undefined;}}else{return F.prototype.getScrollDelegate.apply(this,arguments);}};return g;});
