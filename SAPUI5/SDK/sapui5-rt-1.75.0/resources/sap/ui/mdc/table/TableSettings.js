/*
 * ! SAPUI5

		(c) Copyright 2009-2020 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/ui/mdc/p13n/FlexUtil","sap/m/OverflowToolbarButton","sap/m/OverflowToolbarLayoutData","sap/base/util/merge","sap/m/library","sap/m/Menu","sap/m/MenuButton","sap/m/MenuItem"],function(F,O,a,m,M,b,c,d){"use strict";var r;var T={createSortButton:function(i,e){if(!r){this._loadResourceBundle();}return this._createButton(i+"-sort",{icon:"sap-icon://sort",text:r.getText("table.SETTINGS_SORT","Sort"),press:e,tooltip:r.getText("table.SETTINGS_SORT","Sort"),layoutData:new a({closeOverflowOnInteraction:false})});},createColumnsButton:function(i,e){if(!r){this._loadResourceBundle();}return this._createButton(i+"-settings",{icon:"sap-icon://action-settings",text:r.getText("table.SETTINGS_COLUMN","Add/Remove Columns"),press:e,tooltip:r.getText("table.SETTINGS_COLUMN","Add/Remove Columns"),layoutData:new a({closeOverflowOnInteraction:false})});},createExportButton:function(i,e){if(!r){this._loadResourceBundle();}return new c(i+"-export",{icon:"sap-icon://excel-attachment",tooltip:r.getText("table.EXPORT_BUTTON_TEXT"),type:M.ButtonType.Ghost,buttonMode:M.MenuButtonMode.Split,useDefaultActionOnly:true,defaultAction:e.default,menu:[new b({items:[new d({text:r.getText("table.QUICK_EXPORT","Export"),press:e.default}),new d({text:r.getText("table.EXPORT_WITH_SETTINGS","Export As..."),press:e.exportAs})]})]});},_createButton:function(i,s){return new O(i,s);},_loadResourceBundle:function(){r=sap.ui.getCore().getLibraryResourceBundle("sap.ui.mdc");},showPanel:function(C,p,s,i){return new Promise(function(e,f){T["_getP13nStateOf"+p](C).then(function(P){var S={control:C,source:s,p13nData:P,fnAfterCreateChanges:e,p13nType:p};F.showP13nPanel(S);});});},_getP13nStateOfSort:function(C){return new Promise(function(e){sap.ui.require([this.getDelegate().name],function(D){if(!D||!D.fetchProperties||!D.getCurrentState){return e([]);}var p={};p.items=[];var E=m({},D.getCurrentState(this).sorters);Object.keys(E).forEach(function(n,i){E[n].index=i;});D.fetchProperties(this).then(function(P){P.forEach(function(o){var f=E[o.name]?true:false;if(o.sortable){p.items.push({name:o.name,label:o.label||o.name,descending:f?E[o.name].descending:null,selected:f,groupLabel:o.groupLabel,position:f?E[o.name].index:-1});}});e(p);});}.bind(this));}.bind(C));},_getP13nStateOfColumns:function(C){return new Promise(function(e){sap.ui.require([this.getDelegate().name],function(D){var p={};p.items=[];var E=D.getCurrentState(this).visibleFields;var f=E.reduce(function(g,P,i){g[P.name]=P;g[P.name].position=i;return g;},{});D.fetchProperties(this).then(function(P){P.forEach(function(o){var g=f[o.name]?true:false;p.items.push({id:g?f[o.name].id:undefined,name:o.name,label:g?f[o.name].label||f[o.name].name:o.label||o.name,selected:g,groupLabel:o.groupLabel,position:g?f[o.name].position:-1});});e(p);});}.bind(this));}.bind(C));},createSort:function(C,p,R){sap.ui.require([C.getDelegate().name],function(D){if(!D||!D.getCurrentState){return;}var e=[],f=false;var E=D.getCurrentState(C).sorters;for(var n in E){var P=E[n];if(p===n){f=P.descending;}if(R){e.push({selectorElement:C,changeSpecificData:{changeType:"removeSort",content:{name:n,descending:P.descending}}});}}e.push({selectorElement:C,changeSpecificData:{changeType:"addSort",content:{name:p,descending:f}}});F.handleChanges(e);});},moveColumn:function(C,D,n){this._moveItem(C,D,n,"moveColumn");},_moveItem:function(C,D,n,s){sap.ui.require([C.getDelegate().name],function(e){if(!e||!e.getCurrentState){return;}var f=[];var v=e.getCurrentState(C).visibleFields||[];var o=v[D];f.push(F.createMoveChange(o.id,o.name,n,s,C));F.handleChanges(f);});}};return T;});
